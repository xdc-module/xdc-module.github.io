!function(){function getListener(e,t,i){var n;t=t.toLowerCase();return(n=e.__allListeners||i&&(e.__allListeners={}))&&(n[t]||i&&(n[t]=[]))}function getDomNode(e,t,i,n,o,r){var s,a=n&&e[t];!a&&(a=e[i]);for(;!a&&(s=(s||e).parentNode);){if("BODY"==s.tagName||r&&!r(s))return null;a=s[i]}return a&&o&&!o(a)?getDomNode(a,t,i,!1,o):a}var baidu,dom,browser,ie,webkit,gecko,opera,utils,EventBase,dtd,attrFix,styleBlock,domUtils,fillCharReg,filterWord,htmlparser,filterNode,keymap,LocalStorage;UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};baidu=window.baidu||{};window.baidu=baidu;window.UE=baidu.editor=window.UE||{};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE._customizeUI={};UE.version="1.4.3";dom=UE.dom={};browser=UE.browser=function(){var e,t,i,n,o=navigator.userAgent.toLowerCase(),r=window.opera,s={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(o),opera:!!r&&r.version,webkit:o.indexOf(" applewebkit/")>-1,mac:o.indexOf("macintosh")>-1,quirks:"BackCompat"==document.compatMode};s.gecko="Gecko"==navigator.product&&!s.webkit&&!s.opera&&!s.ie;e=0;if(s.ie){t=o.match(/(?:msie\s([\w.]+))/);i=o.match(/(?:trident.*rv:([\w.]+))/);e=t&&i&&t[1]&&i[1]?Math.max(1*t[1],1*i[1]):t&&t[1]?1*t[1]:i&&i[1]?1*i[1]:0;s.ie11Compat=11==document.documentMode;s.ie9Compat=9==document.documentMode;s.ie8=!!document.documentMode;s.ie8Compat=8==document.documentMode;s.ie7Compat=7==e&&!document.documentMode||7==document.documentMode;s.ie6Compat=e<7||s.quirks;s.ie9above=e>8;s.ie9below=e<9;s.ie11above=e>10;s.ie11below=e<11}if(s.gecko){n=o.match(/rv:([\d\.]+)/);if(n){n=n[1].split(".");e=1e4*n[0]+100*(n[1]||0)+1*(n[2]||0)}}/chrome\/(\d+\.\d)/i.test(o)&&(s.chrome=+RegExp["$1"]);/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(o)&&!/chrome/i.test(o)&&(s.safari=+(RegExp["$1"]||RegExp["$2"]));s.opera&&(e=parseFloat(r.version()));s.webkit&&(e=parseFloat(o.match(/ applewebkit\/(\d+)/)[1]));s.version=e;s.isCompatible=!s.mobile&&(s.ie&&e>=6||s.gecko&&e>=10801||s.opera&&e>=9.5||s.air&&e>=1||s.webkit&&e>=522||!1);return s}();ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera;utils=UE.utils={each:function(e,t,i){var n,o,r;if(null!=e)if(e.length===+e.length){for(n=0,o=e.length;n<o;n++)if(t.call(i,e[n],n,e)===!1)return!1}else for(r in e)if(e.hasOwnProperty(r)&&t.call(i,e[r],r,e)===!1)return!1},makeInstance:function(e){var t=new Function;t.prototype=e;e=new t;t.prototype=null;return e},extend:function(e,t,i){if(t)for(var n in t)i&&e.hasOwnProperty(n)||(e[n]=t[n]);return e},extend2:function(e){var t,i,n,o=arguments;for(t=1;t<o.length;t++){i=o[t];for(n in i)e.hasOwnProperty(n)||(e[n]=i[n])}return e},inherits:function(e,t){var i=e.prototype,n=utils.makeInstance(t.prototype);utils.extend(n,i,!0);e.prototype=n;return n.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,i){var n;return function(){i&&clearTimeout(n);n=setTimeout(e,t)}},indexOf:function(e,t,i){var n=-1;i=this.isNumber(i)?i:0;this.each(e,function(e,o){if(o>=i&&e===t){n=o;return!1}});return n},removeItem:function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t){e.splice(i,1);i--}},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t,i=0,n={};t=e[i++];)n[t.toUpperCase()]=n[t]=1;return n},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},unhtmlForUrl:function(e,t){return e?e.replace(t||/[<">']/g,function(e){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={float:void 0!=e.cssFloat?"cssFloat":void 0!=e.styleFloat?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function e(e,i){try{for(var n,o=0;n=t[o++];)if(n.doc===e&&n.url==(i.src||i.href))return n}catch(e){return null}}var t=[];return function(i,n,o){var r,s,a,l=e(i,n);if(l)l.ready?o&&o():l.funs.push(o);else{t.push({doc:i,url:n.src||n.href,funs:[o]});if(i.body){if(!n.id||!i.getElementById(n.id)){a=i.createElement(n.tag);delete n.tag;for(s in n)a.setAttribute(s,n[s]);a.onload=a.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){l=e(i,n);if(l.funs.length>0){l.ready=1;for(var t;t=l.funs.pop();)t()}a.onload=a.onreadystatechange=null}};a.onerror=function(){throw Error("The load "+(n.href||n.src)+" fails,check the url settings of file ueditor.config.js ")};i.getElementsByTagName("head")[0].appendChild(a)}}else{r=[];for(s in n)"tag"!=s&&r.push(s+'="'+n[s]+'"');i.write("<"+n.tag+" "+r.join(" ")+" ></"+n.tag+">")}}}}(),isEmptyObject:function(e){if(null==e)return!0;if(this.isArray(e)||this.isString(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){var i,n,o;if(/color/i.test(e)&&/rgba?/.test(t)){i=t.split(",");if(i.length>3)return"";t="#";for(n=0;o=i[n++];){o=parseInt(o.replace(/[^\d]/gi,""),10).toString(16);t+=1==o.length?"0"+o:o}t=t.toUpperCase()}return t},optCss:function(e){function t(e,t){var i,n,o,r,s,a;if(!e)return"";i=e.top,n=e.bottom,o=e.left,r=e.right,s="";if(i&&o&&n&&r)s+=";"+t+":"+(i==n&&n==o&&o==r?i:i==n&&o==r?i+" "+o:o==r?i+" "+o+" "+n:i+" "+r+" "+n+" "+o)+";";else for(a in e)s+=";"+t+"-"+a+":"+e[a]+";";return s}var i,n;e=e.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(e,t,o,r){if(1==r.split(" ").length)switch(t){case"padding":!i&&(i={});i[o]=r;return"";case"margin":!n&&(n={});n[o]=r;return"";case"border":return"initial"==r?"":e}return e});e+=t(i,"padding")+t(n,"margin");return e.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(e,t){return t?t+";;":";"})},clone:function(e,t){var i,n;t=t||{};for(n in e)if(e.hasOwnProperty(n)){i=e[n];if("object"==typeof i){t[n]=utils.isArray(i)?[]:{};utils.clone(e[n],t[n])}else t[n]=i}return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;e.replace(/([\d.]+)(\w+)/,function(i,n,o){e=n;t=o});switch(t){case"cm":e=25*parseFloat(e);break;case"pt":e=Math.round(96*parseFloat(e)/72)}return e+(e?"px":"")},domReady:function(){function e(e){e.isReady=!0;for(var i;i=t.pop();i());}var t=[];return function(i,n){n=n||window;var o=n.document;i&&t.push(i);if("complete"===o.readyState)e(o);else{o.isReady&&e(o);if(browser.ie&&11!=browser.version){!function(){if(!o.isReady){try{o.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}e(o)}}();n.attachEvent("onload",function(){e(o)})}else{o.addEventListener("DOMContentLoaded",function(){o.removeEventListener("DOMContentLoaded",arguments.callee,!1);e(o)},!1);n.addEventListener("load",function(){e(o)},!1)}}}}(),cssRule:browser.ie&&11!=browser.version?function(e,t,i){var n,o;if(void 0===t||t&&t.nodeType&&9==t.nodeType){i=t&&t.nodeType&&9==t.nodeType?t:i||document;n=i.indexList||(i.indexList={});o=n[e];if(void 0!==o)return i.styleSheets[o].cssText}else{i=i||document;n=i.indexList||(i.indexList={});o=n[e];if(""===t){if(void 0!==o){i.styleSheets[o].cssText="";delete n[e];return!0}return!1}if(void 0!==o)sheetStyle=i.styleSheets[o];else{sheetStyle=i.createStyleSheet("",o=i.styleSheets.length);n[e]=o}sheetStyle.cssText=t}}:function(e,t,i){var n;if(void 0===t||t&&t.nodeType&&9==t.nodeType){i=t&&t.nodeType&&9==t.nodeType?t:i||document;n=i.getElementById(e);return n?n.innerHTML:void 0}i=i||document;n=i.getElementById(e);if(""===t){if(n){n.parentNode.removeChild(n);return!0}return!1}if(n)n.innerHTML=t;else{n=i.createElement("style");n.id=e;n.innerHTML=t;i.getElementsByTagName("head")[0].appendChild(n)}},sort:function(e,t){var i,n,o,r,s;t=t||function(e,t){return e.localeCompare(t)};for(i=0,n=e.length;i<n;i++)for(o=i,r=e.length;o<r;o++)if(t(e[i],e[o])>0){s=e[i];e[i]=e[o];e[o]=s}return e},serializeParam:function(e){var t,i,n=[];for(t in e)if("method"!=t&&"timeout"!=t&&"async"!=t)if("function"!=(typeof e[t]).toLowerCase()&&"object"!=(typeof e[t]).toLowerCase())n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));else if(utils.isArray(e[t]))for(i=0;i<e[t].length;i++)n.push(encodeURIComponent(t)+"[]="+encodeURIComponent(e[t][i]));return n.join("&")},formatUrl:function(e){var t=e.replace(/&&/g,"&");t=t.replace(/\?&/g,"?");t=t.replace(/&$/g,"");t=t.replace(/&#/g,"#");t=t.replace(/&+/g,"&");return t},isCrossDomainUrl:function(e){var t=document.createElement("a");t.href=e;browser.ie&&(t.href=t.href);return!(t.protocol==location.protocol&&t.hostname==location.hostname&&(t.port==location.port||"80"==t.port&&""==location.port||""==t.port&&"80"==location.port))},clearEmptyAttrs:function(e){for(var t in e)""===e[t]&&delete e[t];return e},str2json:function(e){return utils.isString(e)?window.JSON?JSON.parse(e):new Function("return "+utils.trim(e||""))():null},json2str:function(){function e(e){/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var t=o[e];if(t)return t;t=e.charCodeAt();return"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)}));return'"'+e+'"'}function t(e){var t,i,n,o=["["],r=e.length;for(i=0;i<r;i++){n=e[i];switch(typeof n){case"undefined":case"function":case"unknown":break;default:t&&o.push(",");o.push(utils.json2str(n));t=1}}o.push("]");return o.join("")}function i(e){return e<10?"0"+e:e}function n(e){return'"'+e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+"T"+i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+'"'}if(window.JSON)return JSON.stringify;var o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(i){var o,r,s,a,l;switch(typeof i){case"undefined":return"undefined";case"number":return isFinite(i)?String(i):"null";case"string":return e(i);case"boolean":return String(i);default:if(null===i)return"null";if(utils.isArray(i))return t(i);if(utils.isDate(i))return n(i);o=["{"],r=utils.json2str;for(l in i)if(Object.prototype.hasOwnProperty.call(i,l)){a=i[l];switch(typeof a){case"undefined":case"unknown":case"function":break;default:s&&o.push(",");s=1;o.push(r(l)+":"+r(a))}}o.push("}");return o.join("")}}}()};utils.each(["String","Function","Array","Number","RegExp","Object","Date"],function(e){UE.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});EventBase=UE.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var i,n=0;i=e[n++];)getListener(this,i,!0).push(t)},on:function(e,t){return this.addListener(e,t)},off:function(e,t){return this.removeListener(e,t)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(e,t){e=utils.trim(e).split(/\s+/);for(var i,n=0;i=e[n++];)utils.removeItem(getListener(this,i)||[],t)},fireEvent:function(){var e,t,i,n,o,r,s=arguments[0];s=utils.trim(s).split(" ");for(e=0;t=s[e++];){i=getListener(this,t);if(i){r=i.length;for(;r--;)if(i[r]){o=i[r].apply(this,arguments);if(o===!0)return o;void 0!==o&&(n=o)}}(o=this["on"+t.toLowerCase()])&&(n=o.apply(this,arguments))}return n}};dtd=dom.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=utils.extend2,i=e({isindex:1,fieldset:1}),n=e({input:1,button:1,select:1,textarea:1,label:1}),o=t(e({a:1}),n),r=t({iframe:1},o),s=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),a=e({ins:1,del:1,script:1,style:1}),l=t(e({b:1,acronym:1,bdo:1,var:1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),a),d=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),l),c=t(e({p:1}),d),u=t(e({iframe:1}),d,n),m=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,var:1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),f=t(e({a:0}),u),h=e({tr:1}),p=e({"#":1}),g=t(e({param:1}),m),b=t(e({form:1}),i,r,s,c),y=e({li:1,ol:1,ul:1}),v=e({style:1,script:1}),C=e({base:1,link:1,meta:1,title:1}),N=t(C,v),x=e({head:1,body:1}),w=e({html:1}),U=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),E=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(w,x,C),$block:U,$inline:f,$inlineWithA:t(e({a:1}),f),$body:t(e({script:1,style:1}),U),$cdata:e({script:1,style:1}),$empty:E,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,var:1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:x,head:N,style:p,script:p,body:b,base:{},link:{},meta:{},title:p,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:b,td:b,br:{},th:b,center:b,kbd:f,button:t(c,s),basefont:{},h5:f,h4:f,samp:f,h6:f,ol:y,h1:f,h3:f,option:p,h2:f,form:t(i,r,s,c),select:e({optgroup:1,option:1}),font:f,ins:f,menu:y,abbr:f,label:f,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:f,tfoot:h,cite:f,li:b,input:{},iframe:b,strong:f,textarea:p,noframes:b,big:f,small:f,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:f,dt:f,sub:f,optgroup:e({option:1}),param:{},bdo:f,var:f,div:b,object:g,sup:f,dd:b,strike:f,area:{},dir:y,map:t(e({area:1,form:1,p:1}),i,a,s),applet:g,dl:e({dt:1,dd:1}),del:f,isindex:{},fieldset:t(e({legend:1}),m),thead:h,ul:y,acronym:f,b:f,a:t(e({a:1}),u),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),b),caption:f,i:f,u:f,tbody:h,s:f,address:t(r,c),tt:f,legend:f,q:f,pre:t(l,o),p:t(e({a:1}),f),em:f,dfn:f})}();attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&"6"==browser.version?"\ufeff":"​",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(e,t){var i,n,o,r;if(e===t)return 0;n=[e],o=[t];i=e;for(;i=i.parentNode;){if(i===t)return 10;n.push(i)}i=t;for(;i=i.parentNode;){if(i===e)return 20;o.push(i)}n.reverse();o.reverse();if(n[0]!==o[0])return 1;r=-1;for(;r++,n[r]===o[r];);e=n[r];t=o[r];for(;e=e.nextSibling;)if(e===t)return 4;return 2},getNodeIndex:function(e,t){for(var i=e,n=0;i=i.previousSibling;)t&&3==i.nodeType?i.nodeType!=i.nextSibling.nodeType&&n++:n++;return n},inDoc:function(e,t){return 10==domUtils.getPosition(e,t)},findParent:function(e,t,i){if(e&&!domUtils.isBody(e)){e=i?e:e.parentNode;for(;e;){if(!t||t(e)||domUtils.isBody(e))return t&&!t(e)&&domUtils.isBody(e)?null:e;e=e.parentNode}}return null},findParentByTagName:function(e,t,i,n){t=utils.listToMap(utils.isArray(t)?t:[t]);return domUtils.findParent(e,function(e){return t[e.tagName]&&!(n&&n(e))},i)},findParents:function(e,t,i,n){for(var o=t&&(i&&i(e)||!i)?[e]:[];e=domUtils.findParent(e,i);)o.push(e);return n?o:o.reverse()},insertAfter:function(e,t){return e.nextSibling?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.appendChild(t)},remove:function(e,t){var i,n=e.parentNode;if(n){if(t&&e.hasChildNodes())for(;i=e.firstChild;)n.insertBefore(i,e);n.removeChild(e)}return e},getNextDomNode:function(e,t,i,n){return getDomNode(e,"firstChild","nextSibling",t,i,n)},getPreDomNode:function(e,t,i,n){return getDomNode(e,"lastChild","previousSibling",t,i,n)},isBookmarkNode:function(e){return 1==e.nodeType&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;for(var i=[e],n=[t],o=e,r=-1;o=o.parentNode;){if(o===t)return o;i.push(o)}o=t;for(;o=o.parentNode;){if(o===e)return o;n.push(o)}i.reverse();n.reverse();for(;r++,i[r]===n[r];);return 0==r?null:i[r-1]},clearEmptySibling:function(e,t,i){function n(e,t){for(var i;e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!new RegExp("[^\t\n\r"+domUtils.fillChar+"]").test(e.nodeValue));){i=e[t];domUtils.remove(e);e=i}}!t&&n(e.nextSibling,"nextSibling");!i&&n(e.previousSibling,"previousSibling")},split:function(e,t){var i,n,o,r=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){i=r.createTextNode("");return domUtils.insertAfter(e,i)}n=e.splitText(t);if(browser.ie8){o=r.createTextNode("");domUtils.insertAfter(n,o);domUtils.remove(o)}return n},isWhitespace:function(e){return!new RegExp("[^ \t\n\r"+domUtils.fillChar+"]").test(e.nodeValue)},getXY:function(e){for(var t=0,i=0;e.offsetParent;){i+=e.offsetTop;t+=e.offsetLeft;e=e.offsetParent}return{x:t,y:i}},on:function(e,t,i){var n,o,r=utils.isArray(t)?t:utils.trim(t).split(/\s+/),s=r.length;if(s)for(;s--;){t=r[s];if(e.addEventListener)e.addEventListener(t,i,!1);else{i._d||(i._d={els:[]});n=t+i.toString(),o=utils.indexOf(i._d.els,e);if(!i._d[n]||o==-1){o==-1&&i._d.els.push(e);i._d[n]||(i._d[n]=function(e){return i.call(e.srcElement,e||window.event)});e.attachEvent("on"+t,i._d[n])}}}e=null},un:function(e,t,i){var n,o,r=utils.isArray(t)?t:utils.trim(t).split(/\s+/),s=r.length;if(s)for(;s--;){t=r[s];if(e.removeEventListener)e.removeEventListener(t,i,!1);else{n=t+i.toString();try{e.detachEvent("on"+t,i._d?i._d[n]:i)}catch(e){}if(i._d&&i._d[n]){o=utils.indexOf(i._d.els,e);o!=-1&&i._d.els.splice(o,1);0==i._d.els.length&&delete i._d[n]}}}},isSameElement:function(e,t){var i,n,o,r,s,a,l;if(e.tagName!=t.tagName)return!1;i=e.attributes,n=t.attributes;if(!ie&&i.length!=n.length)return!1;s=0,a=0;for(l=0;o=i[l++];){if("style"==o.nodeName){o.specified&&s++;if(domUtils.isSameStyle(e,t))continue;return!1}if(ie){if(!o.specified)continue;s++;r=n.getNamedItem(o.nodeName)}else r=t.attributes[o.nodeName];if(!r.specified||o.nodeValue!=r.nodeValue)return!1}if(ie){for(l=0;r=n[l++];)r.specified&&a++;if(s!=a)return!1}return!0},isSameStyle:function(e,t){var i,n,o,r=e.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),s=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(browser.opera){r=e.style;s=t.style;if(r.length!=s.length)return!1;for(i in r)if(!/^(\d+|csstext)$/i.test(i)&&r[i]!=s[i])return!1;return!0}if(!r||!s)return r==s;r=r.split(";");s=s.split(";");if(r.length!=s.length)return!1;for(n=0;o=r[n++];)if(utils.indexOf(s,o)==-1)return!1;return!0},isBlockElm:function(e){return 1==e.nodeType&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},isBody:function(e){return e&&1==e.nodeType&&"body"==e.tagName.toLowerCase()},breakParent:function(e,t){var i,n,o,r=e,s=e;do{r=r.parentNode;if(n){i=r.cloneNode(!1);i.appendChild(n);n=i;i=r.cloneNode(!1);i.appendChild(o);o=i}else{n=r.cloneNode(!1);o=n.cloneNode(!1)}for(;i=s.previousSibling;)n.insertBefore(i,n.firstChild);for(;i=s.nextSibling;)o.appendChild(i);s=r}while(t!==r);i=t.parentNode;i.insertBefore(n,t);i.insertBefore(o,t);i.insertBefore(e,o);domUtils.remove(t);return e},isEmptyInlineElement:function(e){if(1!=e.nodeType||!dtd.$removeEmpty[e.tagName])return 0;e=e.firstChild;for(;e;){if(domUtils.isBookmarkNode(e))return 0;if(1==e.nodeType&&!domUtils.isEmptyInlineElement(e)||3==e.nodeType&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},trimWhiteTextNode:function(e){function t(t){for(var i;(i=e[t])&&3==i.nodeType&&domUtils.isWhitespace(i);)e.removeChild(i)}t("firstChild");t("lastChild")},mergeChild:function(e,t,i){var n,o,r,s,a,l=domUtils.getElementsByTagName(e,e.tagName.toLowerCase());for(n=0;o=l[n++];)if(o.parentNode&&!domUtils.isBookmarkNode(o))if("span"!=o.tagName.toLowerCase())domUtils.isSameElement(e,o)&&domUtils.remove(o,!0);else{if(e===o.parentNode){domUtils.trimWhiteTextNode(e);if(1==e.childNodes.length){e.style.cssText=o.style.cssText+";"+e.style.cssText;domUtils.remove(o,!0);continue}}o.style.cssText=e.style.cssText+";"+o.style.cssText;if(i){r=i.style;if(r){r=r.split(";");for(s=0;a=r[s++];)o.style[utils.cssStyleToDomStyle(a.split(":")[0])]=a.split(":")[1]}}domUtils.isSameStyle(o,e)&&domUtils.remove(o,!0)}},getElementsByTagName:function(e,t,i){var n,o,r,s,a,l,d;if(i&&utils.isString(i)){n=i;i=function(e){return domUtils.hasClass(e,n)}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");o=[];for(r=0;s=t[r++];){a=e.getElementsByTagName(s);for(l=0;d=a[l++];)i&&!i(d)||o.push(d)}return o},mergeToParent:function(e){for(var t=e.parentNode;t&&dtd.$removeEmpty[t.tagName];){if(t.tagName==e.tagName||"A"==t.tagName){domUtils.trimWhiteTextNode(t);if("SPAN"==t.tagName&&!domUtils.isSameStyle(t,e)||"A"==t.tagName&&"SPAN"==e.tagName){if(t.childNodes.length>1||t!==e.parentNode){e.style.cssText=t.style.cssText+";"+e.style.cssText;t=t.parentNode;continue}t.style.cssText+=";"+e.style.cssText;"A"==t.tagName&&(t.style.textDecoration="underline")}if("A"!=t.tagName){t===e.parentNode&&domUtils.remove(e,!0);break}}t=t.parentNode}},mergeSibling:function(e,t,i){function n(e,t,i){var n;if((n=i[e])&&!domUtils.isBookmarkNode(n)&&1==n.nodeType&&domUtils.isSameElement(i,n)){for(;n.firstChild;)"firstChild"==t?i.insertBefore(n.lastChild,i.firstChild):i.appendChild(n.firstChild);domUtils.remove(n)}}!t&&n("previousSibling","firstChild",e);!i&&n("nextSibling","lastChild",e)},unSelectable:ie&&browser.ie9below||browser.opera?function(e){e.onselectstart=function(){return!1};e.onclick=e.onkeyup=e.onkeydown=function(){return!1};e.unselectable="on";e.setAttribute("unselectable","on");for(var t,i=0;t=e.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on";e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){var i,n,o;t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(i=0;n=t[i++];){n=attrFix[n]||n;switch(n){case"className":e[n]="";break;case"style":e.style.cssText="";o=e.getAttributeNode("style");!browser.ie&&o&&e.removeAttributeNode(o)}e.removeAttribute(n)}},createElement:function(e,t,i){return domUtils.setAttributes(e.createElement(t),i)},setAttributes:function(e,t){var i,n;for(i in t)if(t.hasOwnProperty(i)){n=t[i];switch(i){case"class":e.className=n;break;case"style":e.style.cssText=e.style.cssText+";"+n;break;case"innerHTML":e[i]=n;break;case"value":e.value=n;break;default:e.setAttribute(attrFix[i]||i,n)}}return e},getComputedStyle:function(e,t){var i,n,o,r="width height top left";if(r.indexOf(t)>-1)return e["offset"+t.replace(/^\w/,function(e){return e.toUpperCase()})]+"px";3==e.nodeType&&(e=e.parentNode);if(browser.ie&&browser.version<9&&"font-size"==t&&!e.style.fontSize&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]){i=e.ownerDocument.createElement("span");i.style.cssText="padding:0;border:0;font-family:simsun;";i.innerHTML=".";e.appendChild(i);n=i.offsetHeight;e.removeChild(i);i=null;return n+"px"}try{o=domUtils.getStyle(e,t)||(window.getComputedStyle?domUtils.getWindow(e).getComputedStyle(e,"").getPropertyValue(t):(e.currentStyle||e.style)[utils.cssStyleToDomStyle(t)])}catch(e){return""}return utils.transUnitToPx(utils.fixColor(t,o))},removeClasses:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i,n=0,o=e.className;i=t[n++];)o=o.replace(new RegExp("\\b"+i+"\\b"),"");o=utils.trim(o).replace(/[ ]{2,}/g," ");o?e.className=o:domUtils.removeAttributes(e,["class"])},addClass:function(e,t){if(e){t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i,n=0,o=e.className;i=t[n++];)new RegExp("\\b"+i+"\\b").test(o)||(o+=" "+i);e.className=utils.trim(o)}},hasClass:function(e,t){if(utils.isRegExp(t))return t.test(e.className);t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var i,n=0,o=e.className;i=t[n++];)if(!new RegExp("\\b"+i+"\\b","i").test(o))return!1;return n-1==t.length},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){if(browser.ie){"color"==t&&(t="(^|;)"+t);e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")}else e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(utils.cssStyleToDomStyle(t));e.style.cssText||domUtils.removeAttributes(e,["style"])},getStyle:function(e,t){var i=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,i)},setStyle:function(e,t,i){e.style[utils.cssStyleToDomStyle(t)]=i;utils.trim(e.style.cssText)||this.removeAttributes(e,"style")},setStyles:function(e,t){for(var i in t)t.hasOwnProperty(i)&&domUtils.setStyle(e,i,t[i])},removeDirtyAttr:function(e){for(var t,i=0,n=e.getElementsByTagName("*");t=n[i++];)t.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var i=0,n=e.firstChild;t=t||function(){return 1};for(;n;){t(n)&&i++;n=n.nextSibling}return i},isEmptyNode:function(e){return!e.firstChild||0==domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})},clearSelectedArr:function(e){for(var t;t=e.pop();)domUtils.removeAttributes(t,["class"])},scrollToView:function(e,t,i){var n,o,r=function(){var e=t.document,i="CSS1Compat"==e.compatMode;return{width:(i?e.documentElement.clientWidth:e.body.clientWidth)||0,height:(i?e.documentElement.clientHeight:e.body.clientHeight)||0}},s=function(e){if("pageXOffset"in e)return{x:e.pageXOffset||0,y:e.pageYOffset||0};var t=e.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},a=r().height,l=a*-1+i;l+=e.offsetHeight||0;n=domUtils.getXY(e);l+=n.y;o=s(t).y;(l>o||l<o-a)&&t.scrollTo(0,l+(l<0?-20:20))},isBr:function(e){return 1==e.nodeType&&"BR"==e.tagName},isFillChar:function(e,t){if(3!=e.nodeType)return!1;var i=e.nodeValue;return t?new RegExp("^"+domUtils.fillChar).test(i):!i.replace(new RegExp(domUtils.fillChar,"g"),"").length},isStartInblock:function(e){var t,i,n,o=e.cloneRange(),r=0,s=o.startContainer;if(1==s.nodeType&&s.childNodes[o.startOffset]){s=s.childNodes[o.startOffset];i=s.previousSibling;for(;i&&domUtils.isFillChar(i);){s=i;i=i.previousSibling}}if(this.isFillChar(s,!0)&&1==o.startOffset){o.setStartBefore(s);s=o.startContainer}for(;s&&domUtils.isFillChar(s);){t=s;s=s.previousSibling}if(t){o.setStartBefore(t);s=o.startContainer}1==s.nodeType&&domUtils.isEmptyNode(s)&&1==o.startOffset&&o.setStart(s,0).collapse(!0);for(;!o.startOffset;){s=o.startContainer;if(domUtils.isBlockElm(s)||domUtils.isBody(s)){r=1;break}i=o.startContainer.previousSibling;if(i){for(;i&&domUtils.isFillChar(i);){n=i;i=i.previousSibling}n?o.setStartBefore(n):o.setStartBefore(o.startContainer)}else o.setStartBefore(o.startContainer)}return r&&!domUtils.isBody(o.startContainer)?1:0},isEmptyBlock:function(e,t){if(1!=e.nodeType)return 0;t=t||new RegExp("[  \t\r\n"+domUtils.fillChar+"]","g");if(e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var i in dtd.$isNotEmpty)if(e.getElementsByTagName(i).length)return 0;return 1},setViewportOffset:function(e,t){var i=0|parseInt(e.style.left),n=0|parseInt(e.style.top),o=e.getBoundingClientRect(),r=t.left-o.left,s=t.top-o.top;r&&(e.style.left=i+r+"px");s&&(e.style.top=n+s+"px")},fillNode:function(e,t){var i=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="";t.appendChild(i)},moveChild:function(e,t,i){for(;e.firstChild;)i&&t.firstChild?t.insertBefore(e.lastChild,t.firstChild):t.appendChild(e.firstChild)},hasNoAttributes:function(e){return browser.ie?/^<\w+\s*?>/.test(e.outerHTML):0==e.attributes.length},isCustomeNode:function(e){return 1==e.nodeType&&e.getAttribute("_ue_custom_node_")},isTagNode:function(e,t){return 1==e.nodeType&&new RegExp("\\b"+e.tagName+"\\b","i").test(t)},filterNodeList:function(e,t,i){var n,o=[];if(!utils.isFunction(t)){n=t;t=function(e){return utils.indexOf(utils.isArray(n)?n:n.split(" "),e.tagName.toLowerCase())!=-1}}utils.each(e,function(e){t(e)&&o.push(e)});return 0==o.length?null:1!=o.length&&i?o:o[0]},isInNodeEndBoundary:function(e,t){var i=e.startContainer;if(3==i.nodeType&&e.startOffset!=i.nodeValue.length)return 0;if(1==i.nodeType&&e.startOffset!=i.childNodes.length)return 0;for(;i!==t;){if(i.nextSibling)return 0;i=i.parentNode}return 1},isBoundaryNode:function(e,t){for(var i;!domUtils.isBody(e);){i=e;e=e.parentNode;if(i!==e[t])return!1}return!0},fillHtml:browser.ie11below?"&nbsp;":"<br/>"};fillCharReg=new RegExp(domUtils.fillChar,"g");!function(){function e(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function t(e){return!e.collapsed&&1==e.startContainer.nodeType&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function i(t,i,n,o){if(1==i.nodeType&&(dtd.$empty[i.tagName]||dtd.$nonChild[i.tagName])){n=domUtils.getNodeIndex(i)+(t?0:1);i=i.parentNode}if(t){o.startContainer=i;o.startOffset=n;o.endContainer||o.collapse(!0)}else{o.endContainer=i;o.endOffset=n;o.startContainer||o.collapse(!1)}e(o);return o}function n(e,t){var i,n,o,r,s,a,l,d,c,u,m,f=e.startContainer,h=e.endContainer,p=e.startOffset,g=e.endOffset,b=e.document,y=b.createDocumentFragment();1==f.nodeType&&(f=f.childNodes[p]||(i=f.appendChild(b.createTextNode(""))));1==h.nodeType&&(h=h.childNodes[g]||(n=h.appendChild(b.createTextNode(""))));if(f===h&&3==f.nodeType){y.appendChild(b.createTextNode(f.substringData(p,g-p)));if(t){f.deleteData(p,g-p);e.collapse(!0)}return y}s=y,a=domUtils.findParents(f,!0),l=domUtils.findParents(h,!0);for(d=0;a[d]==l[d];)d++;for(c=d;u=a[c];c++){o=u.nextSibling;if(u==f){if(!i)if(3==e.startContainer.nodeType){s.appendChild(b.createTextNode(f.nodeValue.slice(p)));t&&f.deleteData(p,f.nodeValue.length-p)}else s.appendChild(t?f:f.cloneNode(!0))}else{r=u.cloneNode(!1);s.appendChild(r)}for(;o&&o!==h&&o!==l[c];){u=o.nextSibling;s.appendChild(t?o:o.cloneNode(!0));o=u}s=r}s=y;if(!a[d]){s.appendChild(a[d-1].cloneNode(!1));s=s.firstChild}for(c=d;m=l[c];c++){o=m.previousSibling;if(m==h){if(!n&&3==e.endContainer.nodeType){s.appendChild(b.createTextNode(h.substringData(0,g)));t&&h.deleteData(0,g)}}else{r=m.cloneNode(!1);s.appendChild(r)}if(c!=d||!a[d])for(;o&&o!==f;){m=o.previousSibling;s.insertBefore(t?o:o.cloneNode(!0),s.firstChild);o=m}s=r}t&&e.setStartBefore(l[d]?a[d]?l[d]:a[d-1]:l[d-1]).collapse(!0);i&&domUtils.remove(i);n&&domUtils.remove(n);return y}function o(e,t){try{if(s&&domUtils.inDoc(s,e))if(s.nodeValue.replace(fillCharReg,"").length)s.nodeValue=s.nodeValue.replace(fillCharReg,"");else{
var i=s.parentNode;domUtils.remove(s);for(;i&&domUtils.isEmptyInlineElement(i)&&(browser.safari?!(domUtils.getPosition(i,t)&domUtils.POSITION_CONTAINS):!i.contains(t));){s=i.parentNode;domUtils.remove(i);i=s}}}catch(e){}}function r(e,t){var i;e=e[t];for(;e&&domUtils.isFillChar(e);){i=e[t];domUtils.remove(e);e=i}}var s,a=0,l=domUtils.fillChar,d=dom.Range=function(e){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null;t.document=e;t.collapsed=!0};d.prototype={cloneContents:function(){return this.collapsed?null:n(this,0)},deleteContents:function(){var e;this.collapsed||n(this,1);if(browser.webkit){e=this.startContainer;if(3==e.nodeType&&!e.nodeValue.length){this.setStartBefore(e).collapse(!0);domUtils.remove(e)}}return this},extractContents:function(){return this.collapsed?null:n(this,2)},setStart:function(e,t){return i(!0,e,t,this)},setEnd:function(e,t){return i(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,3==e.nodeType?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return new d(e.document).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;if(e){t.endContainer=t.startContainer;t.endOffset=t.startOffset}else{t.startContainer=t.endContainer;t.startOffset=t.endOffset}t.collapsed=!0;return t},shrinkBoundary:function(e){function t(e){return 1==e.nodeType&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}for(var i,n=this,o=n.collapsed;1==n.startContainer.nodeType&&(i=n.startContainer.childNodes[n.startOffset])&&t(i);)n.setStart(i,0);if(o)return n.collapse(!0);if(!e)for(;1==n.endContainer.nodeType&&n.endOffset>0&&(i=n.endContainer.childNodes[n.endOffset-1])&&t(i);)n.setEnd(i,i.childNodes.length);return n},getCommonAncestor:function(e,i){var n=this,o=n.startContainer,r=n.endContainer;if(o===r){if(e&&t(this)){o=o.childNodes[n.startOffset];if(1==o.nodeType)return o}return i&&3==o.nodeType?o.parentNode:o}return domUtils.getCommonAncestor(o,r)},trimBoundary:function(e){var t,i,n,o,r;this.txtToElmBoundary();t=this.startContainer,i=this.startOffset,n=this.collapsed,o=this.endContainer;if(3==t.nodeType){if(0==i)this.setStartBefore(t);else if(i>=t.nodeValue.length)this.setStartAfter(t);else{r=domUtils.split(t,i);t===o?this.setEnd(r,this.endOffset-i):t.parentNode===o&&(this.endOffset+=1);this.setStartBefore(r)}if(n)return this.collapse(!0)}if(!e){i=this.endOffset;o=this.endContainer;if(3==o.nodeType)if(0==i)this.setEndBefore(o);else{i<o.nodeValue.length&&domUtils.split(o,i);this.setEndAfter(o)}}return this},txtToElmBoundary:function(e){function t(e,t){var i=e[t+"Container"],n=e[t+"Offset"];3==i.nodeType&&(n?n>=i.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](i):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](i))}if(e||!this.collapsed){t(this,"start");t(this,"end")}return this},insertNode:function(e){var t,i,n,o=e,r=1;if(11==e.nodeType){o=e.firstChild;r=e.childNodes.length}this.trimBoundary(!0);t=this.startContainer,i=this.startOffset;n=t.childNodes[i];n?t.insertBefore(e,n):t.appendChild(e);o.parentNode===this.endContainer&&(this.endOffset=this.endOffset+r);return this.setStartBefore(o)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(e,t){var i,n=this.document.createElement("span");n.style.cssText="display:none;line-height:0px;";n.appendChild(this.document.createTextNode("‍"));n.id="_baidu_bookmark_start_"+(t?"":a++);if(!this.collapsed){i=n.cloneNode(!0);i.id="_baidu_bookmark_end_"+(t?"":a++)}this.insertNode(n);i&&this.collapse().insertNode(i).setEndBefore(i);this.setStartAfter(n);return{start:e?n.id:n,end:i?e?i.id:i:null,id:e}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,i=e.end&&e.id?this.document.getElementById(e.end):e.end;this.setStartBefore(t);domUtils.remove(t);if(i){this.setEndBefore(i);domUtils.remove(i)}else this.collapse(!0);return this},enlarge:function(e,t){var i,n,o=domUtils.isBody,r=this.document.createTextNode("");if(e){n=this.startContainer;if(1==n.nodeType)if(n.childNodes[this.startOffset])i=n=n.childNodes[this.startOffset];else{n.appendChild(r);i=n=r}else i=n;for(;;){if(domUtils.isBlockElm(n)){n=i;for(;(i=n.previousSibling)&&!domUtils.isBlockElm(i);)n=i;this.setStartBefore(n);break}i=n;n=n.parentNode}n=this.endContainer;if(1==n.nodeType){(i=n.childNodes[this.endOffset])?n.insertBefore(r,i):n.appendChild(r);i=n=r}else i=n;for(;;){if(domUtils.isBlockElm(n)){n=i;for(;(i=n.nextSibling)&&!domUtils.isBlockElm(i);)n=i;this.setEndAfter(n);break}i=n;n=n.parentNode}r.parentNode===this.endContainer&&this.endOffset--;domUtils.remove(r)}if(!this.collapsed){for(;0==this.startOffset&&(!t||!t(this.startContainer))&&!o(this.startContainer);)this.setStartBefore(this.startContainer);for(;this.endOffset==(1==this.endContainer.nodeType?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)&&(!t||!t(this.endContainer))&&!o(this.endContainer);)this.setEndAfter(this.endContainer)}return this},enlargeToBlockElm:function(e){for(;!domUtils.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!e)for(;!domUtils.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length&&this.startContainer[3==this.startContainer.nodeType?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[3==this.endContainer.nodeType?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(e,t,i){var n,o,r,s,a,l,d,c,u,m,f,h,p,g;if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(e){return 1==e.nodeType&&domUtils.isBlockElm(e)}).adjustmentBoundary();n=this.createBookmark(),o=n.end,r=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},s=domUtils.getNextDomNode(n.start,!1,r),d=this.cloneRange();for(;s&&domUtils.getPosition(s,o)&domUtils.POSITION_PRECEDING;)if(3==s.nodeType||dtd[e][s.tagName]){d.setStartBefore(s);a=s;for(;a&&(3==a.nodeType||dtd[e][a.tagName])&&a!==o;){l=a;a=domUtils.getNextDomNode(a,1==a.nodeType,null,function(t){return dtd[e][t.tagName]})}c=d.setEndAfter(l).extractContents();if(i&&i.length>0){f=m=i[0].cloneNode(!1);for(h=1;p=i[h++];){m.appendChild(p.cloneNode(!1));m=m.firstChild}u=m}else u=d.document.createElement(e);t&&domUtils.setAttributes(u,t);u.appendChild(c);d.insertNode(i?f:u);if("span"==e&&t.style&&/text\-decoration/.test(t.style)&&(g=domUtils.findParentByTagName(u,"a",!0))){domUtils.setAttributes(g,t);domUtils.remove(u,!0);u=g}else{domUtils.mergeSibling(u);domUtils.clearEmptySibling(u)}domUtils.mergeChild(u,t);s=domUtils.getNextDomNode(u,!1,r);domUtils.mergeToParent(u);if(a===o)break}else s=domUtils.getNextDomNode(s,!0,r);return this.moveToBookmark(n)},removeInlineStyle:function(e){var t,i,n,o,r,s,a;if(this.collapsed)return this;e=utils.isArray(e)?e:[e];this.shrinkBoundary().adjustmentBoundary();t=this.startContainer,i=this.endContainer;for(;;){if(1==t.nodeType){if(utils.indexOf(e,t.tagName.toLowerCase())>-1)break;if("body"==t.tagName.toLowerCase()){t=null;break}}t=t.parentNode}for(;;){if(1==i.nodeType){if(utils.indexOf(e,i.tagName.toLowerCase())>-1)break;if("body"==i.tagName.toLowerCase()){i=null;break}}i=i.parentNode}n=this.createBookmark();if(t){r=this.cloneRange().setEndBefore(n.start).setStartBefore(t);o=r.extractContents();r.insertNode(o);domUtils.clearEmptySibling(t,!0);t.parentNode.insertBefore(n.start,t)}if(i){r=this.cloneRange().setStartAfter(n.end).setEndAfter(i);o=r.extractContents();r.insertNode(o);domUtils.clearEmptySibling(i,!1,!0);i.parentNode.insertBefore(n.end,i.nextSibling)}s=domUtils.getNextDomNode(n.start,!1,function(e){return 1==e.nodeType});for(;s&&s!==n.end;){a=domUtils.getNextDomNode(s,!0,function(e){return 1==e.nodeType});utils.indexOf(e,s.tagName.toLowerCase())>-1&&domUtils.remove(s,!0);s=a}return this.moveToBookmark(n)},getClosedNode:function(){var e,i,n;if(!this.collapsed){i=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(t(i)){n=i.startContainer.childNodes[i.startOffset];n&&1==n.nodeType&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(e=n)}}return e},select:browser.ie?function(e,t){var i,n,a,d,c,u,m,f;this.collapsed||this.shrinkBoundary();n=this.getClosedNode();if(n&&!t){try{i=this.document.body.createControlRange();i.addElement(n);i.select()}catch(e){}return this}a=this.createBookmark(),d=a.start;i=this.document.body.createTextRange();i.moveToElementText(d);i.moveStart("character",1);if(this.collapsed){if(!e&&3!=this.startContainer.nodeType){m=this.document.createTextNode(l),f=this.document.createElement("span");f.appendChild(this.document.createTextNode(l));d.parentNode.insertBefore(f,d);d.parentNode.insertBefore(m,d);o(this.document,m);s=m;r(f,"previousSibling");r(d,"nextSibling");i.moveStart("character",-1);i.collapse(!0)}}else{u=this.document.body.createTextRange();c=a.end;u.moveToElementText(c);i.setEndPoint("EndToEnd",u)}this.moveToBookmark(a);f&&domUtils.remove(f);try{i.select()}catch(e){}return this}:function(e){function t(e){function t(t,i,n){3==t.nodeType&&t.nodeValue.length<i&&(e[n+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start");t(e.endContainer,e.endOffset,"end")}var i,n,a,d,c=domUtils.getWindow(this.document),u=c.getSelection();browser.gecko?this.document.body.focus():c.focus();if(u){u.removeAllRanges();if(this.collapsed&&!e){n=this.startContainer,a=n;1==n.nodeType&&(a=n.childNodes[this.startOffset]);if((3!=n.nodeType||!this.startOffset)&&(a?!a.previousSibling||3!=a.previousSibling.nodeType:!n.lastChild||3!=n.lastChild.nodeType)){i=this.document.createTextNode(l);this.insertNode(i);o(this.document,i);r(i,"previousSibling");r(i,"nextSibling");s=i;this.setStart(i,browser.webkit?1:0).collapse(!0)}}d=this.document.createRange();if(this.collapsed&&browser.opera&&1==this.startContainer.nodeType){a=this.startContainer.childNodes[this.startOffset];if(a){for(;a&&domUtils.isBlockElm(a)&&1==a.nodeType&&a.childNodes[0];)a=a.childNodes[0];a&&this.setStartBefore(a).collapse(!0)}else{a=this.startContainer.lastChild;a&&domUtils.isBr(a)&&this.setStartBefore(a).collapse(!0)}}t(this);d.setStart(this.startContainer,this.startOffset);d.setEnd(this.endContainer,this.endOffset);u.addRange(d)}return this},scrollToView:function(e,t){e=e?window:domUtils.getWindow(this.document);var i=this,n=i.document.createElement("span");n.innerHTML="&nbsp;";i.cloneRange().insertNode(n);domUtils.scrollToView(n,e,t);domUtils.remove(n);return i},inFillChar:function(){var e=this.startContainer;return!(!this.collapsed||3!=e.nodeType||e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1!=e.nodeValue.length)},createAddress:function(e,t){function i(e){var i,n,r,s,a,l=e?o.startContainer:o.endContainer,d=domUtils.findParents(l,!0,function(e){return!domUtils.isBody(e)}),c=[];for(i=0;n=d[i++];)c.push(domUtils.getNodeIndex(n,t));r=0;if(t)if(3==l.nodeType){s=l.previousSibling;for(;s&&3==s.nodeType;){r+=s.nodeValue.replace(fillCharReg,"").length;s=s.previousSibling}r+=e?o.startOffset:o.endOffset}else{l=l.childNodes[e?o.startOffset:o.endOffset];if(l)r=domUtils.getNodeIndex(l,t);else{l=e?o.startContainer:o.endContainer;a=l.firstChild;for(;a;)if(domUtils.isFillChar(a))a=a.nextSibling;else{r++;if(3==a.nodeType)for(;a&&3==a.nodeType;)a=a.nextSibling;else a=a.nextSibling}}}else r=e?domUtils.isFillChar(l)?0:o.startOffset:o.endOffset;r<0&&(r=0);c.push(r);return c}var n={},o=this;n.startAddress=i(!0);e||(n.endAddress=o.collapsed?[].concat(n.startAddress):i());return n},moveToAddress:function(e,t){function i(e,t){var i,o,r,s,a,l=n.document.body;for(r=0,a=e.length;r<a;r++){s=e[r];i=l;l=l.childNodes[s];if(!l){o=s;break}}t?l?n.setStartBefore(l):n.setStart(i,o):l?n.setEndBefore(l):n.setEnd(i,o)}var n=this;i(e.startAddress,!0);!t&&e.endAddress&&i(e.endAddress);return n},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},traversal:function(e,t){var i,n,o,r;if(this.collapsed)return this;i=this.createBookmark(),n=i.end,o=domUtils.getNextDomNode(i.start,!1,t);for(;o&&o!==n&&domUtils.getPosition(o,n)&domUtils.POSITION_PRECEDING;){r=domUtils.getNextDomNode(o,!1,t);e(o);o=r}return this.moveToBookmark(i)}}}();!function(){function e(e,t){var i,n,o,r,s,a,l,d,c,u,m,f=domUtils.getNodeIndex;e=e.duplicate();e.collapse(t);i=e.parentElement();if(!i.hasChildNodes())return{container:i,offset:0};n=i.children,r=e.duplicate(),s=0,a=n.length-1,l=-1;for(;s<=a;){l=Math.floor((s+a)/2);o=n[l];r.moveToElementText(o);c=r.compareEndPoints("StartToStart",e);if(c>0)a=l-1;else{if(!(c<0))return{container:i,offset:f(o)};s=l+1}}if(l==-1){r.moveToElementText(i);r.setEndPoint("StartToStart",e);d=r.text.replace(/(\r\n|\r)/g,"\n").length;n=i.childNodes;if(!d){o=n[n.length-1];return{container:o,offset:o.nodeValue.length}}u=n.length;for(;d>0;)d-=n[--u].nodeValue.length;return{container:n[u],offset:-d}}r.collapse(c>0);r.setEndPoint(c>0?"StartToStart":"EndToStart",e);d=r.text.replace(/(\r\n|\r)/g,"\n").length;if(!d)return dtd.$empty[o.tagName]||dtd.$nonChild[o.tagName]?{container:i,offset:f(o)+(c>0?0:1)}:{container:o,offset:c>0?0:o.childNodes.length};for(;d>0;)try{m=o;o=o[c>0?"previousSibling":"nextSibling"];d-=o.nodeValue.length}catch(e){return{container:i,offset:f(m)}}return{container:o,offset:c>0?-d:o.nodeValue.length+d}}function t(t,i){if(t.item)i.selectNode(t.item(0));else{var n=e(t,!0);i.setStart(n.container,n.offset);if(0!=t.compareEndPoints("StartToEnd",t)){n=e(t,!1);i.setEnd(n.container,n.offset)}}return i}function i(e){var t,i;try{t=e.getNative().createRange()}catch(e){return null}i=t.item?t.item(0):t.parentElement();return(i.ownerDocument||i)===e.document?t:null}var n=dom.Selection=function(e){var t,n=this;n.document=e;if(browser.ie9below){t=domUtils.getWindow(e).frameElement;domUtils.on(t,"beforedeactivate",function(){n._bakIERange=n.getIERange()});domUtils.on(t,"activate",function(){try{!i(n)&&n._bakIERange&&n._bakIERange.select()}catch(e){}n._bakIERange=null})}t=e=null};n.prototype={rangeInBody:function(e,t){var i=browser.ie9below||t?e.item?e.item():e.parentElement():e.startContainer;return i===this.document.body||domUtils.inDoc(i,this.document)},getNative:function(){var e=this.document;try{return e?browser.ie9below?e.selection:domUtils.getWindow(e).getSelection():null}catch(e){return null}},getIERange:function(){var e=i(this);return!e&&this._bakIERange?this._bakIERange:e},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?domUtils.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(browser.ie9below){var e=i(this);return!(!e||!this.rangeInBody(e))}return!!this.getNative().rangeCount}catch(e){return!1}},getRange:function(){function e(e){for(var t=a.document.body.firstChild,i=e.collapsed;t&&t.firstChild;){e.setStart(t,0);t=t.firstChild}e.startContainer||e.setStart(a.document.body,0);i&&e.collapse(!0)}var i,n,o,r,s,a=this;if(null!=a._cachedRange)return this._cachedRange;i=new baidu.editor.dom.Range(a.document);if(browser.ie9below){n=a.getIERange();if(n)try{t(n,i)}catch(t){e(i)}else e(i)}else{o=a.getNative();if(o&&o.rangeCount){r=o.getRangeAt(0);s=o.getRangeAt(o.rangeCount-1);i.setStart(r.startContainer,r.startOffset).setEnd(s.endContainer,s.endOffset);i.collapsed&&domUtils.isBody(i.startContainer)&&!i.startOffset&&e(i)}else{if(this._bakRange&&domUtils.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;e(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e,t,i,n,o=browser.ie9below?this.getIERange():this.getRange();if(browser.ie9below){if(!o)return this.document.body.firstChild;if(o.item)return o.item(0);e=o.duplicate();e.text.length>0&&e.moveStart("character",1);e.collapse(1);t=e.parentElement();n=i=o.parentElement();for(;i=i.parentNode;)if(i==t){t=n;break}}else{o.shrinkBoundary();t=o.startContainer;1==t.nodeType&&t.hasChildNodes()&&(t=t.childNodes[Math.min(t.childNodes.length-1,o.startOffset)]);if(3==t.nodeType)return t.parentNode}return t},getText:function(){var e,t;if(this.isFocus()&&(e=this.getNative())){t=browser.ie9below?e.createRange():e.getRangeAt(0);return browser.ie9below?t.text:t.toString()}return""},clearRange:function(){this.getNative()[browser.ie9below?"empty":"removeAllRanges"]()}}}();!function(){function e(e,t){var i,n,o,r;if(t.textarea)if(utils.isString(t.textarea)){for(n=0,r=domUtils.getElementsByTagName(e,"textarea");o=r[n++];)if(o.id=="ueditor_textarea_"+t.options.textarea){i=o;break}}else i=t.textarea;if(!i){e.appendChild(i=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"ueditor_textarea_"+t.options.textarea,style:"display:none"}));t.textarea=i}!i.getAttribute("name")&&i.setAttribute("name",t.options.textarea);i.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function t(e){for(var t in e)return t}function i(e){e.langIsReady=!0;e.fireEvent("langReady")}var n,o=0,r=UE.Editor=function(e){var n=this;n.uid=o++;EventBase.call(n);n.commands={};n.options=utils.extend(utils.clone(e||{}),UEDITOR_CONFIG,!0);n.shortcutkeys={};n.inputRules=[];n.outputRules=[];n.setOpt(r.defaultOptions(n));n.loadServerConfig();if(utils.isEmptyObject(UE.I18N))utils.loadFile(document,{src:n.options.langPath+n.options.lang+"/"+n.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(n);i(n)});else{n.options.lang=t(UE.I18N);UE.plugin.load(n);i(n)}UE.instants["ueditorInstant"+n.uid]=n};r.prototype={registerCommand:function(e,t){this.commands[e]=t},ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var i={};utils.isString(e)?i[e]=t:i=e;utils.extend(this.options,i,!0)},getOpt:function(e){return this.options[e]},destroy:function(){var e,t,i,n,o=this;o.fireEvent("destroy");e=o.container.parentNode;t=o.textarea;if(t)t.style.display="";else{t=document.createElement("textarea");e.parentNode.insertBefore(t,e)}t.style.width=o.iframe.offsetWidth+"px";t.style.height=o.iframe.offsetHeight+"px";t.value=o.getContent();t.id=o.key;e.innerHTML="";domUtils.remove(e);i=o.key;for(n in o)o.hasOwnProperty(n)&&delete this[n];UE.delEditor(i)},render:function(e){var t,i=this,n=i.options,o=function(t){return parseInt(domUtils.getComputedStyle(e,t))};utils.isString(e)&&(e=document.getElementById(e));if(e){n.initialFrameWidth?n.minFrameWidth=n.initialFrameWidth:n.minFrameWidth=n.initialFrameWidth=e.offsetWidth;n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=e.offsetHeight;e.style.width=/%$/.test(n.initialFrameWidth)?"100%":n.initialFrameWidth-o("padding-left")-o("padding-right")+"px";e.style.height=/%$/.test(n.initialFrameHeight)?"100%":n.initialFrameHeight-o("padding-top")-o("padding-bottom")+"px";e.style.zIndex=n.zIndex;t=(ie&&browser.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}</style>"+(n.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+utils.unhtml(n.iframeCssUrl)+"'/>":"")+(n.initialStyle?"<style>"+n.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+(ie?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+i.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>";e.appendChild(domUtils.createElement(document,"iframe",{id:"ueditor_"+i.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(n.customDomain&&document.domain!=location.hostname?'document.domain="'+document.domain+'";':"")+'document.write("'+t+'");document.close();}())'}));e.style.overflow="hidden";setTimeout(function(){/%$/.test(n.initialFrameWidth)&&(n.minFrameWidth=n.initialFrameWidth=e.offsetWidth);if(/%$/.test(n.initialFrameHeight)){n.minFrameHeight=n.initialFrameHeight=e.offsetHeight;e.style.height=n.initialFrameHeight+"px"}})}},_setup:function(t){var i,n,o,r=this,s=r.options;if(ie){t.body.disabled=!0;t.body.contentEditable=!0;t.body.disabled=!1}else t.body.contentEditable=!0;t.body.spellcheck=!1;r.document=t;r.window=t.defaultView||t.parentWindow;r.iframe=r.window.frameElement;r.body=t.body;r.selection=new dom.Selection(t);browser.gecko&&(i=this.selection.getNative())&&i.removeAllRanges();this._initEvents();for(n=this.iframe.parentNode;!domUtils.isBody(n);n=n.parentNode)if("FORM"==n.tagName){r.form=n;r.options.autoSyncData?domUtils.on(r.window,"blur",function(){e(n,r)}):domUtils.on(n,"submit",function(){e(this,r)});break}if(s.initialContent)if(s.autoClearinitialContent){o=r.execCommand;r.execCommand=function(){r.fireEvent("firstBeforeExecCommand");return o.apply(r,arguments)};this._setDefaultContent(s.initialContent)}else this.setContent(s.initialContent,!1,!0);domUtils.isEmptyNode(r.body)&&(r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>");s.focus&&setTimeout(function(){r.focus(r.options.focusInEnd);!r.options.autoClearinitialContent&&r._selectionChange()},0);r.container||(r.container=this.iframe.parentNode);s.fullscreen&&r.ui&&r.ui.setFullScreen(!0);try{r.document.execCommand("2D-position",!1,!1)}catch(e){}try{r.document.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}try{r.document.execCommand("enableObjectResizing",!1,!1)}catch(e){}r._bindshortcutKeys();r.isReady=1;r.fireEvent("ready");s.onready&&s.onready.call(r);browser.ie9below||domUtils.on(r.window,["blur","focus"],function(e){if("blur"==e.type){r._bakRange=r.selection.getRange();try{r._bakNativeRange=r.selection.getNative().getRangeAt(0);r.selection.getNative().removeAllRanges()}catch(e){r._bakNativeRange=null}}else try{r._bakRange&&r._bakRange.select()}catch(e){}});if(browser.gecko&&browser.version<=10902){r.body.contentEditable=!1;setTimeout(function(){r.body.contentEditable=!0},100);setInterval(function(){r.body.style.height=r.iframe.offsetHeight-20+"px"},100)}!s.isShow&&r.setHide();s.readonly&&r.setDisabled()},sync:function(t){var i=this,n=t?document.getElementById(t):domUtils.findParent(i.iframe.parentNode,function(e){return"FORM"==e.tagName},!0);n&&e(n,i)},setHeight:function(e,t){e!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=e+"px");!t&&(this.options.minFrameHeight=this.options.initialFrameHeight=e);this.body.style.height=e+"px";!t&&this.trigger("setHeight")},addshortcutkey:function(e,t){var i={};t?i[e]=t:i=e;utils.extend(this.shortcutkeys,i)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(i,n){var o,r,s,a,l,d,c=n.keyCode||n.which;for(o in t){r=t[o].split(",");for(s=0;a=r[s++];){a=a.split(":");l=a[0],d=a[1];if((/^(ctrl)(\+shift)?\+(\d+)$/.test(l.toLowerCase())||/^(\d+)$/.test(l))&&(("ctrl"==RegExp.$1?n.ctrlKey||n.metaKey:0)&&(""!=RegExp.$2?n[RegExp.$2.slice(1)+"Key"]:1)&&c==RegExp.$3||c==RegExp.$1)){e.queryCommandState(o,d)!=-1&&e.execCommand(o,d);domUtils.preventDefault(n)}}}})},getContent:function(e,t,i,n,o){var r,s=this;if(e&&utils.isFunction(e)){t=e;e=""}if(t?!t():!this.hasContents())return"";s.fireEvent("beforegetcontent");r=UE.htmlparser(s.body.innerHTML,n);s.filterOutputRule(r);s.fireEvent("aftergetcontent",e,r);return r.toHtml(o)},getAllHtml:function(){var e,t=this,i=[];t.fireEvent("getAllHtml",i);if(browser.ie&&browser.version>8){e="";utils.each(t.document.styleSheets,function(t){e+=t.href?'<link rel="stylesheet" type="text/css" href="'+t.href+'" />':"<style>"+t.cssText+"</style>"});utils.each(t.document.getElementsByTagName("script"),function(t){e+=t.outerHTML})}return"<html><head>"+(t.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+t.options.charset+'"/>':"")+(e||t.document.getElementsByTagName("head")[0].innerHTML)+i.join("\n")+"</head><body "+(ie&&browser.version<9?'class="view"':"")+">"+t.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>\/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,i){return dtd.$block[i]?"\n":t?t:""});return t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(t,i,n){function o(e){return"DIV"==e.tagName&&e.getAttribute("cdata_tag")}var r,s,a,l,d,c=this;c.fireEvent("beforesetcontent",t);r=UE.htmlparser(t);c.filterInputRule(r);t=r.toHtml();c.body.innerHTML=(i?c.body.innerHTML:"")+t;if("p"==c.options.enterTag){s=this.body.firstChild;if(!s||1==s.nodeType&&(dtd.$cdata[s.tagName]||o(s)||domUtils.isCustomeNode(s))&&s===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{l=c.document.createElement("p");for(;s;){for(;s&&(3==s.nodeType||1==s.nodeType&&dtd.p[s.tagName]&&!dtd.$cdata[s.tagName]);){a=s.nextSibling;l.appendChild(s);s=a}if(l.firstChild){if(!s){c.body.appendChild(l);break}s.parentNode.insertBefore(l,s);l=c.document.createElement("p")}s=s.nextSibling}}}c.fireEvent("aftersetcontent");c.fireEvent("contentchange");!n&&c._selectionChange();c._bakRange=c._bakIERange=c._bakNativeRange=null;browser.gecko&&(d=this.selection.getNative())&&d.removeAllRanges();c.options.autoSyncData&&c.form&&e(c.form,c)},focus:function(e){var t,i,n;try{t=this,i=t.selection.getRange();if(e){n=t.body.lastChild;if(n&&1==n.nodeType&&!dtd.$empty[n.tagName]){domUtils.isEmptyBlock(n)?i.setStartAtFirst(n):i.setStartAtLast(n);i.collapse(!0)}i.setCursor(!0)}else{if(!i.collapsed&&domUtils.isBody(i.startContainer)&&0==i.startOffset){n=t.body.firstChild;n&&1==n.nodeType&&!dtd.$empty[n.tagName]&&i.setStartAtFirst(n).collapse(!0)}i.select(!0)}this.fireEvent("focus selectionchange")}catch(e){}},isFocus:function(){return this.selection.isFocus()},blur:function(){var e,t=this.selection.getNative();if(t.empty&&browser.ie){e=document.body.createTextRange();e.moveToElementText(document.body);e.collapse(!0);e.select();t.empty()}else t.removeAllRanges()},_initEvents:function(){var e=this,t=e.document,i=e.window;e._proxyDomEvent=utils.bind(e._proxyDomEvent,e);domUtils.on(t,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],e._proxyDomEvent);domUtils.on(i,["focus","blur"],e._proxyDomEvent);domUtils.on(e.body,"drop",function(t){browser.gecko&&t.stopPropagation&&t.stopPropagation();e.fireEvent("contentchange")});domUtils.on(t,["mouseup","keydown"],function(t){"keydown"==t.type&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey)||2!=t.button&&e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent("before"+e.type.replace(/^on/,"").toLowerCase())!==!1&&(this.fireEvent(e.type.replace(/^on/,""),e)!==!1&&this.fireEvent("after"+e.type.replace(/^on/,"").toLowerCase()))},_selectionChange:function(e,t){var i,o,r,s=this,a=!1;if(browser.ie&&browser.version<9&&t&&"mouseup"==t.type){r=this.selection.getRange();if(!r.collapsed){a=!0;i=t.clientX;o=t.clientY}}clearTimeout(n);n=setTimeout(function(){var e,n;if(s.selection&&s.selection.getNative()){if(a&&"None"==s.selection.getNative().type){e=s.document.body.createTextRange();try{e.moveToPoint(i,o)}catch(t){e=null}}if(e){n=s.selection.getIERange;s.selection.getIERange=function(){return e}}s.selection.cache();n&&(s.selection.getIERange=n);if(s.selection._cachedRange&&s.selection._cachedStartElement){s.fireEvent("beforeselectionchange");s.fireEvent("selectionchange",!!t);s.fireEvent("afterselectionchange");s.selection.clear()}}},e||50)},_callCmdFn:function(e,t){var i,n,o=t[0].toLowerCase();i=this.commands[o]||UE.commands[o];n=i&&i[e];return i&&n||"queryCommandState"!=e?n?n.apply(this,t):void 0:0},execCommand:function(e){e=e.toLowerCase();var t,i=this,n=i.commands[e]||UE.commands[e];if(!n||!n.execCommand)return null;if(n.notNeedUndo||i.__hasEnterExecCommand){t=this._callCmdFn("execCommand",arguments);!i.__hasEnterExecCommand&&!n.ignoreContentChange&&!i._ignoreContentChange&&i.fireEvent("contentchange")}else{i.__hasEnterExecCommand=!0;if(i.queryCommandState.apply(i,arguments)!=-1){i.fireEvent("saveScene");i.fireEvent.apply(i,["beforeexeccommand",e].concat(arguments));t=this._callCmdFn("execCommand",arguments);i.fireEvent.apply(i,["afterexeccommand",e].concat(arguments));i.fireEvent("saveScene")}i.__hasEnterExecCommand=!1}!i.__hasEnterExecCommand&&!n.ignoreContentChange&&!i._ignoreContentChange&&i._selectionChange();return t},queryCommandState:function(e){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(e){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(e){var t,i,n,o,r;if(e)for(t=0;i=e[t++];)if(this.document.getElementsByTagName(i).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;e=["div"];for(t=0;i=e[t++];){n=domUtils.getElementsByTagName(this.document,i);for(o=0;r=n[o++];)if(domUtils.isCustomeNode(r))return!0}return!1},reset:function(){this.fireEvent("reset")},setEnabled:function(){var e,t=this;if("false"==t.body.contentEditable){t.body.contentEditable=!0;e=t.selection.getRange();try{e.moveToBookmark(t.lastBk);delete t.lastBk}catch(i){e.setStartAtFirst(t.body).collapse(!0)}e.select(!0);if(t.bkqueryCommandState){t.queryCommandState=t.bkqueryCommandState;delete t.bkqueryCommandState}if(t.bkqueryCommandValue){t.queryCommandValue=t.bkqueryCommandValue;delete t.bkqueryCommandValue}t.fireEvent("selectionchange")}},enable:function(){return this.setEnabled()},setDisabled:function(e){var t=this;e=e?utils.isArray(e)?e:[e]:[];if("true"==t.body.contentEditable){t.lastBk||(t.lastBk=t.selection.getRange().createBookmark(!0));t.body.contentEditable=!1;t.bkqueryCommandState=t.queryCommandState;t.bkqueryCommandValue=t.queryCommandValue;t.queryCommandState=function(i){return utils.indexOf(e,i)!=-1?t.bkqueryCommandState.apply(t,arguments):-1};t.queryCommandValue=function(i){return utils.indexOf(e,i)!=-1?t.bkqueryCommandValue.apply(t,arguments):null};t.fireEvent("selectionchange")}},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;if(t.document.getElementById("initContent")){t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";t.removeListener("firstBeforeExecCommand focus",e);setTimeout(function(){t.focus();t._selectionChange()},0)}}return function(t){var i=this;i.body.innerHTML='<p id="initContent">'+t+"</p>";
i.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if("none"==e.container.style.display){try{t.moveToBookmark(e.lastBk);delete e.lastBk}catch(i){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100);e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0));e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t,i,n=UE.I18N[this.options.lang];if(!n)throw Error("not import language file");e=(e||"").split(".");for(t=0;i=e[t++];){n=n[i];if(!n)break}return n},getContentLength:function(e,t){var i,n,o=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]);o=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(i=0;n=t[i++];)o+=this.document.getElementsByTagName(n).length}return o},addInputRule:function(e){this.inputRules.push(e)},filterInputRule:function(e){for(var t,i=0;t=this.inputRules[i++];)t.call(this,e)},addOutputRule:function(e){this.outputRules.push(e)},filterOutputRule:function(e){for(var t,i=0;t=this.outputRules[i++];)t.call(this,e)},getActionUrl:function(e){var t=this.getOpt(e)||e,i=this.getOpt("imageUrl"),n=this.getOpt("serverUrl");!n&&i&&(n=i.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));if(n){n=n+(n.indexOf("?")==-1?"?":"&")+"action="+(t||"");return utils.formatUrl(n)}return""}};utils.inherits(r,EventBase)}();UE.Editor.defaultOptions=function(e){var t=e.options.UEDITOR_HOME_URL;return{isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,iframeCssUrl:t+"themes/iframe.css",textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,imagePopup:!0,enterTag:"p",customDomain:!1,lang:"zh-cn",langPath:t+"lang/",theme:"default",themePath:t+"themes/",allHtmlEnabled:!1,scaleEnabled:!1,tableNativeEditInFF:!1,autoSyncData:!0,fileNameFormat:"{time}{rand:6}"}};!function(){UE.Editor.prototype.loadServerConfig=function(){function showErrorMsg(e){console&&console.error(e)}var me=this;setTimeout(function(){try{me.options.imageUrl&&me.setOpt("serverUrl",me.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var configUrl=me.getActionUrl("config"),isJsonp=utils.isCrossDomainUrl(configUrl);me._serverConfigLoaded=!1;configUrl&&UE.ajax.request(configUrl,{method:"GET",dataType:isJsonp?"jsonp":"",onsuccess:function(r){try{var config=isJsonp?r:eval("("+r.responseText+")");utils.extend(me.options,config);me.fireEvent("serverConfigLoaded");me._serverConfigLoaded=!0}catch(e){showErrorMsg(me.getLang("loadconfigFormatError"))}},onerror:function(){showErrorMsg(me.getLang("loadconfigHttpError"))}})}catch(e){showErrorMsg(me.getLang("loadconfigError"))}})};UE.Editor.prototype.isServerConfigLoaded=function(){var e=this;return e._serverConfigLoaded||!1};UE.Editor.prototype.afterConfigReady=function(e){var t,i;if(e&&utils.isFunction(e)){t=this;i=function(){e.apply(t,arguments);t.removeListener("serverConfigLoaded",i)};t.isServerConfigLoaded()?e.call(t,"serverConfigLoaded"):t.addListener("serverConfigLoaded",i)}}}();UE.ajax=function(){function e(e){var t,i,n=[];for(t in e)if("method"!=t&&"timeout"!=t&&"async"!=t&&"dataType"!=t&&"callback"!=t&&void 0!=e[t]&&null!=e[t])if("function"!=(typeof e[t]).toLowerCase()&&"object"!=(typeof e[t]).toLowerCase())n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));else if(utils.isArray(e[t]))for(i=0;i<e[t].length;i++)n.push(encodeURIComponent(t)+"[]="+encodeURIComponent(e[t][i]));return n.join("&")}function t(t,i){var o,r,s,a,l,d=n(),c=!1,u={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}};if("object"===typeof t){i=t;t=i.url}if(d&&t){o=i?utils.extend(u,i):u;r=e(o);utils.isEmptyObject(o.data)||(r+=(r?"&":"")+e(o.data));s=setTimeout(function(){if(4!=d.readyState){c=!0;d.abort();clearTimeout(s)}},o.timeout);a=o.method.toUpperCase();l=t+(t.indexOf("?")==-1?"?":"&")+("POST"==a?"":r+"&noCache="+ +new Date);d.open(a,l,o.async);d.onreadystatechange=function(){4==d.readyState&&(c||200!=d.status?o.onerror(d):o.onsuccess(d))};if("POST"==a){d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(r)}else d.send(null)}}function i(t,i){function n(e,t,i){e.setAttribute("type","text/javascript");e.setAttribute("defer","defer");i&&e.setAttribute("charset",i);e.setAttribute("src",t);document.getElementsByTagName("head")[0].appendChild(e)}function o(e){return function(){try{if(e)u.onerror&&u.onerror();else try{clearTimeout(s);d.apply(window,arguments)}catch(e){}}catch(e){u.onerror&&u.onerror.call(window,e)}finally{u.oncomplete&&u.oncomplete.apply(window,arguments);c.parentNode&&c.parentNode.removeChild(c);window[r]=null;try{delete window[r]}catch(e){}}}}var r,s,a,l,d=i.onsuccess||function(){},c=document.createElement("SCRIPT"),u=i||{},m=u["charset"],f=u["jsonp"]||"callback",h=u["timeOut"]||0,p=new RegExp("(\\?|&)"+f+"=([^&]*)");if(utils.isFunction(d)){r="bd__editor__"+Math.floor(2147483648*Math.random()).toString(36);window[r]=o(0)}else utils.isString(d)?r=d:(a=p.exec(t))&&(r=a[2]);t=t.replace(p,"$1"+f+"="+r);t.search(p)<0&&(t+=(t.indexOf("?")<0?"?":"&")+f+"="+r);l=e(i);utils.isEmptyObject(i.data)||(l+=(l?"&":"")+e(i.data));l&&(t=t.replace(/\?/,"?"+l+"&"));c.onerror=o(1);h&&(s=setTimeout(o(1),h));n(c,t,m)}var n,o="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");o="ActiveXObject('Msxml2.XMLHTTP')"}catch(e){try{new ActiveXObject("Microsoft.XMLHTTP");o="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}n=new Function("return new "+o);return{request:function(e,n){n&&"jsonp"==n.dataType?i(e,n):t(e,n)},getJSONP:function(e,t,n){var o={data:t,oncomplete:n};i(e,o)}}}();filterWord=UE.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/gi.test(e)}function t(e){e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)});return e}function i(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/gi,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{if(/Bitmap/i.test(e))return"";var i=e.match(/width:([ \d.]*p[tx])/i)[1],n=e.match(/height:([ \d.]*p[tx])/i)[1],o=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(i)+'" height="'+t(n)+'" src="'+o+'" />'}catch(e){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/gi,function(e,t,i,n){return"class"==t&&"MsoListParagraph"==n?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,i){return i.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,i,n,o){var r,s,a,l,d,c=[],u=o.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)}).split(/;\s*/g);for(r=0;s=u[r];r++){d=s.split(":");if(2==d.length){a=d[0].toLowerCase();l=d[1].toLowerCase();if(/^(background)\w*/.test(a)&&0==l.replace(/(initial|\s)/g,"").length||/^(margin)\w*/.test(a)&&/^0\w+$/.test(l))continue;switch(a){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(i)||(c[r]=a.replace(/^mso-|-alt$/g,"")+":"+t(l));continue;case"horiz-align":c[r]="text-align:"+l;continue;case"vert-align":c[r]="vertical-align:"+l;continue;case"font-color":case"mso-foreground":c[r]="color:"+l;continue;case"mso-background":case"mso-highlight":c[r]="background:"+l;continue;case"mso-default-height":c[r]="min-height:"+t(l);continue;case"mso-default-width":c[r]="min-width:"+t(l);continue;case"mso-padding-between-alt":c[r]="border-collapse:separate;border-spacing:"+t(l);continue;case"text-line-through":"single"!=l&&"double"!=l||(c[r]="text-decoration:line-through");continue;case"mso-zero-height":"yes"==l&&(c[r]="display:none");continue;case"margin":if(!/[1-9]/.test(l))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(a)||/text\-indent|padding|margin/.test(a)&&/\-[\d.]+/.test(l))continue;c[r]=a+":"+d[1]}}return i+(c.length?' style="'+c.join(";").replace(/;{2,}/g,";")+'"':"")})}return function(t){return e(t)?i(t):t}}();!function(){function e(e,t,i){e.push(f);return t+(i?1:-1)}function t(e,t){for(var i=0;i<t;i++)e.push(m)}function i(s,a,l,d){switch(s.type){case"root":for(var c,u=0;c=s.children[u++];){if(l&&"element"==c.type&&!dtd.$inlineWithA[c.tagName]&&u>1){e(a,d,!0);t(a,d)}i(c,a,l,d)}break;case"text":n(s,a);break;case"element":o(s,a,l,d);break;case"comment":r(s,a,l)}return a}function n(e,t){"pre"==e.parentNode.tagName?t.push(e.data):t.push(u[e.parentNode.tagName]?utils.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}function o(n,o,r,s){var a,l,d,u,m="";if(n.attrs){m=[];a=n.attrs;for(l in a)m.push(l+(void 0!==a[l]?'="'+(c[l]?utils.html(a[l]).replace(/["]/g,function(e){return"&quot;"}):utils.unhtml(a[l]))+'"':""));m=m.join(" ")}o.push("<"+n.tagName+(m?" "+m:"")+(dtd.$empty[n.tagName]?"/":"")+">");if(r&&!dtd.$inlineWithA[n.tagName]&&"pre"!=n.tagName&&n.children&&n.children.length){s=e(o,s,!0);t(o,s)}if(n.children&&n.children.length)for(d=0;u=n.children[d++];){if(r&&"element"==u.type&&!dtd.$inlineWithA[u.tagName]&&d>1){e(o,s);t(o,s)}i(u,o,r,s)}if(!dtd.$empty[n.tagName]){if(r&&!dtd.$inlineWithA[n.tagName]&&"pre"!=n.tagName&&n.children&&n.children.length){s=e(o,s);t(o,s)}o.push("</"+n.tagName+">")}}function r(e,t){t.push("<!--"+e.data+"-->")}function s(e,t){var i,n,o;if("element"==e.type&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(n=0;o=e.children[n++];)if(i=s(o,t))return i}function a(e,t,i){"element"==e.type&&e.tagName==t&&i.push(e);if(e.children&&e.children.length)for(var n,o=0;n=e.children[o++];)a(n,t,i)}function l(e,t){if(e.children&&e.children.length)for(var i,n=0;i=e.children[n];){l(i,t);if(i.parentNode){i.children&&i.children.length&&t(i);i.parentNode&&n++}}else t(e)}var d=UE.uNode=function(e){this.type=e.type;this.data=e.data;this.tagName=e.tagName;this.parentNode=e.parentNode;this.attrs=e.attrs||{};this.children=e.children},c={href:1,src:1,_src:1,_href:1,cdata_data:1},u={style:1,script:1},m="    ",f="\n";d.createElement=function(e){return/[<>]/.test(e)?UE.htmlparser(e).children[0]:new d({type:"element",children:[],tagName:e})};d.createText=function(e,t){return new UE.uNode({type:"text",data:t?e:utils.unhtml(e||"")})};d.prototype={toHtml:function(e){var t=[];i(this,t,e,0);return t.join("")},innerHTML:function(e){var t,i,n;if("element"!=this.type||dtd.$empty[this.tagName])return this;if(utils.isString(e)){if(this.children)for(t=0;i=this.children[t++];)i.parentNode=null;this.children=[];n=UE.htmlparser(e);for(t=0;i=n.children[t++];){this.children.push(i);i.parentNode=this}return this}n=new UE.uNode({type:"root",children:this.children});return n.toHtml()},innerText:function(e,t){if("element"!=this.type||dtd.$empty[this.tagName])return this;if(e){if(this.children)for(var i,n=0;i=this.children[n++];)i.parentNode=null;this.children=[];this.appendChild(d.createText(e,t));return this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return"element"==this.type?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){var e,t,i=this.parentNode;for(e=0;t=i.children[e];e++)if(t===this)return 0==e?null:i.children[e-1]},nextSibling:function(){var e,t,i=this.parentNode;for(e=0;t=i.children[e++];)if(t===this)return i.children[e]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var i,n=0;i=this.children[n];n++)if(i===t){this.children.splice(n,1,e);t.parentNode=null;e.parentNode=this;return e}}},appendChild:function(e){if("root"==this.type||"element"==this.type&&!dtd.$empty[this.tagName]){this.children||(this.children=[]);e.parentNode&&e.parentNode.removeChild(e);for(var t,i=0;t=this.children[i];i++)if(t===e){this.children.splice(i,1);break}this.children.push(e);e.parentNode=this;return e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var i,n=0;i=this.children[n];n++)if(i===t){this.children.splice(n,0,e);e.parentNode=this;return e}}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var i,n=0;i=this.children[n];n++)if(i===t){this.children.splice(n+1,0,e);e.parentNode=this;return e}}},removeChild:function(e,t){var i,n,o,r;if(this.children)for(i=0;n=this.children[i];i++)if(n===e){this.children.splice(i,1);n.parentNode=null;if(t&&n.children&&n.children.length)for(o=0;r=n.children[o];o++){this.children.splice(i+o,0,r);r.parentNode=this}return n}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(e){this.attrs||(this.attrs={});if(utils.isObject(e))for(var i in e)e[i]?this.attrs[i.toLowerCase()]=e[i]:delete this.attrs[i];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]}else delete this.attrs},getIndex:function(){var e,t,i=this.parentNode;for(e=0;t=i.children[e];e++)if(t===this)return e;return-1},getNodeById:function(e){var t,i,n;if(this.children&&this.children.length)for(i=0;n=this.children[i++];)if(t=s(n,e))return t},getNodesByTagName:function(e){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],i=this;utils.each(e,function(e){if(i.children&&i.children.length)for(var n,o=0;n=i.children[o++];)a(n,e,t)});return t},getStyle:function(e){var t,i,n=this.getAttr("style");if(!n)return"";t=new RegExp("(^|;)\\s*"+e+":([^;]+)","i");i=n.match(t);return i&&i[0]?i[2]:""},setStyle:function(e,t){function i(e,t){var i=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");o=o.replace(i,"$1");t&&(o=e+":"+utils.unhtml(t)+";"+o)}var n,o=this.getAttr("style");o||(o="");if(utils.isObject(e))for(n in e)i(n,e[n]);else i(e,t);this.setAttr("style",utils.trim(o))},traversal:function(e){this.children&&this.children.length&&l(this,e);return this}}}();htmlparser=UE.htmlparser=function(e,t){function i(e,t){if(l[e.tagName]){var i=s.createElement(l[e.tagName]);e.appendChild(i);i.appendChild(s.createText(t));e=i}else e.appendChild(s.createText(t))}function n(e,t,i){var o,l,d,c,u,m;if(o=a[t]){l=e;for(;"root"!=l.type;){if(utils.isArray(o)?utils.indexOf(o,l.tagName)!=-1:o==l.tagName){e=l;d=!0;break}l=l.parentNode}d||(e=n(e,utils.isArray(o)?o[0]:o))}c=new s({parentNode:e,type:"element",tagName:t.toLowerCase(),children:dtd.$empty[t]?null:[]});if(i){u={};for(;m=g.exec(i);)u[m[1].toLowerCase()]=r[m[1].toLowerCase()]?m[2]||m[3]||m[4]:utils.unhtml(m[2]||m[3]||m[4]);c.attrs=u}e.children.push(c);return dtd.$empty[t]?e:c}function o(e,t){e.children.push(new s({type:"comment",data:t,parentNode:e}))}var r,s,a,l,d,c,u,m,f,h,p=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,g=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,b={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(domUtils.fillChar,"g"),"");t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,i){return i&&b[i.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));r={href:1,src:1};s=UE.uNode,a={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},l={ol:"li",ul:"li"};c=0,u=0;m=new s({type:"root",children:[]});f=m;for(;d=p.exec(e);){c=d.index;try{c>u&&i(f,e.slice(u,c));if(d[3])dtd.$cdata[f.tagName]?i(f,d[0]):f=n(f,d[3].toLowerCase(),d[4]);else if(d[1]){if("root"!=f.type)if(dtd.$cdata[f.tagName]&&!dtd.$cdata[d[1]])i(f,d[0]);else{h=f;for(;"element"==f.type&&f.tagName!=d[1].toLowerCase();){f=f.parentNode;if("root"==f.type){f=h;throw"break"}}f=f.parentNode}}else d[2]&&o(f,d[2])}catch(e){}u=p.lastIndex}u<e.length&&i(f,e.slice(u));return m};filterNode=UE.filterNode=function(){function e(t,i){var n,o,r,s,a,l,d,c,u,m;switch(t.type){case"text":break;case"element":if(n=i[t.tagName])if("-"===n)t.parentNode.removeChild(t);else if(utils.isFunction(n)){o=t.parentNode,r=t.getIndex();n(t);if(t.parentNode){if(t.children)for(s=0;a=t.children[s];){e(a,i);a.parentNode&&s++}}else for(s=r;a=o.children[s];){e(a,i);a.parentNode&&s++}}else{l=n["$"];if(l&&t.attrs){d={};for(u in l){c=t.getAttr(u);if("style"==u&&utils.isArray(l[u])){m=[];utils.each(l[u],function(e){var i;(i=t.getStyle(e))&&m.push(e+":"+i)});c=m.join(";")}c&&(d[u]=c)}t.attrs=d}if(t.children)for(s=0;a=t.children[s];){e(a,i);a.parentNode&&s++}}else if(dtd.$cdata[t.tagName])t.parentNode.removeChild(t);else{o=t.parentNode,r=t.getIndex();t.parentNode.removeChild(t,!0);for(s=r;a=o.children[s];){e(a,i);a.parentNode&&s++}}break;case"comment":t.parentNode.removeChild(t)}}return function(t,i){var n,o,r;if(utils.isEmptyObject(i))return t;(n=i["-"])&&utils.each(n.split(" "),function(e){i[e]="-"});for(o=0;r=t.children[o];){e(r,i);r.parentNode&&o++}return t}}();UE.plugin=function(){var e={};return{register:function(t,i,n,o){if(n&&utils.isFunction(n)){o=n;n=null}e[t]={optionName:n||t,execFn:i,afterDisabled:o}},load:function(t){utils.each(e,function(e){var i=e.execFn.call(t);t.options[e.optionName]!==!1?i&&utils.each(i,function(e,i){switch(i.toLowerCase()){case"shortcutkey":t.addshortcutkey(e);break;case"bindevents":utils.each(e,function(e,i){t.addListener(i,e)});break;case"bindmultievents":utils.each(utils.isArray(e)?e:[e],function(e){var i=utils.trim(e.type).split(/\s+/);utils.each(i,function(i){t.addListener(i,e.handler)})});break;case"commands":utils.each(e,function(e,i){t.commands[i]=e});break;case"outputrule":t.addOutputRule(e);break;case"inputrule":t.addInputRule(e);break;case"defaultoptions":t.setOpt(e)}}):e.afterDisabled&&e.afterDisabled.call(t)});utils.each(UE.plugins,function(e){e.call(t)})},run:function(t,i){var n=e[t];n&&n.exeFn.call(i)}}}();keymap=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78};LocalStorage=UE.LocalStorage=function(){function e(){var e=document.createElement("div");e.style.display="none";if(!e.addBehavior)return null;e.addBehavior("#default#userdata");return{getItem:function(t){var n=null;try{document.body.appendChild(e);e.load(i);n=e.getAttribute(t);document.body.removeChild(e)}catch(e){}return n},setItem:function(t,n){document.body.appendChild(e);e.setAttribute(t,n);e.save(i);document.body.removeChild(e)},removeItem:function(t){document.body.appendChild(e);e.removeAttribute(t);e.save(i);document.body.removeChild(e)}}}var t=window.localStorage||e()||null,i="localStorage";return{saveLocalData:function(e,i){if(t&&i){t.setItem(e,i);return!0}return!1},getLocalData:function(e){return t?t.getItem(e):null},removeItem:function(e){t&&t.removeItem(e)}}}();!function(){var e="ueditor_preference";UE.Editor.prototype.setPreferences=function(t,i){var n,o={};utils.isString(t)?o[t]=i:o=t;n=LocalStorage.getLocalData(e);n&&(n=utils.str2json(n))?utils.extend(n,o):n=o;n&&LocalStorage.saveLocalData(e,utils.json2str(n))};UE.Editor.prototype.getPreferences=function(t){var i=LocalStorage.getLocalData(e);return i&&(i=utils.str2json(i))?t?i[t]:i:null};UE.Editor.prototype.removePreferences=function(t){var i=LocalStorage.getLocalData(e);if(i&&(i=utils.str2json(i))){i[t]=void 0;delete i[t]}i&&LocalStorage.saveLocalData(e,utils.json2str(i))}}();UE.plugins["defaultfilter"]=function(){var e=this;e.setOpt({allowDivTransToP:!1,disabledTableInTable:!0});e.addInputRule(function(t){function i(e){for(;e&&"element"==e.type;){if("td"==e.tagName)return!0;e=e.parentNode}return!1}var n,o=this.options.allowDivTransToP;t.traversal(function(t){if("element"==t.type){if(!dtd.$cdata[t.tagName]&&e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs))){t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t);return}switch(t.tagName){case"a":(n=t.getAttr("href"))&&t.setAttr("_href",n);break;case"img":if((n=t.getAttr("src"))&&/^data:/.test(n)){t.parentNode.removeChild(t);break}t.setAttr("_src",t.getAttr("src"));break;case"span":if(browser.webkit&&(n=t.getStyle("white-space"))&&/nowrap|normal/.test(n)){t.setStyle("white-space","");e.options.autoClearEmptyNode&&utils.isEmptyObject(t.attrs)&&t.parentNode.removeChild(t,!0)}n=t.getAttr("id");n&&/^_baidu_bookmark_/i.test(n)&&t.parentNode.removeChild(t);break;case"p":if(n=t.getAttr("align")){t.setAttr("align");t.setStyle("text-align",n)}utils.each(t.children,function(e){var i,n,o;if("element"==e.type&&"p"==e.tagName){i=e.nextSibling();t.parentNode.insertAfter(e,t);n=e;for(;i;){o=i.nextSibling();t.parentNode.insertAfter(i,n);n=i;i=o}return!1}});t.firstChild()||t.innerHTML(browser.ie?"&nbsp;":"<br/>");break;case"div":if(t.getAttr("cdata_tag"))break;n=t.getAttr("class");if(n&&/^line number\d+/.test(n))break;if(!o)break;for(var r,s=UE.uNode.createElement("p");r=t.firstChild();)if("text"!=r.type&&UE.dom.dtd.$block[r.tagName])if(s.firstChild()){t.parentNode.insertBefore(s,t);s=UE.uNode.createElement("p")}else t.parentNode.insertBefore(r,t);else s.appendChild(r);s.firstChild()&&t.parentNode.insertBefore(s,t);t.parentNode.removeChild(t);break;case"dl":t.tagName="ul";break;case"dt":case"dd":t.tagName="li";break;case"td":case"th":case"caption":t.children&&t.children.length||t.appendChild(browser.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case"table":if(e.options.disabledTableInTable&&i(t)){t.parentNode.insertBefore(UE.uNode.createText(t.innerText()),t);t.parentNode.removeChild(t)}}}})});e.addOutputRule(function(t){var i;t.traversal(function(t){if("element"==t.type){if(e.options.autoClearEmptyNode&&dtd.$inline[t.tagName]&&!dtd.$empty[t.tagName]&&(!t.attrs||utils.isEmptyObject(t.attrs))){t.firstChild()?"span"!=t.tagName||t.attrs&&!utils.isEmptyObject(t.attrs)||t.parentNode.removeChild(t,!0):t.parentNode.removeChild(t);return}switch(t.tagName){case"div":if(i=t.getAttr("cdata_tag")){t.tagName=i;t.appendChild(UE.uNode.createText(t.getAttr("cdata_data")));t.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""})}break;case"a":(i=t.getAttr("_href"))&&t.setAttr({href:utils.html(i),_href:""});break;break;case"span":i=t.getAttr("id");i&&/^_baidu_bookmark_/i.test(i)&&t.parentNode.removeChild(t);break;case"img":(i=t.getAttr("_src"))&&t.setAttr({src:t.getAttr("_src"),_src:""})}}})})};UE.commands["inserthtml"]={execCommand:function(e,t,i){var n,o,r,s,a,l,d,c,u,m,f,h,p,g,b,y=this;if(t&&y.fireEvent("beforeinserthtml",t)!==!0){n=y.selection.getRange();o=n.document.createElement("div");o.style.display="inline";if(!i){r=UE.htmlparser(t);y.options.filterRules&&UE.filterNode(r,y.options.filterRules);y.filterInputRule(r);t=r.toHtml()}o.innerHTML=utils.trim(t);if(!n.collapsed){s=n.startContainer;domUtils.isFillChar(s)&&n.setStartBefore(s);s=n.endContainer;domUtils.isFillChar(s)&&n.setEndAfter(s);n.txtToElmBoundary();if(n.endContainer&&1==n.endContainer.nodeType){s=n.endContainer.childNodes[n.endOffset];s&&domUtils.isBr(s)&&n.setEndAfter(s)}if(0==n.startOffset){s=n.startContainer;if(domUtils.isBoundaryNode(s,"firstChild")){s=n.endContainer;if(n.endOffset==(3==s.nodeType?s.nodeValue.length:s.childNodes.length)&&domUtils.isBoundaryNode(s,"lastChild")){y.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";n.setStart(y.body.firstChild,0).collapse(!0)}}}!n.collapsed&&n.deleteContents();if(1==n.startContainer.nodeType){a=n.startContainer.childNodes[n.startOffset];if(a&&domUtils.isBlockElm(a)&&(l=a.previousSibling)&&domUtils.isBlockElm(l)){n.setEnd(l,l.childNodes.length).collapse();for(;a.firstChild;)l.appendChild(a.firstChild);domUtils.remove(a)}}}u=0;if(n.inFillChar()){a=n.startContainer;if(domUtils.isFillChar(a)){n.setStartBefore(a).collapse(!0);domUtils.remove(a)}else if(domUtils.isFillChar(a,!0)){a.nodeValue=a.nodeValue.replace(fillCharReg,"");n.startOffset--;n.collapsed&&n.collapse(!0)}}f=domUtils.findParentByTagName(n.startContainer,"li",!0);if(f){for(;a=o.firstChild;){for(;a&&(3==a.nodeType||!domUtils.isBlockElm(a)||"HR"==a.tagName);){h=a.nextSibling;n.insertNode(a).collapse();p=a;a=h}if(a)if(/^(ol|ul)$/i.test(a.tagName)){for(;a.firstChild;){p=a.firstChild;domUtils.insertAfter(f,a.firstChild);f=f.nextSibling}domUtils.remove(a)}else{h=a.nextSibling;g=y.document.createElement("li");domUtils.insertAfter(f,g);g.appendChild(a);p=a;a=h;f=g}}f=domUtils.findParentByTagName(n.startContainer,"li",!0);domUtils.isEmptyBlock(f)&&domUtils.remove(f);p&&n.setStartAfter(p).collapse(!0).select(!0)}else{for(;a=o.firstChild;){if(u){b=y.document.createElement("p");for(;a&&(3==a.nodeType||!dtd.$block[a.tagName]);){m=a.nextSibling;b.appendChild(a);a=m}b.firstChild&&(a=b)}n.insertNode(a);m=a.nextSibling;if(!u&&a.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(a)){d=domUtils.findParent(a,function(e){return domUtils.isBlockElm(e)});if(d&&"body"!=d.tagName.toLowerCase()&&(!dtd[d.tagName][a.nodeName]||a.parentNode!==d)){if(dtd[d.tagName][a.nodeName]){c=a.parentNode;for(;c!==d;){l=c;c=c.parentNode}}else l=d;domUtils.breakParent(a,l||c);l=a.previousSibling;domUtils.trimWhiteTextNode(l);l.childNodes.length||domUtils.remove(l);!browser.ie&&(h=a.nextSibling)&&domUtils.isBlockElm(h)&&h.lastChild&&!domUtils.isBr(h.lastChild)&&h.appendChild(y.document.createElement("br"));u=1}}h=a.nextSibling;if(!o.firstChild&&h&&domUtils.isBlockElm(h)){n.setStart(h,0).collapse(!0);break}n.setEndAfter(a).collapse()}a=n.startContainer;m&&domUtils.isBr(m)&&domUtils.remove(m);if(domUtils.isBlockElm(a)&&domUtils.isEmptyNode(a))if(m=a.nextSibling){domUtils.remove(a);1==m.nodeType&&dtd.$block[m.tagName]&&n.setStart(m,0).collapse(!0).shrinkBoundary()}else try{a.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(e){n.setStartBefore(a);domUtils.remove(a)}try{n.select(!0)}catch(e){}}setTimeout(function(){n=y.selection.getRange();n.scrollToView(y.autoHeightEnabled,y.autoHeightEnabled?domUtils.getXY(y.iframe).y:0);y.fireEvent("afterinserthtml",t)},200)}}};UE.plugins["autotypeset"]=function(){function e(e,t){return e&&3!=e.nodeType?domUtils.isBr(e)?1:e&&e.parentNode&&u[e.tagName.toLowerCase()]?s&&s.contains(e)||e.getAttribute("pagebreak")?0:t?!domUtils.isEmptyBlock(e):domUtils.isEmptyBlock(e,new RegExp("[\\s"+domUtils.fillChar+"]","g")):void 0:0}function t(e){if(!e.style.cssText){domUtils.removeAttributes(e,["style"]);"span"==e.tagName.toLowerCase()&&domUtils.hasNoAttributes(e)&&domUtils.remove(e,!0)}}function i(i,r){var a,u,m,f,h,p,g,b,y,v,C,N,x,w=this;if(r){if(!l.pasteFilter)return;a=w.document.createElement("div");a.innerHTML=r.html}else a=w.document.body;u=domUtils.getElementsByTagName(a,"*");for(m=0;f=u[m++];)if(w.fireEvent("excludeNodeinautotype",f)!==!0){if(l.clearFontSize&&f.style.fontSize){domUtils.removeStyle(f,"font-size");t(f)}if(l.clearFontFamily&&f.style.fontFamily){domUtils.removeStyle(f,"font-family");t(f)}if(e(f)){if(l.mergeEmptyline){h=f.nextSibling,g=domUtils.isBr(f);for(;e(h);){p=h;h=p.nextSibling;if(g&&(!h||h&&!domUtils.isBr(h)))break;domUtils.remove(p)}}if(l.removeEmptyline&&domUtils.inDoc(f,a)&&!c[f.parentNode.tagName.toLowerCase()]){if(domUtils.isBr(f)){h=f.nextSibling;if(h&&!domUtils.isBr(h))continue}domUtils.remove(f);continue}}if(e(f,!0)&&"SPAN"!=f.tagName){l.indent&&(f.style.textIndent=l.indentValue);l.textAlign&&(f.style.textAlign=l.textAlign)}if(l.removeClass&&f.className&&!d[f.className.toLowerCase()]){if(s&&s.contains(f))continue;domUtils.removeAttributes(f,["class"])}if(l.imageBlockLine&&"img"==f.tagName.toLowerCase()&&!f.getAttribute("emotion"))if(r){b=f;switch(l.imageBlockLine){case"left":case"right":case"none":y=b.parentNode;for(;dtd.$inline[y.tagName]||"A"==y.tagName;)y=y.parentNode;p=y;if("P"==p.tagName&&"center"==domUtils.getStyle(p,"text-align")&&!domUtils.isBody(p)&&1==domUtils.getChildCount(p,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})){v=p.previousSibling;h=p.nextSibling;if(v&&h&&1==v.nodeType&&1==h.nodeType&&v.tagName==h.tagName&&domUtils.isBlockElm(v)){v.appendChild(p.firstChild);for(;h.firstChild;)v.appendChild(h.firstChild);domUtils.remove(p);domUtils.remove(h)}else domUtils.setStyle(p,"text-align","")}domUtils.setStyle(b,"float",l.imageBlockLine);break;case"center":if("center"!=w.queryCommandValue("imagefloat")){y=b.parentNode;domUtils.setStyle(b,"float","none");p=b;for(;y&&1==domUtils.getChildCount(y,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})&&(dtd.$inline[y.tagName]||"A"==y.tagName);){p=y;y=y.parentNode}C=w.document.createElement("p");domUtils.setAttributes(C,{style:"text-align:center"});p.parentNode.insertBefore(C,p);C.appendChild(p);domUtils.setStyle(p,"float","")}}}else{N=w.selection.getRange();N.selectNode(f).select();w.execCommand("imagefloat",l.imageBlockLine)}l.removeEmptyNode&&l.removeTagNames[f.tagName.toLowerCase()]&&domUtils.hasNoAttributes(f)&&domUtils.isEmptyBlock(f)&&domUtils.remove(f)}if(l.tobdc){x=UE.htmlparser(a.innerHTML);x.traversal(function(e){"text"==e.type&&(e.data=o(e.data))});a.innerHTML=x.toHtml()}if(l.bdc2sb){x=UE.htmlparser(a.innerHTML);x.traversal(function(e){"text"==e.type&&(e.data=n(e.data))});a.innerHTML=x.toHtml()}r&&(r.html=a.innerHTML)}function n(e){var t,i,n="";for(t=0;t<e.length;t++){i=e.charCodeAt(t);n+=i>=65281&&i<=65373?String.fromCharCode(e.charCodeAt(t)-65248):12288==i?String.fromCharCode(e.charCodeAt(t)-12288+32):e.charAt(t)}return n}function o(e){var t,i,n;e=utils.html(e);t="";i="";for(n=0;n<e.length;n++)t+=32==e.charCodeAt(n)?String.fromCharCode(12288):e.charCodeAt(n)<127?String.fromCharCode(e.charCodeAt(n)+65248):e.charAt(n);return t}function r(){var e=a.getPreferences("autotypeset");utils.extend(a.options.autotypeset,e)}this.setOpt({autotypeset:{mergeEmptyline:!0,removeClass:!0,removeEmptyline:!1,textAlign:"left",imageBlockLine:"center",pasteFilter:!1,clearFontSize:!1,clearFontFamily:!1,removeEmptyNode:!1,removeTagNames:utils.extend({div:1},dtd.$removeEmpty),indent:!1,indentValue:"2em",bdc2sb:!1,tobdc:!1}});var s,a=this,l=a.options.autotypeset,d={selectTdClass:1,pagebreak:1,anchorclass:1},c={li:1},u={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1};if(l){r();l.pasteFilter&&a.addListener("beforepaste",i);a.commands["autotypeset"]={execCommand:function(){a.removeListener("beforepaste",i);l.pasteFilter&&a.addListener("beforepaste",i);i.call(a)}}}};UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var e=this,t=domUtils.findParentByTagName(e.iframe,"form",!1);if(t){if(e.fireEvent("beforesubmit")===!1)return;e.sync();t.submit()}}}}}});UE.plugin.register("background",function(){function e(e){var t={},i=e.split(";");utils.each(i,function(e){var i=e.indexOf(":"),n=utils.trim(e.substr(0,i)).toLowerCase();n&&(t[n]=utils.trim(e.substr(i+1)||""))});return t}function t(e){var t,i;if(e){t=[];for(i in e)e.hasOwnProperty(i)&&t.push(i+":"+e[i]+"; ");utils.cssRule(o,t.length?"body{"+t.join("")+"}":"",n.document)}else utils.cssRule(o,"",n.document)}var i,n=this,o="editor_background",r=new RegExp("body[\\s]*\\{(.+)\\}","i"),s=n.hasContents;n.hasContents=function(){return!!n.queryCommandValue("background")||s.apply(n,arguments);
};return{bindEvents:{getAllHtml:function(e,t){var i,o,r,s=this.body,a=domUtils.getComputedStyle(s,"background-image"),l="";l=a.indexOf(n.options.imagePath)>0?a.substring(a.indexOf(n.options.imagePath),a.length-1).replace(/"|\(|\)/gi,""):"none"!=a?a.replace(/url\("?|"?\)/gi,""):"";i='<style type="text/css">body{';o={"background-color":domUtils.getComputedStyle(s,"background-color")||"#ffffff","background-image":l?"url("+l+")":"","background-repeat":domUtils.getComputedStyle(s,"background-repeat")||"","background-position":browser.ie?domUtils.getComputedStyle(s,"background-position-x")+" "+domUtils.getComputedStyle(s,"background-position-y"):domUtils.getComputedStyle(s,"background-position"),height:domUtils.getComputedStyle(s,"height")};for(r in o)o.hasOwnProperty(r)&&(i+=r+":"+o[r]+"; ");i+="}</style> ";t.push(i)},aftersetcontent:function(){0==i&&t()}},inputRule:function(n){i=!1;utils.each(n.getNodesByTagName("p"),function(n){var o=n.getAttr("data-background");if(o){i=!0;t(e(o));n.parentNode.removeChild(n)}})},outputRule:function(e){var t=this,i=(utils.cssRule(o,t.document)||"").replace(/[\n\r]+/g,"").match(r);i&&e.appendChild(UE.uNode.createElement('<p style="display:none;" data-background="'+utils.trim(i[1].replace(/"/g,"").replace(/[\s]+/g," "))+'"><br/></p>'))},commands:{background:{execCommand:function(e,i){t(i)},queryCommandValue:function(){var t=this,i=(utils.cssRule(o,t.document)||"").replace(/[\n\r]+/g,"").match(r);return i?e(i[1]):null},notNeedUndo:!0}}}});UE.commands["imagefloat"]={execCommand:function(e,t){var i,n,o,r,s,a=this,l=a.selection.getRange();if(!l.collapsed){i=l.getClosedNode();if(i&&"IMG"==i.tagName)switch(t){case"left":case"right":case"none":n=i.parentNode;for(;dtd.$inline[n.tagName]||"A"==n.tagName;)n=n.parentNode;o=n;if("P"==o.tagName&&"center"==domUtils.getStyle(o,"text-align")){if(!domUtils.isBody(o)&&1==domUtils.getChildCount(o,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})){r=o.previousSibling;s=o.nextSibling;if(r&&s&&1==r.nodeType&&1==s.nodeType&&r.tagName==s.tagName&&domUtils.isBlockElm(r)){r.appendChild(o.firstChild);for(;s.firstChild;)r.appendChild(s.firstChild);domUtils.remove(o);domUtils.remove(s)}else domUtils.setStyle(o,"text-align","")}l.selectNode(i).select()}domUtils.setStyle(i,"float","none"==t?"":t);"none"==t&&domUtils.removeAttributes(i,"align");break;case"center":if("center"!=a.queryCommandValue("imagefloat")){n=i.parentNode;domUtils.setStyle(i,"float","");domUtils.removeAttributes(i,"align");o=i;for(;n&&1==domUtils.getChildCount(n,function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)})&&(dtd.$inline[n.tagName]||"A"==n.tagName);){o=n;n=n.parentNode}l.setStartBefore(o).setCursor(!1);n=a.document.createElement("div");n.appendChild(o);domUtils.setStyle(o,"float","");a.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+n.innerHTML+"</p>");o=a.document.getElementById("_img_parent_tmp");o.removeAttribute("id");o=o.firstChild;l.selectNode(o).select();s=o.parentNode.nextSibling;s&&domUtils.isEmptyNode(s)&&domUtils.remove(s)}}}},queryCommandValue:function(){var e,t,i=this.selection.getRange();if(i.collapsed)return"none";e=i.getClosedNode();if(e&&1==e.nodeType&&"IMG"==e.tagName){t=domUtils.getComputedStyle(e,"float")||e.getAttribute("align");"none"==t&&(t="center"==domUtils.getComputedStyle(e.parentNode,"text-align")?"center":t);return{left:1,right:1,center:1}[t]?t:"none"}return"none"},queryCommandState:function(){var e,t=this.selection.getRange();if(t.collapsed)return-1;e=t.getClosedNode();return e&&1==e.nodeType&&"IMG"==e.tagName?0:-1}};UE.commands["insertimage"]={execCommand:function(e,t){function i(e){utils.each("width,height,border,hspace,vspace".split(","),function(t){e[t]&&(e[t]=parseInt(e[t],10)||0)});utils.each("src,_src".split(","),function(t){e[t]&&(e[t]=utils.unhtmlForUrl(e[t]))});utils.each("title,alt".split(","),function(t){e[t]&&(e[t]=utils.unhtml(e[t]))})}var n,o,r,s,a,l,d,c,u;t=utils.isArray(t)?t:[t];if(t.length){n=this,o=n.selection.getRange(),r=o.getClosedNode();if(n.fireEvent("beforeinsertimage",t)!==!0){if(!r||!/img/i.test(r.tagName)||"edui-faked-video"==r.className&&r.className.indexOf("edui-upload-video")==-1||r.getAttribute("word_img")){l=[],d="";c=t[0];if(1==t.length){i(c);d='<img src="'+c.src+'" '+(c._src?' _src="'+c._src+'" ':"")+(c.width?'width="'+c.width+'" ':"")+(c.height?' height="'+c.height+'" ':"")+("left"==c["floatStyle"]||"right"==c["floatStyle"]?' style="float:'+c["floatStyle"]+';"':"")+(c.title&&""!=c.title?' title="'+c.title+'"':"")+(c.border&&"0"!=c.border?' border="'+c.border+'"':"")+(c.alt&&""!=c.alt?' alt="'+c.alt+'"':"")+(c.hspace&&"0"!=c.hspace?' hspace = "'+c.hspace+'"':"")+(c.vspace&&"0"!=c.vspace?' vspace = "'+c.vspace+'"':"")+"/>";"center"==c["floatStyle"]&&(d='<p style="text-align: center">'+d+"</p>");l.push(d)}else for(u=0;c=t[u++];){i(c);d='<img src="'+c.src+'" '+(c.width?'width="'+c.width+'" ':"")+(c._src?' _src="'+c._src+'" ':"")+(c.height?' height="'+c.height+'" ':"")+' style="'+(c["floatStyle"]&&"center"!=c["floatStyle"]?"float:"+c["floatStyle"]+";":"")+(c.border||"")+'" '+(c.title?' title="'+c.title+'"':"")+" /></p>";l.push(d)}n.execCommand("insertHtml",l.join(""))}else{s=t.shift();a=s["floatStyle"];delete s["floatStyle"];domUtils.setAttributes(r,s);n.execCommand("imagefloat",a);if(t.length>0){o.setStartAfter(r).setCursor(!1,!0);n.execCommand("insertimage",t)}}n.fireEvent("afterinsertimage",t)}}}};UE.plugins["justify"]=function(){var e=domUtils.isBlockElm,t={left:1,right:1,center:1,justify:1},i=function(t,i){var n,o,r,s,a,l,d,c=t.createBookmark(),u=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};t.enlarge(!0);n=t.createBookmark(),o=domUtils.getNextDomNode(n.start,!1,u),r=t.cloneRange();for(;o&&!(domUtils.getPosition(o,n.end)&domUtils.POSITION_FOLLOWING);)if(3!=o.nodeType&&e(o))o=domUtils.getNextDomNode(o,!0,u);else{r.setStartBefore(o);for(;o&&o!==n.end&&!e(o);){s=o;o=domUtils.getNextDomNode(o,!1,null,function(t){return!e(t)})}r.setEndAfter(s);a=r.getCommonAncestor();if(!domUtils.isBody(a)&&e(a)){domUtils.setStyles(a,utils.isString(i)?{"text-align":i}:i);o=a}else{l=t.document.createElement("p");domUtils.setStyles(l,utils.isString(i)?{"text-align":i}:i);d=r.extractContents();l.appendChild(d);r.insertNode(l);o=l}o=domUtils.getNextDomNode(o,!1,u)}return t.moveToBookmark(n).moveToBookmark(c)};UE.commands["justify"]={execCommand:function(e,t){var n,o=this.selection.getRange();if(o.collapsed){n=this.document.createTextNode("p");o.insertNode(n)}i(o,t);if(n){o.setStartBefore(n).collapse(!0);domUtils.remove(n)}o.select();return!0},queryCommandValue:function(){var e=this.selection.getStart(),i=domUtils.getComputedStyle(e,"text-align");return t[i]?i:"left"},queryCommandState:function(){var e=this.selection.getStart(),t=e&&domUtils.findParentByTagName(e,["td","th","caption"],!0);return t?-1:0}}};UE.plugins["font"]=function(){function e(e){for(var t;(t=e.parentNode)&&"SPAN"==t.tagName&&1==domUtils.getChildCount(t,function(e){return!domUtils.isBookmarkNode(e)&&!domUtils.isBr(e)});){t.style.cssText+=e.style.cssText;domUtils.remove(e,!0);e=t}}function t(e,t,i){var n,o;if(a[t]){e.adjustmentBoundary();if(!e.collapsed&&1==e.startContainer.nodeType){n=e.startContainer.childNodes[e.startOffset];if(n&&domUtils.isTagNode(n,"span")){o=e.createBookmark();utils.each(domUtils.getElementsByTagName(n,"span"),function(e){if(e.parentNode&&!domUtils.isBookmarkNode(e)&&("backcolor"!=t||domUtils.getComputedStyle(e,"background-color").toLowerCase()!==i)){domUtils.removeStyle(e,a[t]);0==e.style.cssText.replace(/^\s+$/,"").length&&domUtils.remove(e,!0)}});e.moveToBookmark(o)}}}}function i(i,n,o){var r,s=i.collapsed,a=i.createBookmark();if(s){r=a.start.parentNode;for(;dtd.$inline[r.tagName];)r=r.parentNode}else r=domUtils.getCommonAncestor(a.start,a.end);utils.each(domUtils.getElementsByTagName(r,"span"),function(t){var i,r;if(t.parentNode&&!domUtils.isBookmarkNode(t))if(/\s*border\s*:\s*none;?\s*/i.test(t.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(t.style.cssText)?domUtils.remove(t,!0):domUtils.removeStyle(t,"border");else{/border/i.test(t.style.cssText)&&"SPAN"==t.parentNode.tagName&&/border/i.test(t.parentNode.style.cssText)&&(t.style.cssText=t.style.cssText.replace(/border[^:]*:[^;]+;?/gi,""));if("fontborder"!=n||"none"!=o){i=t.nextSibling;for(;i&&1==i.nodeType&&"SPAN"==i.tagName;)if(domUtils.isBookmarkNode(i)&&"fontborder"==n){t.appendChild(i);i=t.nextSibling}else{if(i.style.cssText==t.style.cssText){domUtils.moveChild(i,t);domUtils.remove(i)}if(t.nextSibling===i)break;i=t.nextSibling}}e(t);if(browser.ie&&browser.version>8){r=domUtils.findParent(t,function(e){return"SPAN"==e.tagName&&/background-color/.test(e.style.cssText)});r&&!/background-color/.test(t.style.cssText)&&(t.style.backgroundColor=r.style.backgroundColor)}}});i.moveToBookmark(a);t(i,n,o)}var n,o=this,r={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},s={underline:1,strikethrough:1,fontborder:1},a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};o.setOpt({fontfamily:[{name:"songti",val:"宋体,SimSun"},{name:"yahei",val:"微软雅黑,Microsoft YaHei"},{name:"kaiti",val:"楷体,楷体_GB2312, SimKai"},{name:"heiti",val:"黑体, SimHei"},{name:"lishu",val:"隶书, SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});o.addInputRule(function(e){utils.each(e.getNodesByTagName("u s del font strike"),function(e){var t,i,n;if("font"==e.tagName){t=[];for(i in e.attrs)switch(i){case"size":t.push("font-size:"+({1:"10",2:"12",3:"16",4:"18",5:"24",6:"32",7:"48"}[e.attrs[i]]||e.attrs[i])+"px");break;case"color":t.push("color:"+e.attrs[i]);break;case"face":t.push("font-family:"+e.attrs[i]);break;case"style":t.push(e.attrs[i])}e.attrs={style:t.join(";")}}else{n="u"==e.tagName?"underline":"line-through";e.attrs={style:(e.getAttr("style")||"")+"text-decoration:"+n+";"}}e.tagName="span"})});for(n in r)!function(e,t){UE.commands[e]={execCommand:function(n,o){var r,a,l,d,c;o=o||(this.queryCommandState(n)?"none":"underline"==n?"underline":"fontborder"==n?"1px solid #000":"line-through");r=this,a=this.selection.getRange();if("default"==o){if(a.collapsed){l=r.document.createTextNode("font");a.insertNode(l).select()}r.execCommand("removeFormat","span,a",t);if(l){a.setStartBefore(l).collapse(!0);domUtils.remove(l)}i(a,n,o);a.select()}else if(a.collapsed){d=domUtils.findParentByTagName(a.startContainer,"span",!0);l=r.document.createTextNode("font");if(!d||d.children.length||d[browser.ie?"innerText":"textContent"].replace(fillCharReg,"").length){a.insertNode(l);a.selectNode(l).select();d=a.document.createElement("span");if(s[e]){if(domUtils.findParentByTagName(l,"a",!0)){a.setStartBefore(l).setCursor();domUtils.remove(l);return}r.execCommand("removeFormat","span,a",t)}d.style.cssText=t+":"+o;l.parentNode.insertBefore(d,l);if(!browser.ie||browser.ie&&9==browser.version){c=d.parentNode;for(;!domUtils.isBlockElm(c);){"SPAN"==c.tagName&&(d.style.cssText=c.style.cssText+";"+d.style.cssText);c=c.parentNode}}if(opera)setTimeout(function(){a.setStart(d,0).collapse(!0);i(a,n,o);a.select()});else{a.setStart(d,0).collapse(!0);i(a,n,o);a.select()}}else{a.insertNode(l);if(s[e]){a.selectNode(l).select();r.execCommand("removeFormat","span,a",t,null);d=domUtils.findParentByTagName(l,"span",!0);a.setStartBefore(l)}d&&(d.style.cssText+=";"+t+":"+o);a.collapse(!0).select()}domUtils.remove(l)}else{s[e]&&r.queryCommandValue(e)&&r.execCommand("removeFormat","span,a",t);a=r.selection.getRange();a.applyInlineStyle("span",{style:t+":"+o});i(a,n,o);a.select()}return!0},queryCommandValue:function(e){var i,n,o,r,s,a=this.selection.getStart();if("underline"==e||"strikethrough"==e){i=a;for(;i&&!domUtils.isBlockElm(i)&&!domUtils.isBody(i);){if(1==i.nodeType){n=domUtils.getComputedStyle(i,t);if("none"!=n)return n}i=i.parentNode}return"none"}if("fontborder"==e){o=a;for(;o&&dtd.$inline[o.tagName];){if((r=domUtils.getComputedStyle(o,"border"))&&/1px/.test(r)&&/solid/.test(r))return r;o=o.parentNode}return""}if("FontSize"==e){s=domUtils.getComputedStyle(a,t),o=/^([\d\.]+)(\w+)$/.exec(s);return o?Math.floor(o[1])+o[2]:s}return domUtils.getComputedStyle(a,t)},queryCommandState:function(e){if(!s[e])return 0;var t=this.queryCommandValue(e);return"fontborder"==e?/1px/.test(t)&&/solid/.test(t):"underline"==e?/underline/.test(t):/line\-through/.test(t)}}}(n,r[n])};UE.plugins["link"]=function(){function e(e){var t=e.startContainer,i=e.endContainer;(t=domUtils.findParentByTagName(t,"a",!0))&&e.setStartBefore(t);(i=domUtils.findParentByTagName(i,"a",!0))&&e.setEndAfter(i)}function t(t,i,n){var o,r,s,a=t.cloneRange(),l=n.queryCommandValue("link");e(t=t.adjustmentBoundary());o=t.startContainer;if(1==o.nodeType&&l){o=o.childNodes[t.startOffset];o&&1==o.nodeType&&"A"==o.tagName&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(o[browser.ie?"innerText":"textContent"])&&(o[browser.ie?"innerText":"textContent"]=utils.html(i.textValue||i.href))}if(!a.collapsed||l){t.removeInlineStyle("a");a=t.cloneRange()}if(a.collapsed){r=t.document.createElement("a"),s="";if(i.textValue){s=utils.html(i.textValue);delete i.textValue}else s=utils.html(i.href);domUtils.setAttributes(r,i);o=domUtils.findParentByTagName(a.startContainer,"a",!0);o&&domUtils.isInNodeEndBoundary(a,o)&&t.setStartAfter(o).collapse(!0);r[browser.ie?"innerText":"textContent"]=s;t.insertNode(r).selectNode(r)}else t.applyInlineStyle("a",i)}UE.commands["unlink"]={execCommand:function(){var t,i=this.selection.getRange();if(!i.collapsed||domUtils.findParentByTagName(i.startContainer,"a",!0)){t=i.createBookmark();e(i);i.removeInlineStyle("a").moveToBookmark(t).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands["link"]={execCommand:function(e,i){var n;i._href&&(i._href=utils.unhtml(i._href,/[<">]/g));i.href&&(i.href=utils.unhtml(i.href,/[<">]/g));i.textValue&&(i.textValue=utils.unhtml(i.textValue,/[<">]/g));t(n=this.selection.getRange(),i,this);n.collapse().select(!0)},queryCommandValue:function(){var e,t,i,n,o,r,s,a,l,d=this.selection.getRange();if(!d.collapsed){d.shrinkBoundary();t=3!=d.startContainer.nodeType&&d.startContainer.childNodes[d.startOffset]?d.startContainer.childNodes[d.startOffset]:d.startContainer,i=3==d.endContainer.nodeType||0==d.endOffset?d.endContainer:d.endContainer.childNodes[d.endOffset-1],n=d.getCommonAncestor();e=domUtils.findParentByTagName(n,"a",!0);if(!e&&1==n.nodeType){o=n.getElementsByTagName("a");for(a=0;l=o[a++];){r=domUtils.getPosition(l,t),s=domUtils.getPosition(l,i);if((r&domUtils.POSITION_FOLLOWING||r&domUtils.POSITION_CONTAINS)&&(s&domUtils.POSITION_PRECEDING||s&domUtils.POSITION_CONTAINS)){e=l;break}}}return e}e=d.startContainer;e=1==e.nodeType?e:e.parentNode;if(e&&(e=domUtils.findParentByTagName(e,"a",!0))&&!domUtils.isInNodeEndBoundary(d,e))return e},queryCommandState:function(){var e=this.selection.getRange().getClosedNode(),t=e&&("edui-faked-video"==e.className||e.className.indexOf("edui-upload-video")!=-1);return t?-1:0}}};UE.plugins["insertframe"]=function(){function e(){t._iframe&&delete t._iframe}var t=this;t.addListener("selectionchange",function(){e()})};UE.commands["scrawl"]={queryCommandState:function(){return browser.ie&&browser.version<=8?-1:0}};UE.plugins["removeformat"]=function(){var e=this;e.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});e.commands["removeformat"]={execCommand:function(e,t,i,n,o){function r(e){var t,i,n;if(3==e.nodeType||"span"!=e.tagName.toLowerCase())return 0;if(browser.ie){t=e.attributes;if(t.length){for(i=0,n=t.length;i<n;i++)if(t[i].specified)return 0;return 1}}return!e.attributes.length}function s(e){var t,n,s,u,f,h,p,g=e.createBookmark();e.collapsed&&e.enlarge(!0);if(!o){t=domUtils.findParentByTagName(e.startContainer,"a",!0);t&&e.setStartBefore(t);t=domUtils.findParentByTagName(e.endContainer,"a",!0);t&&e.setEndAfter(t)}a=e.createBookmark();f=a.start;for(;(l=f.parentNode)&&!domUtils.isBlockElm(l);){domUtils.breakParent(f,l);domUtils.clearEmptySibling(f)}if(a.end){f=a.end;for(;(l=f.parentNode)&&!domUtils.isBlockElm(l);){domUtils.breakParent(f,l);domUtils.clearEmptySibling(f)}n=domUtils.getNextDomNode(a.start,!1,m);for(;n&&n!=a.end;){s=domUtils.getNextDomNode(n,!0,m);if(!dtd.$empty[n.tagName.toLowerCase()]&&!domUtils.isBookmarkNode(n))if(d.test(n.tagName))if(i){domUtils.removeStyle(n,i);r(n)&&"text-decoration"!=i&&domUtils.remove(n,!0)}else domUtils.remove(n,!0);else if(!dtd.$tableContent[n.tagName]&&!dtd.$list[n.tagName]){domUtils.removeAttributes(n,c);r(n)&&domUtils.remove(n,!0)}n=s}}u=a.start.parentNode;!domUtils.isBlockElm(u)||dtd.$tableContent[u.tagName]||dtd.$list[u.tagName]||domUtils.removeAttributes(u,c);u=a.end.parentNode;a.end&&domUtils.isBlockElm(u)&&!dtd.$tableContent[u.tagName]&&!dtd.$list[u.tagName]&&domUtils.removeAttributes(u,c);e.moveToBookmark(a).moveToBookmark(g);f=e.startContainer,p=e.collapsed;for(;1==f.nodeType&&domUtils.isEmptyNode(f)&&dtd.$removeEmpty[f.tagName];){h=f.parentNode;e.setStartBefore(f);e.startContainer===e.endContainer&&e.endOffset--;domUtils.remove(f);f=h}if(!p){f=e.endContainer;for(;1==f.nodeType&&domUtils.isEmptyNode(f)&&dtd.$removeEmpty[f.tagName];){h=f.parentNode;e.setEndBefore(f);domUtils.remove(f);f=h}}}var a,l,d=new RegExp("^(?:"+(t||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),c=i?[]:(n||this.options.removeFormatAttributes).split(","),u=new dom.Range(this.document),m=function(e){return 1==e.nodeType};u=this.selection.getRange();s(u);u.select()}}};UE.plugins["blockquote"]=function(){function e(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),"blockquote")}var t=this;t.commands["blockquote"]={execCommand:function(t,i){var n,o,r,s,a,l,d,c,u,m,f,h,p,g=this.selection.getRange(),b=e(this),y=dtd.blockquote,v=g.createBookmark();if(b){n=g.startContainer,o=domUtils.isBlockElm(n)?n:domUtils.findParent(n,function(e){return domUtils.isBlockElm(e)}),r=g.endContainer,s=domUtils.isBlockElm(r)?r:domUtils.findParent(r,function(e){return domUtils.isBlockElm(e)});o=domUtils.findParentByTagName(o,"li",!0)||o;s=domUtils.findParentByTagName(s,"li",!0)||s;"LI"==o.tagName||"TD"==o.tagName||o===b||domUtils.isBody(o)?domUtils.remove(b,!0):domUtils.breakParent(o,b);if(o!==s){b=domUtils.findParentByTagName(s,"blockquote");b&&("LI"==s.tagName||"TD"==s.tagName||domUtils.isBody(s)?b.parentNode&&domUtils.remove(b,!0):domUtils.breakParent(s,b))}a=domUtils.getElementsByTagName(this.document,"blockquote");for(l=0;d=a[l++];)d.childNodes.length?domUtils.getPosition(d,o)&domUtils.POSITION_FOLLOWING&&domUtils.getPosition(d,s)&domUtils.POSITION_PRECEDING&&domUtils.remove(d,!0):domUtils.remove(d)}else{c=g.cloneRange(),u=1==c.startContainer.nodeType?c.startContainer:c.startContainer.parentNode,m=u,f=1;for(;;){if(domUtils.isBody(u)){if(m!==u)if(g.collapsed){c.selectNode(m);f=0}else c.setStartBefore(m);else c.setStart(u,0);break}if(!y[u.tagName]){g.collapsed?c.selectNode(m):c.setStartBefore(m);break}m=u;u=u.parentNode}if(f){m=u=u=1==c.endContainer.nodeType?c.endContainer:c.endContainer.parentNode;for(;;){if(domUtils.isBody(u)){m!==u?c.setEndAfter(m):c.setEnd(u,u.childNodes.length);break}if(!y[u.tagName]){c.setEndAfter(m);break}m=u;u=u.parentNode}}u=g.document.createElement("blockquote");domUtils.setAttributes(u,i);u.appendChild(c.extractContents());c.insertNode(u);h=domUtils.getElementsByTagName(u,"blockquote");for(l=0;p=h[l++];)p.parentNode&&domUtils.remove(p,!0)}g.moveToBookmark(v).select()},queryCommandState:function(){return e(this)?1:0}}};UE.commands["touppercase"]=UE.commands["tolowercase"]={execCommand:function(e){var t,i,n,o,r=this,s=r.selection.getRange();if(s.collapsed)return s;t=s.createBookmark(),i=t.end,n=function(e){return!domUtils.isBr(e)&&!domUtils.isWhitespace(e)},o=domUtils.getNextDomNode(t.start,!1,n);for(;o&&domUtils.getPosition(o,i)&domUtils.POSITION_PRECEDING;){3==o.nodeType&&(o.nodeValue=o.nodeValue["touppercase"==e?"toUpperCase":"toLowerCase"]());o=domUtils.getNextDomNode(o,!0,n);if(o===i)break}s.moveToBookmark(t).select()}};UE.commands["indent"]={execCommand:function(){var e=this,t=e.queryCommandState("indent")?"0em":e.options.indentValue||"2em";e.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e&&e.style.textIndent&&parseInt(e.style.textIndent)?1:0}};UE.commands["print"]={execCommand:function(){this.window.print()},notNeedUndo:1};UE.commands["preview"]={execCommand:function(){var e=window.open("","_blank",""),t=e.document;t.open();t.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"></script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)</script></head><body><div>"+this.getContent(null,null,!0)+"</div></body></html>");t.close()},notNeedUndo:1};UE.plugins["selectall"]=function(){var e=this;e.commands["selectall"]={execCommand:function(){var e=this,t=e.body,i=e.selection.getRange();i.selectNodeContents(t);if(domUtils.isEmptyBlock(t)){browser.opera&&t.firstChild&&1==t.firstChild.nodeType&&i.setStartAtFirst(t.firstChild);i.collapse(!0)}i.select(!0)},notNeedUndo:1};e.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins["paragraph"]=function(){var e=this,t=domUtils.isBlockElm,i=["TD","LI","PRE"],n=function(e,n,o,r){var s,a,l,d,c,u,m=e.createBookmark(),f=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase()&&!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)};e.enlarge(!0);a=e.createBookmark(),l=domUtils.getNextDomNode(a.start,!1,f),d=e.cloneRange();for(;l&&!(domUtils.getPosition(l,a.end)&domUtils.POSITION_FOLLOWING);)if(3!=l.nodeType&&t(l))l=domUtils.getNextDomNode(l,!0,f);else{d.setStartBefore(l);for(;l&&l!==a.end&&!t(l);){c=l;l=domUtils.getNextDomNode(l,!1,null,function(e){return!t(e)})}d.setEndAfter(c);s=e.document.createElement(n);if(o){domUtils.setAttributes(s,o);r&&"customstyle"==r&&o.style&&(s.style.cssText=o.style)}s.appendChild(d.extractContents());domUtils.isEmptyNode(s)&&domUtils.fillChar(e.document,s);d.insertNode(s);u=s.parentNode;if(t(u)&&!domUtils.isBody(s.parentNode)&&utils.indexOf(i,u.tagName)==-1){if(!r||"customstyle"!=r){u.getAttribute("dir")&&s.setAttribute("dir",u.getAttribute("dir"));u.style.cssText&&(s.style.cssText=u.style.cssText+";"+s.style.cssText);u.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=u.style.textAlign);u.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=u.style.textIndent);u.style.padding&&!s.style.padding&&(s.style.padding=u.style.padding)}if(o&&/h\d/i.test(u.tagName)&&!/h\d/i.test(s.tagName)){domUtils.setAttributes(u,o);r&&"customstyle"==r&&o.style&&(u.style.cssText=o.style);domUtils.remove(s,!0);s=u}else domUtils.remove(s.parentNode,!0)}l=utils.indexOf(i,u.tagName)!=-1?u:s;l=domUtils.getNextDomNode(l,!1,f)}return e.moveToBookmark(a).moveToBookmark(m)};e.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});e.commands["paragraph"]={execCommand:function(e,t,i,o){var r,s,a,l=this.selection.getRange();if(l.collapsed){r=this.document.createTextNode("p");l.insertNode(r);if(browser.ie){s=r.previousSibling;s&&domUtils.isWhitespace(s)&&domUtils.remove(s);s=r.nextSibling;s&&domUtils.isWhitespace(s)&&domUtils.remove(s)}}l=n(l,t,i,o);if(r){l.setStartBefore(r).collapse(!0);pN=r.parentNode;domUtils.remove(r);domUtils.isBlockElm(pN)&&domUtils.isEmptyNode(pN)&&domUtils.fillNode(this.document,pN)}if(browser.gecko&&l.collapsed&&1==l.startContainer.nodeType){a=l.startContainer.childNodes[l.startOffset];a&&1==a.nodeType&&a.tagName.toLowerCase()==t&&l.setStart(a,0).collapse(!0)}l.select();return!0},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return e?e.tagName.toLowerCase():""}}};!function(){var e=domUtils.isBlockElm,t=function(e){return domUtils.filterNodeList(e.selection.getStartElementPath(),function(e){return e&&1==e.nodeType&&e.getAttribute("dir")})},i=function(i,n,o){var r,s,a,l,d,c,u,m,f=function(e){return 1==e.nodeType?!domUtils.isBookmarkNode(e):!domUtils.isWhitespace(e)},h=t(n);if(h&&i.collapsed){h.setAttribute("dir",o);return i}r=i.createBookmark();i.enlarge(!0);s=i.createBookmark(),a=domUtils.getNextDomNode(s.start,!1,f),l=i.cloneRange();for(;a&&!(domUtils.getPosition(a,s.end)&domUtils.POSITION_FOLLOWING);)if(3!=a.nodeType&&e(a))a=domUtils.getNextDomNode(a,!0,f);else{l.setStartBefore(a);for(;a&&a!==s.end&&!e(a);){d=a;a=domUtils.getNextDomNode(a,!1,null,function(t){return!e(t)})}l.setEndAfter(d);c=l.getCommonAncestor();if(!domUtils.isBody(c)&&e(c)){c.setAttribute("dir",o);a=c}else{u=i.document.createElement("p");u.setAttribute("dir",o);m=l.extractContents();u.appendChild(m);l.insertNode(u);a=u}a=domUtils.getNextDomNode(a,!1,f)}return i.moveToBookmark(s).moveToBookmark(r)};UE.commands["directionality"]={execCommand:function(e,t){var n,o=this.selection.getRange();if(o.collapsed){n=this.document.createTextNode("d");o.insertNode(n)}i(o,this,t);if(n){o.setStartBefore(n).collapse(!0);domUtils.remove(n)}o.select();return!0},queryCommandValue:function(){var e=t(this);return e?e.getAttribute("dir"):"ltr"}}}();UE.plugins["horizontal"]=function(){var e=this;e.commands["horizontal"]={execCommand:function(e){var t,i,n,o=this;if(o.queryCommandState(e)!==-1){o.execCommand("insertHtml","<hr>");t=o.selection.getRange(),i=t.startContainer;if(1==i.nodeType&&!i.childNodes[t.startOffset]&&(n=i.childNodes[t.startOffset-1])&&1==n.nodeType&&"HR"==n.tagName)if("p"==o.options.enterTag){n=o.document.createElement("p");t.insertNode(n);t.setStart(n,0).setCursor()}else{n=o.document.createElement("br");t.insertNode(n);t.setStartBefore(n).setCursor()}return!0}},queryCommandState:function(){return domUtils.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0}};e.addListener("delkeydown",function(e,t){var i,n,o=this.selection.getRange();o.txtToElmBoundary(!0);if(domUtils.isStartInblock(o)){i=o.startContainer;n=i.previousSibling;if(n&&domUtils.isTagNode(n,"hr")){domUtils.remove(n);o.select();domUtils.preventDefault(t);return!0}}})};UE.commands["time"]=UE.commands["date"]={execCommand:function(e,t){function i(e,t){var i=("0"+e.getHours()).slice(-2),n=("0"+e.getMinutes()).slice(-2),o=("0"+e.getSeconds()).slice(-2);t=t||"hh:ii:ss";return t.replace(/hh/gi,i).replace(/ii/gi,n).replace(/ss/gi,o)}function n(e,t){var i=("000"+e.getFullYear()).slice(-4),n=i.slice(-2),o=("0"+(e.getMonth()+1)).slice(-2),r=("0"+e.getDate()).slice(-2);t=t||"yyyy-mm-dd";return t.replace(/yyyy/gi,i).replace(/yy/gi,n).replace(/mm/gi,o).replace(/dd/gi,r)}var o=new Date;this.execCommand("insertHtml","time"==e?i(o,t):n(o,t))}};UE.plugins["rowspacing"]=function(){var e=this;e.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});e.commands["rowspacing"]={execCommand:function(e,t,i){this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"});return!0},queryCommandValue:function(e,t){var i,n=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return domUtils.isBlockElm(e)});if(n){i=domUtils.getComputedStyle(n,"margin-"+t).replace(/[^\d]/g,"");return i?i:0}return 0}}};UE.plugins["lineheight"]=function(){var e=this;e.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});e.commands["lineheight"]={execCommand:function(e,t){this.execCommand("paragraph","p",{style:"line-height:"+("1"==t?"normal":t+"em")});return!0},queryCommandValue:function(){var e,t=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return domUtils.isBlockElm(e)});if(t){e=domUtils.getComputedStyle(t,"line-height");return"normal"==e?1:e.replace(/[^\d.]*/gi,"")}}}};UE.plugins["insertcode"]=function(){var e,t=this;t.ready(function(){utils.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",t.document)});t.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"});t.commands["insertcode"]={execCommand:function(e,t){var i,n,o,r,s=this,a=s.selection.getRange(),l=domUtils.findParentByTagName(a.startContainer,"pre",!0);if(l)l.className="brush:"+t+";toolbar:false;";else{i="";if(a.collapsed)i=browser.ie&&browser.ie11below?browser.version<=8?"&nbsp;":"":"<br/>";else{n=a.extractContents();o=s.document.createElement("div");o.appendChild(n);utils.each(UE.filterNode(UE.htmlparser(o.innerHTML.replace(/[\r\t]/g,"")),s.options.filterTxtRules).children,function(e){if(browser.ie&&browser.ie11below&&browser.version>8){if("element"==e.type){if("br"==e.tagName)i+="\n";else if(!dtd.$empty[e.tagName]){utils.each(e.children,function(t){"element"==t.type?"br"==t.tagName?i+="\n":dtd.$empty[e.tagName]||(i+=t.innerText()):i+=t.data});/\n$/.test(i)||(i+="\n")}}else i+=e.data+"\n";!e.nextSibling()&&/\n$/.test(i)&&(i=i.replace(/\n$/,""))}else if(browser.ie&&browser.ie11below){if("element"==e.type){if("br"==e.tagName)i+="<br>";else if(!dtd.$empty[e.tagName]){utils.each(e.children,function(t){"element"==t.type?"br"==t.tagName?i+="<br>":dtd.$empty[e.tagName]||(i+=t.innerText()):i+=t.data});/br>$/.test(i)||(i+="<br>")}}else i+=e.data+"<br>";!e.nextSibling()&&/<br>$/.test(i)&&(i=i.replace(/<br>$/,""))}else{i+="element"==e.type?dtd.$empty[e.tagName]?"":e.innerText():e.data;if(!/br\/?\s*>$/.test(i)){if(!e.nextSibling())return;i+="<br>"}}})}s.execCommand("inserthtml",'<pre id="coder"class="brush:'+t+';toolbar:false">'+i+"</pre>",!0);l=s.document.getElementById("coder");domUtils.removeAttributes(l,"id");r=l.previousSibling;r&&(3==r.nodeType&&1==r.nodeValue.length&&browser.ie&&6==browser.version||domUtils.isEmptyBlock(r))&&domUtils.remove(r);a=s.selection.getRange();domUtils.isEmptyBlock(l)?a.setStart(l,0).setCursor(!1,!0):a.selectNodeContents(l).select()}},queryCommandValue:function(){var e=this.selection.getStartElementPath(),t="";utils.each(e,function(e){if("PRE"==e.nodeName){var i=e.className.match(/brush:([^;]+)/);t=i&&i[1]?i[1]:"";return!1}});return t}};t.addInputRule(function(e){utils.each(e.getNodesByTagName("pre"),function(e){var t,i=e.getNodesByTagName("br");if(i.length)browser.ie&&browser.ie11below&&browser.version>8&&utils.each(i,function(e){var t=UE.uNode.createText("\n");e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)});else if(!(browser.ie&&browser.ie11below&&browser.version>8)){t=e.innerText().split(/\n/);e.innerHTML("");utils.each(t,function(t){t.length&&e.appendChild(UE.uNode.createText(t));e.appendChild(UE.uNode.createElement("br"))})}})});t.addOutputRule(function(e){utils.each(e.getNodesByTagName("pre"),function(e){var t="";utils.each(e.children,function(e){t+="text"==e.type?e.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):"br"==e.tagName?"\n":dtd.$empty[e.tagName]?e.innerText():""});e.innerText(t.replace(/(&nbsp;|\n)+$/,""))})});t.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};e=t.queryCommandState;t.queryCommandState=function(e){var t=this;return!t.notNeedCodeQuery[e.toLowerCase()]&&t.selection&&t.queryCommandValue("insertcode")?-1:UE.Editor.prototype.queryCommandState.apply(this,arguments)};t.addListener("beforeenterkeydown",function(){
var e,i,n,o,r,s,a,l,d,c=t.selection.getRange(),u=domUtils.findParentByTagName(c.startContainer,"pre",!0);if(u){t.fireEvent("saveScene");c.collapsed||c.deleteContents();if(!browser.ie||browser.ie9above){e=t.document.createElement("br");c.insertNode(e).setStartAfter(e).collapse(!0);i=e.nextSibling;i||browser.ie&&!(browser.version>10)?c.setStartAfter(e):c.insertNode(e.cloneNode(!1));u=e.previousSibling;for(;u;){n=u;u=u.previousSibling;if(!u||"BR"==u.nodeName){u=n;break}}if(u){o="";for(;u&&"BR"!=u.nodeName&&new RegExp("^[\\s"+domUtils.fillChar+"]*$").test(u.nodeValue);){o+=u.nodeValue;u=u.nextSibling}if("BR"!=u.nodeName){r=u.nodeValue.match(new RegExp("^([\\s"+domUtils.fillChar+"]+)"));r&&r[1]&&(o+=r[1])}if(o){o=t.document.createTextNode(o);c.insertNode(o).setStartAfter(o)}}c.collapse(!0).select(!0)}else if(browser.version>8){s=t.document.createTextNode("\n");a=c.startContainer;if(0==c.startOffset){l=a.previousSibling;if(l){c.insertNode(s);d=t.document.createTextNode(" ");c.setStartAfter(s).insertNode(d).setStart(d,0).collapse(!0).select(!0)}}else{c.insertNode(s).setStartAfter(s);d=t.document.createTextNode(" ");a=c.startContainer.childNodes[c.startOffset];a&&!/^\n/.test(a.nodeValue)&&c.setStartBefore(s);c.insertNode(d).setStart(d,0).collapse(!0).select(!0)}}else{e=t.document.createElement("br");c.insertNode(e);c.insertNode(t.document.createTextNode(domUtils.fillChar));c.setStartAfter(e);u=e.previousSibling;for(;u;){n=u;u=u.previousSibling;if(!u||"BR"==u.nodeName){u=n;break}}if(u){o="";for(;u&&"BR"!=u.nodeName&&new RegExp("^[ "+domUtils.fillChar+"]*$").test(u.nodeValue);){o+=u.nodeValue;u=u.nextSibling}if("BR"!=u.nodeName){r=u.nodeValue.match(new RegExp("^([ "+domUtils.fillChar+"]+)"));r&&r[1]&&(o+=r[1])}o=t.document.createTextNode(o);c.insertNode(o).setStartAfter(o)}c.collapse(!0).select()}t.fireEvent("saveScene");return!0}});t.addListener("tabkeydown",function(e,i){var n,o,r,s,a=t.selection.getRange(),l=domUtils.findParentByTagName(a.startContainer,"pre",!0);if(l){t.fireEvent("saveScene");if(i.shiftKey);else if(a.collapsed){s=t.document.createTextNode("    ");a.insertNode(s).setStartAfter(s).collapse(!0).select(!0)}else{n=a.createBookmark();o=n.start.previousSibling;for(;o;){if(l.firstChild===o&&!domUtils.isBr(o)){l.insertBefore(t.document.createTextNode("    "),o);break}if(domUtils.isBr(o)){l.insertBefore(t.document.createTextNode("    "),o.nextSibling);break}o=o.previousSibling}r=n.end;o=n.start.nextSibling;l.firstChild===n.start&&l.insertBefore(t.document.createTextNode("    "),o.nextSibling);for(;o&&o!==r;){if(domUtils.isBr(o)&&o.nextSibling){if(o.nextSibling===r)break;l.insertBefore(t.document.createTextNode("    "),o.nextSibling)}o=o.nextSibling}a.moveToBookmark(n).select()}t.fireEvent("saveScene");return!0}});t.addListener("beforeinserthtml",function(e,t){var i,n,o,r=this,s=r.selection.getRange(),a=domUtils.findParentByTagName(s.startContainer,"pre",!0);if(a){s.collapsed||s.deleteContents();i="";if(browser.ie&&browser.version>8){utils.each(UE.filterNode(UE.htmlparser(t),r.options.filterTxtRules).children,function(e){if("element"==e.type){if("br"==e.tagName)i+="\n";else if(!dtd.$empty[e.tagName]){utils.each(e.children,function(t){"element"==t.type?"br"==t.tagName?i+="\n":dtd.$empty[e.tagName]||(i+=t.innerText()):i+=t.data});/\n$/.test(i)||(i+="\n")}}else i+=e.data+"\n";!e.nextSibling()&&/\n$/.test(i)&&(i=i.replace(/\n$/,""))});n=r.document.createTextNode(utils.html(i.replace(/&nbsp;/g," ")));s.insertNode(n).selectNode(n).select()}else{o=r.document.createDocumentFragment();utils.each(UE.filterNode(UE.htmlparser(t),r.options.filterTxtRules).children,function(e){if("element"==e.type){if("br"==e.tagName)o.appendChild(r.document.createElement("br"));else if(!dtd.$empty[e.tagName]){utils.each(e.children,function(t){"element"==t.type?"br"==t.tagName?o.appendChild(r.document.createElement("br")):dtd.$empty[e.tagName]||o.appendChild(r.document.createTextNode(utils.html(t.innerText().replace(/&nbsp;/g," ")))):o.appendChild(r.document.createTextNode(utils.html(t.data.replace(/&nbsp;/g," "))))});"BR"!=o.lastChild.nodeName&&o.appendChild(r.document.createElement("br"))}}else o.appendChild(r.document.createTextNode(utils.html(e.data.replace(/&nbsp;/g," "))));e.nextSibling()||"BR"!=o.lastChild.nodeName||o.removeChild(o.lastChild)});s.insertNode(o).select()}return!0}});t.addListener("keydown",function(e,t){var i,n,o,r,s=this,a=t.keyCode||t.which;if(40==a){i=s.selection.getRange(),o=i.startContainer;if(i.collapsed&&(n=domUtils.findParentByTagName(i.startContainer,"pre",!0))&&!n.nextSibling){r=n.lastChild;for(;r&&"BR"==r.nodeName;)r=r.previousSibling;if(r===o||i.startContainer===n&&i.startOffset==n.childNodes.length){s.execCommand("insertparagraph");domUtils.preventDefault(t)}}}});t.addListener("delkeydown",function(e,i){var n,o,r=this.selection.getRange();r.txtToElmBoundary(!0);n=r.startContainer;if(domUtils.isTagNode(n,"pre")&&r.collapsed&&domUtils.isStartInblock(r)){o=t.document.createElement("p");domUtils.fillNode(t.document,o);n.parentNode.insertBefore(o,n);domUtils.remove(n);r.setStart(o,0).setCursor(!1,!0);domUtils.preventDefault(i);return!0}})};UE.commands["cleardoc"]={execCommand:function(e){var t=this,i=t.options.enterTag,n=t.selection.getRange();if("br"==i){t.body.innerHTML="<br/>";n.setStart(t.body,0).setCursor()}else{t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>";n.setStart(t.body.firstChild,0).setCursor(!1,!0)}setTimeout(function(){t.fireEvent("clearDoc")},0)}};UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){utils.cssRule("anchor",".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){var t;if(t=e.getAttr("anchorname")){e.tagName="a";e.setAttr({anchorname:"",name:t,class:""})}})},inputRule:function(e){utils.each(e.getNodesByTagName("a"),function(e){var t;if((t=e.getAttr("name"))&&!e.getAttr("href")){e.tagName="img";e.setAttr({anchorname:e.getAttr("name"),class:"anchorclass"});e.setAttr("name")}})},commands:{anchor:{execCommand:function(e,t){var i,n=this.selection.getRange(),o=n.getClosedNode();if(o&&o.getAttribute("anchorname"))if(t)o.setAttribute("anchorname",t);else{n.setStartBefore(o).setCursor();domUtils.remove(o)}else if(t){i=this.document.createElement("img");n.collapse(!0);domUtils.setAttributes(i,{anchorname:t,class:"anchorclass"});n.insertNode(i).setStartAfter(i).setCursor(!1,!0)}}}}}});UE.plugins["wordcount"]=function(){var e,t=this;t.setOpt("wordCount",!0);t.addListener("contentchange",function(){t.fireEvent("wordcount")});t.addListener("ready",function(){var t=this;domUtils.on(t.body,"keyup",function(i){var n=i.keyCode||i.which,o={16:1,18:1,20:1,37:1,38:1,39:1,40:1};if(!(n in o)){clearTimeout(e);e=setTimeout(function(){t.fireEvent("wordcount")},200)}})})};UE.plugins["pagebreak"]=function(){function e(e){if(domUtils.isEmptyBlock(e)){for(var t,n=e.firstChild;n&&1==n.nodeType&&domUtils.isEmptyBlock(n);){t=n;n=n.firstChild}!t&&(t=e);domUtils.fillNode(i.document,t)}}function t(e){return e&&1==e.nodeType&&"HR"==e.tagName&&"pagebreak"==e.className}var i=this,n=["td"];i.setOpt("pageBreakTag","_ueditor_page_break_tag_");i.ready(function(){utils.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",i.document)});i.addInputRule(function(e){e.traversal(function(e){if("text"==e.type&&e.data==i.options.pageBreakTag){var t=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}})});i.addOutputRule(function(e){utils.each(e.getNodesByTagName("hr"),function(e){if("pagebreak"==e.getAttr("class")){var t=UE.uNode.createText(i.options.pageBreakTag);e.parentNode.insertBefore(t,e);e.parentNode.removeChild(e)}})});i.commands["pagebreak"]={execCommand:function(){var o,r,s,a,l,d,c,u,m=i.selection.getRange(),f=i.document.createElement("hr");domUtils.setAttributes(f,{class:"pagebreak",noshade:"noshade",size:"5"});domUtils.unSelectable(f);o=domUtils.findParentByTagName(m.startContainer,n,!0),r=[];if(o)switch(o.tagName){case"TD":s=o.parentNode;if(s.previousSibling){s.parentNode.insertBefore(f,s);r=domUtils.findParents(f)}else{a=domUtils.findParentByTagName(s,"table");a.parentNode.insertBefore(f,a);r=domUtils.findParents(f,!0)}s=r[1];f!==s&&domUtils.breakParent(f,s);i.fireEvent("afteradjusttable",i.document)}else{if(!m.collapsed){m.deleteContents();l=m.startContainer;for(;!domUtils.isBody(l)&&domUtils.isBlockElm(l)&&domUtils.isEmptyNode(l);){m.setStartBefore(l).collapse(!0);domUtils.remove(l);l=m.startContainer}}m.insertNode(f);s=f.parentNode;for(;!domUtils.isBody(s);){domUtils.breakParent(f,s);d=f.nextSibling;d&&domUtils.isEmptyBlock(d)&&domUtils.remove(d);s=f.parentNode}d=f.nextSibling;c=f.previousSibling;t(c)?domUtils.remove(c):c&&e(c);if(d){t(d)?domUtils.remove(d):e(d);m.setEndAfter(f).collapse(!1)}else{u=i.document.createElement("p");f.parentNode.appendChild(u);domUtils.fillNode(i.document,u);m.setStart(u,0).collapse(!0)}m.select(!0)}}}};UE.plugin.register("wordimage",function(){var e=this,t=[];return{commands:{wordimage:{execCommand:function(){var t,i,n,o=domUtils.getElementsByTagName(e.body,"img"),r=[];for(t=0;i=o[t++];){n=i.getAttribute("word_img");n&&r.push(n)}return r},queryCommandState:function(){t=domUtils.getElementsByTagName(e.body,"img");for(var i,n=0;i=t[n++];)if(i.getAttribute("word_img"))return 1;return-1},notNeedUndo:!0}},inputRule:function(t){utils.each(t.getNodesByTagName("img"),function(t){var i=t.attrs,n=parseInt(i.width)<128||parseInt(i.height)<43,o=e.options,r=o.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";i["src"]&&/^(?:(file:\/+))/.test(i["src"])&&t.setAttr({width:i.width,height:i.height,alt:i.alt,word_img:i.src,src:r,style:"background:url("+(n?o.themePath+o.theme+"/images/word.gif":o.langPath+o.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}}});UE.plugins["dragdrop"]=function(){var e=this;e.ready(function(){domUtils.on(this.body,"dragend",function(){var t,i,n=e.selection.getRange(),o=n.getClosedNode()||e.selection.getStart();if(o&&"IMG"==o.tagName){t=o.previousSibling;for(;(i=o.nextSibling)&&1==i.nodeType&&"SPAN"==i.tagName&&!i.firstChild;)domUtils.remove(i);if((t&&1==t.nodeType&&!domUtils.isEmptyBlock(t)||!t)&&(!i||i&&!domUtils.isEmptyBlock(i))){if(t&&"P"==t.tagName&&!domUtils.isEmptyBlock(t)){t.appendChild(o);domUtils.moveChild(i,t);domUtils.remove(i)}else i&&"P"==i.tagName&&!domUtils.isEmptyBlock(i)&&i.insertBefore(o,i.firstChild);t&&"P"==t.tagName&&domUtils.isEmptyBlock(t)&&domUtils.remove(t);i&&"P"==i.tagName&&domUtils.isEmptyBlock(i)&&domUtils.remove(i);n.selectNode(o).select();e.fireEvent("saveScene")}}})});e.addListener("keyup",function(t,i){var n,o,r=i.keyCode||i.which;if(13==r){n=e.selection.getRange();(o=domUtils.findParentByTagName(n.startContainer,"p",!0))&&"center"==domUtils.getComputedStyle(o,"text-align")&&domUtils.removeStyle(o,"text-align")}})};UE.plugins["undo"]=function(){function e(e,t){if(e.length!=t.length)return 0;for(var i=0,n=e.length;i<n;i++)if(e[i]!=t[i])return 0;return 1}function t(t,i){return t.collapsed!=i.collapsed?0:e(t.startAddress,i.startAddress)&&e(t.endAddress,i.endAddress)?1:0}function i(){this.list=[];this.index=0;this.hasUndo=!1;this.hasRedo=!1;this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&1==this.list.length){this.reset();return}for(;this.list[this.index].content==this.list[this.index-1].content;){this.index--;if(0==this.index)return this.restore(0)}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}};this.restore=function(){var e,t=this.editor,i=this.list[this.index],n=UE.htmlparser(i.content.replace(m,""));t.options.autoClearEmptyNode=!1;t.filterInputRule(n);t.options.autoClearEmptyNode=h;t.document.body.innerHTML=n.toHtml();t.fireEvent("afterscencerestore");browser.ie&&utils.each(domUtils.getElementsByTagName(t.document,"td th caption p"),function(e){domUtils.isEmptyNode(e)&&domUtils.fillNode(t.document,e)});try{e=new dom.Range(t.document).moveToAddress(i.address);e.select(f[e.startContainer.nodeName.toLowerCase()])}catch(e){}this.update();this.clearKey();t.fireEvent("reset",!0)};this.getScene=function(){var e,t,i=this.editor,n=i.selection.getRange(),o=n.createAddress(!1,!0);i.fireEvent("beforegetscene");e=UE.htmlparser(i.body.innerHTML);i.options.autoClearEmptyNode=!1;i.filterOutputRule(e);i.options.autoClearEmptyNode=h;t=e.toHtml();i.fireEvent("aftergetscene");return{address:o,content:t}};this.save=function(e,i){clearTimeout(n);var o=this.getScene(i),r=this.list[this.index];r&&r.content!=o.content&&d.trigger("contentchange");if(!(r&&r.content==o.content&&(e?1:t(r.address,o.address)))){this.list=this.list.slice(0,this.index+1);this.list.push(o);this.list.length>c&&this.list.shift();this.index=this.list.length-1;this.clearKey();this.update()}};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasUndo=!1;this.hasRedo=!1;this.clearKey()};this.clearKey=function(){r=0;s=null}}var n,o,r,s,a,l,d=this,c=d.options.maxUndoCount||20,u=d.options.maxInputCount||20,m=new RegExp(domUtils.fillChar+"|</hr>","gi"),f={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},h=d.options.autoClearEmptyNode;d.undoManger=new i;d.undoManger.editor=d;d.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)});d.addListener("reset",function(e,t){t||this.undoManger.reset()});d.commands["redo"]=d.commands["undo"]={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+("undo"==e.toLowerCase()?"Undo":"Redo")]?0:-1},notNeedUndo:1};o={16:1,17:1,18:1,37:1,38:1,39:1,40:1},r=0;a=!1;d.addListener("ready",function(){domUtils.on(this.body,"compositionstart",function(){a=!0});domUtils.on(this.body,"compositionend",function(){a=!1})});d.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});l=!0;d.addListener("keydown",function(e,t){function i(e){e.undoManger.save(!1,!0);e.fireEvent("selectionchange")}var d=this,c=t.keyCode||t.which;if(!o[c]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(a)return;if(!d.selection.getRange().collapsed){d.undoManger.save(!1,!0);l=!1;return}0==d.undoManger.list.length&&d.undoManger.save(!0);clearTimeout(n);n=setTimeout(function(){if(a)var e=setInterval(function(){if(!a){i(d);clearInterval(e)}},300);else i(d)},200);s=c;r++;r>=u&&i(d)}});d.addListener("keyup",function(e,t){var i=t.keyCode||t.which;if(!o[i]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(a)return;if(!l){this.undoManger.save(!1,!0);l=!0}}});d.stopCmdUndo=function(){d.__hasEnterExecCommand=!0};d.startCmdUndo=function(){d.__hasEnterExecCommand=!1}};UE.plugin.register("copy",function(){function e(){ZeroClipboard.config({debug:!1,swfPath:t.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var e=t.zeroclipboard=new ZeroClipboard;e.on("copy",function(e){var i=e.client,n=t.selection.getRange(),o=document.createElement("div");o.appendChild(n.cloneContents());i.setText(o.innerText||o.textContent);i.setHtml(o.innerHTML);n.select()});e.on("mouseover mouseout",function(e){var t=e.target;"mouseover"==e.type?domUtils.addClass(t,"edui-state-hover"):"mouseout"==e.type&&domUtils.removeClasses(t,"edui-state-hover")});e.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var t=this;return{bindEvents:{ready:function(){browser.ie||(window.ZeroClipboard?e():utils.loadFile(document,{src:t.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){e()}))}},commands:{copy:{execCommand:function(e){t.document.execCommand("copy")||alert(t.getLang("copymsg"))}}}}});UE.plugins["paste"]=function(){function e(e){var t,i,n,o=this.document;if(!o.getElementById("baidu_pastebin")){t=this.selection.getRange(),i=t.createBookmark(),n=o.createElement("div");n.id="baidu_pastebin";browser.webkit&&n.appendChild(o.createTextNode(domUtils.fillChar+domUtils.fillChar));o.body.appendChild(n);i.start.style.display="";n.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+domUtils.getXY(i.start).y+"px";t.selectNodeContents(n).select(!0);setTimeout(function(){if(browser.webkit)for(var r,s=0,a=o.querySelectorAll("#baidu_pastebin");r=a[s++];){if(!domUtils.isEmptyNode(r)){n=r;break}domUtils.remove(r)}try{n.parentNode.removeChild(n)}catch(e){}t.moveToBookmark(i).select(!0);e(n)},0)}}function t(e){return e.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(e,t,i,n){i=i.toLowerCase();if({img:1}[i])return e;n=n.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(e,t,i){return{src:1,href:1,name:1}[t.toLowerCase()]?t+"="+i+" ":""});return{span:1,div:1}[i]?"":"<"+t+i+" "+utils.trim(n)+">"})}function i(e){var i,a,l,d,c,u,m,f,h,p,g,b,y,v,C,N;if(e.firstChild){a=domUtils.getElementsByTagName(e,"span");for(l=0;d=a[l++];)"_baidu_cut_start"!=d.id&&"_baidu_cut_end"!=d.id||domUtils.remove(d);if(browser.webkit){c=e.querySelectorAll("div br");for(l=0;u=c[l++];){m=u.parentNode;if("DIV"==m.tagName&&1==m.childNodes.length){m.innerHTML="<p><br/></p>";domUtils.remove(m)}}f=e.querySelectorAll("#baidu_pastebin");for(l=0;h=f[l++];){p=s.document.createElement("p");h.parentNode.insertBefore(p,h);for(;h.firstChild;)p.appendChild(h.firstChild);domUtils.remove(h)}g=e.querySelectorAll("meta");for(l=0;b=g[l++];)domUtils.remove(b);c=e.querySelectorAll("br");for(l=0;b=c[l++];)/^apple-/i.test(b.className)&&domUtils.remove(b)}if(browser.gecko){y=e.querySelectorAll("[_moz_dirty]");for(l=0;b=y[l++];)b.removeAttribute("_moz_dirty")}if(!browser.ie){v=e.querySelectorAll("span.Apple-style-span");for(l=0;b=v[l++];)domUtils.remove(b,!0)}i=e.innerHTML;i=UE.filterWord(i);C=UE.htmlparser(i);s.options.filterRules&&UE.filterNode(C,s.options.filterRules);s.filterInputRule(C);if(browser.webkit){N=C.lastChild();N&&"element"==N.type&&"br"==N.tagName&&C.removeChild(N);utils.each(s.body.querySelectorAll("div"),function(e){domUtils.isEmptyBlock(e)&&domUtils.remove(e,!0)})}i={html:C.toHtml()};s.fireEvent("beforepaste",i,C);if(!i.html)return;C=UE.htmlparser(i.html,!0);if(1===s.queryCommandState("pasteplain"))s.execCommand("insertHtml",UE.filterNode(C,s.options.filterTxtRules).toHtml(),!0);else{UE.filterNode(C,s.options.filterTxtRules);n=C.toHtml();o=i.html;r=s.selection.getRange().createAddress(!0);s.execCommand("insertHtml",s.getOpt("retainOnlyLabelPasted")===!0?t(o):o,!0)}s.fireEvent("afterpaste",i)}}var n,o,r,s=this;s.setOpt({retainOnlyLabelPasted:!1});s.addListener("pasteTransfer",function(e,i){var a,l,d,c,u,m,f,h;if(r&&n&&o&&n!=o){a=s.selection.getRange();a.moveToAddress(r,!0);if(!a.collapsed){for(;!domUtils.isBody(a.startContainer);){l=a.startContainer;if(1==l.nodeType){l=l.childNodes[a.startOffset];if(!l){a.setStartBefore(a.startContainer);continue}d=l.previousSibling;d&&3==d.nodeType&&new RegExp("^[\n\r\t "+domUtils.fillChar+"]*$").test(d.nodeValue)&&a.setStartBefore(d)}if(0!=a.startOffset)break;a.setStartBefore(a.startContainer)}for(;!domUtils.isBody(a.endContainer);){c=a.endContainer;if(1==c.nodeType){c=c.childNodes[a.endOffset];if(!c){a.setEndAfter(a.endContainer);continue}u=c.nextSibling;u&&3==u.nodeType&&new RegExp("^[\n\r\t"+domUtils.fillChar+"]*$").test(u.nodeValue)&&a.setEndAfter(u)}if(a.endOffset!=a.endContainer[3==a.endContainer.nodeType?"nodeValue":"childNodes"].length)break;a.setEndAfter(a.endContainer)}}a.deleteContents();a.select(!0);s.__hasEnterExecCommand=!0;m=o;2===i?m=t(m):i&&(m=n);s.execCommand("inserthtml",m,!0);s.__hasEnterExecCommand=!1;f=s.selection.getRange();for(;!domUtils.isBody(f.startContainer)&&!f.startOffset&&f.startContainer[3==f.startContainer.nodeType?"nodeValue":"childNodes"].length;)f.setStartBefore(f.startContainer);h=f.createAddress(!0);r.endAddress=h.startAddress}});s.addListener("ready",function(){domUtils.on(s.body,"cut",function(){var e=s.selection.getRange();!e.collapsed&&s.undoManger&&s.undoManger.save()});domUtils.on(s.body,browser.ie||browser.opera?"keydown":"paste",function(t){(!browser.ie&&!browser.opera||(t.ctrlKey||t.metaKey)&&"86"==t.keyCode)&&e.call(s,function(e){i(e)})})});s.commands["paste"]={execCommand:function(t){if(browser.ie){e.call(s,function(e){i(e)});s.document.execCommand("paste")}else alert(s.getLang("pastemsg"))}}};UE.plugins["pasteplain"]=function(){var e,t=this;t.setOpt({pasteplain:!1,filterTxtRules:function(){function e(e){e.tagName="p";e.setStyle()}function t(e){e.parentNode.removeChild(e,!0)}return{"-":"script style object iframe embed input select",p:{$:{}},br:{$:{}},div:function(e){for(var t,i=UE.uNode.createElement("p");t=e.firstChild();)if("text"!=t.type&&UE.dom.dtd.$block[t.tagName])if(i.firstChild()){e.parentNode.insertBefore(i,e);i=UE.uNode.createElement("p")}else e.parentNode.insertBefore(t,e);else i.appendChild(t);i.firstChild()&&e.parentNode.insertBefore(i,e);e.parentNode.removeChild(e)},ol:t,ul:t,dl:t,dt:t,dd:t,li:t,caption:e,th:e,tr:e,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e,td:function(e){var t=!!e.innerText();t&&e.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),e);e.parentNode.removeChild(e,e.innerText())}}}()});e=t.options.pasteplain;t.commands["pasteplain"]={queryCommandState:function(){return e?1:0},execCommand:function(){e=0|!e},notNeedUndo:1}};UE.plugins["list"]=function(){function e(e){var t,i=[];for(t in e)i.push(t);return i}function t(e){var t=e.className;return domUtils.hasClass(e,/custom_/)?t.match(/custom_(\w+)/)[1]:domUtils.getStyle(e,"list-style-type")}function i(e,i){utils.each(domUtils.getElementsByTagName(e,"ol ul"),function(r){var s,l,d,c,u,f,h;if(domUtils.inDoc(r,e)){s=r.parentNode;if(s.tagName==r.tagName){l=t(r)||("OL"==r.tagName?"decimal":"disc"),d=t(s)||("OL"==s.tagName?"decimal":"disc");if(l==d){c=utils.indexOf(a[r.tagName],l);c=c+1==a[r.tagName].length?0:c+1;o(r,a[r.tagName][c])}}u=0,f=2;domUtils.hasClass(r,/custom_/)?/[ou]l/i.test(s.tagName)&&domUtils.hasClass(s,/custom_/)||(f=1):/[ou]l/i.test(s.tagName)&&domUtils.hasClass(s,/custom_/)&&(f=3);h=domUtils.getStyle(r,"list-style-type");h&&(r.style.cssText="list-style-type:"+h);r.className=utils.trim(r.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+f;utils.each(domUtils.getElementsByTagName(r,"li"),function(e){var i,n,o;e.style.cssText&&(e.style.cssText="");if(e.firstChild){if(e.parentNode===r){u++;if(domUtils.hasClass(r,/custom_/)){i=1,n=t(r);if("OL"==r.tagName){if(n)switch(n){case"cn":case"cn1":case"cn2":u>10&&(u%10==0||u>10&&u<20)?i=2:u>20&&(i=3);break;case"num2":u>9&&(i=2)}e.className="list-"+m[n]+u+" list-"+n+"-paddingleft-"+i}else e.className="list-"+m[n]+" list-"+n+"-paddingleft"}else e.className=e.className.replace(/list-[\w\-]+/gi,"");o=e.getAttribute("class");null===o||o.replace(/\s/g,"")||domUtils.removeAttributes(e,"class")}}else domUtils.remove(e)});!i&&n(r,r.tagName.toLowerCase(),t(r)||domUtils.getStyle(r,"list-style-type"),!0)}})}function n(e,n,o,r){var s,a=e.nextSibling;if(a&&1==a.nodeType&&a.tagName.toLowerCase()==n&&(t(a)||domUtils.getStyle(a,"list-style-type")||("ol"==n?"decimal":"disc"))==o){domUtils.moveChild(a,e);0==a.childNodes.length&&domUtils.remove(a)}a&&domUtils.isFillChar(a)&&domUtils.remove(a);s=e.previousSibling;s&&1==s.nodeType&&s.tagName.toLowerCase()==n&&(t(s)||domUtils.getStyle(s,"list-style-type")||("ol"==n?"decimal":"disc"))==o&&domUtils.moveChild(e,s);s&&domUtils.isFillChar(s)&&domUtils.remove(s);!r&&domUtils.isEmptyBlock(e)&&domUtils.remove(e);t(e)&&i(e.ownerDocument,!0)}function o(e,t){m[t]&&(e.className="custom_"+t);try{domUtils.setStyle(e,"list-style-type",t)}catch(e){}}function r(e){var t=e.previousSibling;t&&domUtils.isEmptyBlock(t)&&domUtils.remove(t);t=e.nextSibling;t&&domUtils.isEmptyBlock(t)&&domUtils.remove(t)}function s(e){for(;e&&!domUtils.isBody(e);){if("TABLE"==e.nodeName)return null;if("LI"==e.nodeName)return e;e=e.parentNode}}var a,l,d,c=this,u={TD:1,PRE:1,BLOCKQUOTE:1},m={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};c.setOpt({autoTransWordToList:!1,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:!1});a={OL:e(c.options.insertorderedlist),UL:e(c.options.insertunorderedlist)};l=c.options.listiconpath;for(d in m)c.options.insertorderedlist.hasOwnProperty(d)||c.options.insertunorderedlist.hasOwnProperty(d)||delete m[d];c.ready(function(){var e,t,i=[];for(e in m){if("dash"==e||"dot"==e){i.push("li.list-"+m[e]+"{background-image:url("+l+m[e]+".gif)}");i.push("ul.custom_"+e+"{list-style:none;}ul.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(t=0;t<99;t++)i.push("li.list-"+m[e]+t+"{background-image:url("+l+"list-"+m[e]+t+".gif)}");i.push("ol.custom_"+e+"{list-style:none;}ol.custom_"+e+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(e){case"cn":i.push("li.list-"+e+"-paddingleft-1{padding-left:25px}");i.push("li.list-"+e+"-paddingleft-2{padding-left:40px}");i.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn1":i.push("li.list-"+e+"-paddingleft-1{padding-left:30px}");i.push("li.list-"+e+"-paddingleft-2{padding-left:40px}");i.push("li.list-"+e+"-paddingleft-3{padding-left:55px}");break;case"cn2":i.push("li.list-"+e+"-paddingleft-1{padding-left:40px}");i.push("li.list-"+e+"-paddingleft-2{padding-left:55px}");i.push("li.list-"+e+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":i.push("li.list-"+e+"-paddingleft-1{padding-left:25px}");break;case"num2":i.push("li.list-"+e+"-paddingleft-1{padding-left:35px}");i.push("li.list-"+e+"-paddingleft-2{padding-left:40px}");break;case"dash":i.push("li.list-"+e+"-paddingleft{padding-left:35px}");break;case"dot":i.push("li.list-"+e+"-paddingleft{padding-left:20px}")}}i.push(".list-paddingleft-1{padding-left:0}");i.push(".list-paddingleft-2{padding-left:"+c.options.listDefaultPaddingLeft+"px}");i.push(".list-paddingleft-3{padding-left:"+2*c.options.listDefaultPaddingLeft+"px}")});c.ready(function(){domUtils.on(c.body,"cut",function(){setTimeout(function(){var e,t,i,n,o=c.selection.getRange();if(!o.collapsed&&(e=domUtils.findParentByTagName(o.startContainer,"li",!0))&&!e.nextSibling&&domUtils.isEmptyBlock(e)){t=e.parentNode;if(i=t.previousSibling){domUtils.remove(t);o.setStartAtLast(i).collapse(!0);o.select(!0)}else if(i=t.nextSibling){domUtils.remove(t);o.setStartAtFirst(i).collapse(!0);o.select(!0)}else{n=c.document.createElement("p");domUtils.fillNode(c.document,n);t.parentNode.insertBefore(n,t);domUtils.remove(t);o.setStart(n,0).collapse(!0);o.select(!0)}}})})});c.addListener("beforepaste",function(e,i){var n,o,r,s=this,l=s.selection.getRange(),d=UE.htmlparser(i.html,!0);if(n=domUtils.findParentByTagName(l.startContainer,"li",!0)){o=n.parentNode,r="OL"==o.tagName?"ul":"ol";utils.each(d.getNodesByTagName(r),function(i){var n,r,s;i.tagName=o.tagName;i.setAttr();if(i.parentNode===d)e=t(o)||("OL"==o.tagName?"decimal":"disc");else{n=i.parentNode.getAttr("class");e=n&&/custom_/.test(n)?n.match(/custom_(\w+)/)[1]:i.parentNode.getStyle("list-style-type");e||(e="OL"==o.tagName?"decimal":"disc")}r=utils.indexOf(a[o.tagName],e);i.parentNode!==d&&(r=r+1==a[o.tagName].length?0:r+1);s=a[o.tagName][r];m[s]?i.setAttr("class","custom_"+s):i.setStyle("list-style-type",s)})}i.html=d.toHtml()});c.getOpt("disablePInList")===!0&&c.addOutputRule(function(e){utils.each(e.getNodesByTagName("li"),function(e){var t=[],i=0;utils.each(e.children,function(n){var o,r;if("p"==n.tagName){for(;o=n.children.pop();){t.splice(i,0,o);o.parentNode=e;lastNode=o}o=t[t.length-1];if(!o||"element"!=o.type||"br"!=o.tagName){r=UE.uNode.createElement("br");r.parentNode=e;t.push(r)}i=t.length}});t.length&&(e.children=t)})});c.addInputRule(function(e){function t(e,t){var o,r=t.firstChild();if(r&&"element"==r.type&&"span"==r.tagName&&/Wingdings|Symbol/.test(r.getStyle("font-family"))){for(o in n)if(n[o]==r.data)return o;return"disc"}for(o in i)if(i[o].test(e))return o}utils.each(e.getNodesByTagName("li"),function(e){var t,i,n,o,r=UE.uNode.createElement("p");for(t=0;i=e.children[t];)if("text"==i.type||dtd.p[i.tagName])r.appendChild(i);else if(r.firstChild()){e.insertBefore(r,i);r=UE.uNode.createElement("p");t+=2}else t++;(r.firstChild()&&!r.parentNode||!e.firstChild())&&e.appendChild(r);r.firstChild()||r.innerHTML(browser.ie?"&nbsp;":"<br/>");n=e.firstChild();o=n.lastChild();o&&"text"==o.type&&/^\s*$/.test(o.data)&&n.removeChild(o)});if(c.options.autoTransWordToList){var i={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},n={square:"n"};utils.each(e.getNodesByTagName("p"),function(e){function n(e,t,n){var o,r;if("ol"==e.tagName)if(browser.ie){o=t.firstChild();"element"==o.type&&"span"==o.tagName&&i[n].test(o.innerText())&&t.removeChild(o)}else t.innerHTML(t.innerHTML().replace(i[n],""));else t.removeChild(t.firstChild());r=UE.uNode.createElement("li");r.appendChild(t);e.appendChild(r)}var o,r,s,a,l;if("MsoListParagraph"==e.getAttr("class")){e.setStyle("margin","");e.setStyle("margin-left","");e.setAttr("class","");o=e,s=e;if("li"!=e.parentNode.tagName&&(r=t(e.innerText(),e))){a=UE.uNode.createElement(c.options.insertorderedlist.hasOwnProperty(r)?"ol":"ul");m[r]?a.setAttr("class","custom_"+r):a.setStyle("list-style-type",r);for(;e&&"li"!=e.parentNode.tagName&&t(e.innerText(),e);){o=e.nextSibling();o||e.parentNode.insertBefore(a,e);n(a,e,r);e=o}!a.parentNode&&e&&e.parentNode&&e.parentNode.insertBefore(a,e)}l=s.firstChild();l&&"element"==l.type&&"span"==l.tagName&&/^\s*(&nbsp;)+\s*$/.test(l.innerText())&&l.parentNode.removeChild(l)}})}});c.addListener("contentchange",function(){i(c.document)});c.addListener("keydown",function(e,t){function i(){t.preventDefault?t.preventDefault():t.returnValue=!1;c.fireEvent("contentchange");c.undoManger&&c.undoManger.save()}function n(e,t){for(;e&&!domUtils.isBody(e);){if(t(e))return null;if(1==e.nodeType&&/[ou]l/i.test(e.tagName))return e;e=e.parentNode}return null}var o,s,a,l,d,u,m,f,h,p,g,b,y,v,C,N=t.keyCode||t.which;if(13==N&&!t.shiftKey){o=c.selection.getRange(),s=domUtils.findParent(o.startContainer,function(e){return domUtils.isBlockElm(e)},!0),a=domUtils.findParentByTagName(o.startContainer,"li",!0);if(s&&"PRE"!=s.tagName&&!a){l=s.innerHTML.replace(new RegExp(domUtils.fillChar,"g"),"");if(/^\s*1\s*\.[^\d]/.test(l)){s.innerHTML=l.replace(/^\s*1\s*\./,"");o.setStartAtLast(s).collapse(!0).select();c.__hasEnterExecCommand=!0;c.execCommand("insertorderedlist");c.__hasEnterExecCommand=!1}}d=c.selection.getRange(),u=n(d.startContainer,function(e){return"TABLE"==e.tagName}),m=d.collapsed?u:n(d.endContainer,function(e){return"TABLE"==e.tagName});if(u&&m&&u===m){if(!d.collapsed){u=domUtils.findParentByTagName(d.startContainer,"li",!0);m=domUtils.findParentByTagName(d.endContainer,"li",!0);if(!u||!m||u!==m){f=d.cloneRange(),h=f.collapse(!1).createBookmark();d.deleteContents();f.moveToBookmark(h);a=domUtils.findParentByTagName(f.startContainer,"li",!0);r(a);f.select();i();return}d.deleteContents();a=domUtils.findParentByTagName(d.startContainer,"li",!0);if(a&&domUtils.isEmptyBlock(a)){C=a.previousSibling;next=a.nextSibling;b=c.document.createElement("p");domUtils.fillNode(c.document,b);p=a.parentNode;if(C&&next){
d.setStart(next,0).collapse(!0).select(!0);domUtils.remove(a)}else{(C||next)&&C?a.parentNode.parentNode.insertBefore(b,p.nextSibling):p.parentNode.insertBefore(b,p);domUtils.remove(a);p.firstChild||domUtils.remove(p);d.setStart(b,0).setCursor()}i();return}}a=domUtils.findParentByTagName(d.startContainer,"li",!0);if(a){if(domUtils.isEmptyBlock(a)){h=d.createBookmark();p=a.parentNode;if(a!==p.lastChild){domUtils.breakParent(a,p);r(a)}else{p.parentNode.insertBefore(a,p.nextSibling);domUtils.isEmptyNode(p)&&domUtils.remove(p)}if(!dtd.$list[a.parentNode.tagName])if(domUtils.isBlockElm(a.firstChild))domUtils.remove(a,!0);else{b=c.document.createElement("p");a.parentNode.insertBefore(b,a);for(;a.firstChild;)b.appendChild(a.firstChild);domUtils.remove(a)}d.moveToBookmark(h).select()}else{g=a.firstChild;if(!g||!domUtils.isBlockElm(g)){b=c.document.createElement("p");!a.firstChild&&domUtils.fillNode(c.document,b);for(;a.firstChild;)b.appendChild(a.firstChild);a.appendChild(b);g=b}y=c.document.createElement("span");d.insertNode(y);domUtils.breakParent(y,a);v=y.nextSibling;g=v.firstChild;if(!g){b=c.document.createElement("p");domUtils.fillNode(c.document,b);v.appendChild(b);g=b}if(domUtils.isEmptyNode(g)){g.innerHTML="";domUtils.fillNode(c.document,g)}d.setStart(g,0).collapse(!0).shrinkBoundary().select();domUtils.remove(y);C=v.previousSibling;if(C&&domUtils.isEmptyBlock(C)){C.innerHTML="<p></p>";domUtils.fillNode(c.document,C.firstChild)}}i()}}}if(8==N){d=c.selection.getRange();if(d.collapsed&&domUtils.isStartInblock(d)){f=d.cloneRange().trimBoundary();a=domUtils.findParentByTagName(d.startContainer,"li",!0);if(a&&domUtils.isStartInblock(f)){u=domUtils.findParentByTagName(d.startContainer,"p",!0);if(u&&u!==a.firstChild){p=domUtils.findParentByTagName(u,["ol","ul"]);domUtils.breakParent(u,p);r(u);c.fireEvent("contentchange");d.setStart(u,0).setCursor(!1,!0);c.fireEvent("saveScene");domUtils.preventDefault(t);return}if(a&&(C=a.previousSibling)){if(46==N&&a.childNodes.length)return;dtd.$list[C.tagName]&&(C=C.lastChild);c.undoManger&&c.undoManger.save();g=a.firstChild;if(domUtils.isBlockElm(g))if(domUtils.isEmptyNode(g)){C.appendChild(g);d.setStart(g,0).setCursor(!1,!0);for(;a.firstChild;)C.appendChild(a.firstChild)}else{y=c.document.createElement("span");d.insertNode(y);domUtils.isEmptyBlock(C)&&(C.innerHTML="");domUtils.moveChild(a,C);d.setStartBefore(y).collapse(!0).select(!0);domUtils.remove(y)}else if(domUtils.isEmptyNode(a)){b=c.document.createElement("p");C.appendChild(b);d.setStart(b,0).setCursor()}else{d.setEnd(C,C.childNodes.length).collapse().select(!0);for(;a.firstChild;)C.appendChild(a.firstChild)}domUtils.remove(a);c.fireEvent("contentchange");c.fireEvent("saveScene");domUtils.preventDefault(t);return}if(a&&!a.previousSibling){p=a.parentNode;h=d.createBookmark();if(domUtils.isTagNode(p.parentNode,"ol ul")){p.parentNode.insertBefore(a,p);domUtils.isEmptyNode(p)&&domUtils.remove(p)}else{for(;a.firstChild;)p.parentNode.insertBefore(a.firstChild,p);domUtils.remove(a);domUtils.isEmptyNode(p)&&domUtils.remove(p)}d.moveToBookmark(h).setCursor(!1,!0);c.fireEvent("contentchange");c.fireEvent("saveScene");domUtils.preventDefault(t);return}}}}});c.addListener("keyup",function(e,i){var o,r,s=i.keyCode||i.which;if(8==s){o=c.selection.getRange();(r=domUtils.findParentByTagName(o.startContainer,["ol","ul"],!0))&&n(r,r.tagName.toLowerCase(),t(r)||domUtils.getComputedStyle(r,"list-style-type"),!0)}});c.addListener("tabkeydown",function(){function e(e){if(c.options.maxListLevel!=-1){for(var t=e.parentNode,i=0;/[ou]l/i.test(t.tagName);){i++;t=t.parentNode}if(i>=c.options.maxListLevel)return!0}}var i,r,s,l,d,u,m,f,h,p,g,b=c.selection.getRange(),y=domUtils.findParentByTagName(b.startContainer,"li",!0);if(y){if(!b.collapsed){c.fireEvent("saveScene");i=b.createBookmark();for(u=0,f=domUtils.findParents(y);h=f[u++];)if(domUtils.isTagNode(h,"ol ul")){m=h;break}p=y;if(i.end)for(;p&&!(domUtils.getPosition(p,i.end)&domUtils.POSITION_FOLLOWING);)if(e(p))p=domUtils.getNextDomNode(p,!1,null,function(e){return e!==m});else{r=p.parentNode,s=c.document.createElement(r.tagName),l=utils.indexOf(a[s.tagName],t(r)||domUtils.getComputedStyle(r,"list-style-type"));g=l+1==a[s.tagName].length?0:l+1;d=a[s.tagName][g];o(s,d);r.insertBefore(s,p);for(;p&&!(domUtils.getPosition(p,i.end)&domUtils.POSITION_FOLLOWING);){y=p.nextSibling;s.appendChild(p);if(!y||domUtils.isTagNode(y,"ol ul")){if(y)for(;(y=y.firstChild)&&"LI"!=y.tagName;);else y=domUtils.getNextDomNode(p,!1,null,function(e){return e!==m});break}p=y}n(s,s.tagName.toLowerCase(),d);p=y}c.fireEvent("contentchange");b.moveToBookmark(i).select();return!0}if(e(y))return!0;r=y.parentNode,s=c.document.createElement(r.tagName),l=utils.indexOf(a[s.tagName],t(r)||domUtils.getComputedStyle(r,"list-style-type"));l=l+1==a[s.tagName].length?0:l+1;d=a[s.tagName][l];o(s,d);if(domUtils.isStartInblock(b)){c.fireEvent("saveScene");i=b.createBookmark();r.insertBefore(s,y);s.appendChild(y);n(s,s.tagName.toLowerCase(),d);c.fireEvent("contentchange");b.moveToBookmark(i).select(!0);return!0}}});c.commands["insertorderedlist"]=c.commands["insertunorderedlist"]={execCommand:function(e,i){var r,a,l,d,c,m,f,h,p,g,b,y,v,C,N,x,w,U,E,T,S,k,B,I,_,A,R,L,D,O;i||(i="insertorderedlist"==e.toLowerCase()?"decimal":"disc");r=this,a=this.selection.getRange(),l=function(e){return 1==e.nodeType?"br"!=e.tagName.toLowerCase():!domUtils.isWhitespace(e)},d="insertorderedlist"==e.toLowerCase()?"ol":"ul",c=r.document.createDocumentFragment();a.adjustmentBoundary().shrinkBoundary();m=a.createBookmark(!0),f=s(r.document.getElementById(m.start)),h=0,p=s(r.document.getElementById(m.end)),g=0;if(f||p){f&&(b=f.parentNode);m.end||(p=f);p&&(y=p.parentNode);if(b===y){for(;f!==p;){C=f;f=f.nextSibling;if(!domUtils.isBlockElm(C.firstChild)){N=r.document.createElement("p");for(;C.firstChild;)N.appendChild(C.firstChild);C.appendChild(N)}c.appendChild(C)}C=r.document.createElement("span");b.insertBefore(C,p);if(!domUtils.isBlockElm(p.firstChild)){N=r.document.createElement("p");for(;p.firstChild;)N.appendChild(p.firstChild);p.appendChild(N)}c.appendChild(p);domUtils.breakParent(C,b);domUtils.isEmptyNode(C.previousSibling)&&domUtils.remove(C.previousSibling);domUtils.isEmptyNode(C.nextSibling)&&domUtils.remove(C.nextSibling);x=t(b)||domUtils.getComputedStyle(b,"list-style-type")||("insertorderedlist"==e.toLowerCase()?"decimal":"disc");if(b.tagName.toLowerCase()==d&&x==i){for(w=0,E=r.document.createDocumentFragment();U=c.firstChild;)if(domUtils.isTagNode(U,"ol ul"))E.appendChild(U);else for(;U.firstChild;){E.appendChild(U.firstChild);domUtils.remove(U)}C.parentNode.insertBefore(E,C)}else{v=r.document.createElement(d);o(v,i);v.appendChild(c);C.parentNode.insertBefore(v,C)}domUtils.remove(C);v&&n(v,d,i);a.moveToBookmark(m).select();return}if(f){for(;f;){C=f.nextSibling;if(domUtils.isTagNode(f,"ol ul"))c.appendChild(f);else{T=r.document.createDocumentFragment(),S=0;for(;f.firstChild;){domUtils.isBlockElm(f.firstChild)&&(S=1);T.appendChild(f.firstChild)}if(S)c.appendChild(T);else{k=r.document.createElement("p");k.appendChild(T);c.appendChild(k)}domUtils.remove(f)}f=C}b.parentNode.insertBefore(c,b.nextSibling);if(domUtils.isEmptyNode(b)){a.setStartBefore(b);domUtils.remove(b)}else a.setStartAfter(b);h=1}if(p&&domUtils.inDoc(y,r.document)){f=y.firstChild;for(;f&&f!==p;){C=f.nextSibling;if(domUtils.isTagNode(f,"ol ul"))c.appendChild(f);else{T=r.document.createDocumentFragment();S=0;for(;f.firstChild;){domUtils.isBlockElm(f.firstChild)&&(S=1);T.appendChild(f.firstChild)}if(S)c.appendChild(T);else{k=r.document.createElement("p");k.appendChild(T);c.appendChild(k)}domUtils.remove(f)}f=C}B=domUtils.createElement(r.document,"div",{tmpDiv:1});domUtils.moveChild(p,B);c.appendChild(B);domUtils.remove(p);y.parentNode.insertBefore(c,y);a.setEndBefore(y);domUtils.isEmptyNode(y)&&domUtils.remove(y);g=1}}h||a.setStartBefore(r.document.getElementById(m.start));m.end&&!g&&a.setEndAfter(r.document.getElementById(m.end));a.enlarge(!0,function(e){return u[e.tagName]});c=r.document.createDocumentFragment();I=a.createBookmark(),_=domUtils.getNextDomNode(I.start,!1,l),A=a.cloneRange(),L=domUtils.isBlockElm;for(;_&&_!==I.end&&domUtils.getPosition(_,I.end)&domUtils.POSITION_PRECEDING;)if(3==_.nodeType||dtd.li[_.tagName]){if(1==_.nodeType&&dtd.$list[_.tagName]){for(;_.firstChild;)c.appendChild(_.firstChild);R=domUtils.getNextDomNode(_,!1,l);domUtils.remove(_);_=R;continue}R=_;A.setStartBefore(_);for(;_&&_!==I.end&&(!L(_)||domUtils.isBookmarkNode(_));){R=_;_=domUtils.getNextDomNode(_,!1,null,function(e){return!u[e.tagName]})}if(_&&L(_)){C=domUtils.getNextDomNode(R,!1,l);if(C&&domUtils.isBookmarkNode(C)){_=domUtils.getNextDomNode(C,!1,l);R=C}}A.setEndAfter(R);_=domUtils.getNextDomNode(R,!1,l);D=a.document.createElement("li");D.appendChild(A.extractContents());if(domUtils.isEmptyNode(D)){R=a.document.createElement("p");for(;D.firstChild;)R.appendChild(D.firstChild);D.appendChild(R)}c.appendChild(D)}else _=domUtils.getNextDomNode(_,!0,l);a.moveToBookmark(I).collapse(!0);v=r.document.createElement(d);o(v,i);v.appendChild(c);a.insertNode(v);n(v,d,i);for(w=0,O=domUtils.getElementsByTagName(v,"div");U=O[w++];)U.getAttribute("tmpDiv")&&domUtils.remove(U,!0);a.moveToBookmark(m).select()},queryCommandState:function(e){var t,i,n="insertorderedlist"==e.toLowerCase()?"ol":"ul",o=this.selection.getStartElementPath();for(t=0;i=o[t++];){if("TABLE"==i.nodeName)return 0;if(n==i.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(e){var i,n,o,r="insertorderedlist"==e.toLowerCase()?"ol":"ul",s=this.selection.getStartElementPath();for(n=0;o=s[n++];){if("TABLE"==o.nodeName){i=null;break}if(r==o.nodeName.toLowerCase()){i=o;break}}return i?t(i)||domUtils.getComputedStyle(i,"list-style-type"):null}}};!function(){var e={textarea:function(e,t){var i=t.ownerDocument.createElement("textarea");i.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(browser.ie&&browser.version<8){i.style.width=t.offsetWidth+"px";i.style.height=t.offsetHeight+"px";t.onresize=function(){i.style.width=t.offsetWidth+"px";i.style.height=t.offsetHeight+"px"}}t.appendChild(i);return{setContent:function(e){i.value=e},getContent:function(){return i.value},select:function(){var e;if(browser.ie){e=i.createTextRange();e.collapse(!0);e.select()}else{i.setSelectionRange(0,0);i.focus()}},dispose:function(){t.removeChild(i);t.onresize=null;i=null;t=null}}},codemirror:function(e,t){var i=window.CodeMirror(t,{mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0}),n=i.getWrapperElement();n.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";i.refresh();return{getCodeMirror:function(){return i},setContent:function(e){i.setValue(e)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(n);n=null;i=null}}}};UE.plugins["source"]=function(){function t(t){return e["codemirror"==d.sourceEditor&&window.CodeMirror?"codemirror":"textarea"](l,t)}var i,n,o,r,s,a,l=this,d=this.options,c=!1;d.sourceEditor=browser.ie?"textarea":d.sourceEditor||"codemirror";l.setOpt({sourceEditorFirst:!1});l.commands["source"]={execCommand:function(){var e,a,d,u,m;c=!c;if(c){s=l.selection.getRange().createAddress(!1,!0);l.undoManger&&l.undoManger.save(!0);browser.gecko&&(l.body.contentEditable=!1);o=l.iframe.style.cssText;l.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";l.fireEvent("beforegetcontent");e=UE.htmlparser(l.body.innerHTML);l.filterOutputRule(e);e.traversal(function(e){if("element"==e.type)switch(e.tagName){case"td":case"th":case"caption":e.children&&1==e.children.length&&"br"==e.firstChild().tagName&&e.removeChild(e.firstChild());break;case"pre":e.innerText(e.innerText().replace(/&nbsp;/g," "))}});l.fireEvent("aftergetcontent");a=e.toHtml(!0);i=t(l.iframe.parentNode);i.setContent(a);n=l.setContent;l.setContent=function(e){var t=UE.htmlparser(e);l.filterInputRule(t);e=t.toHtml();i.setContent(e)};setTimeout(function(){i.select();l.addListener("fullscreenchanged",function(){try{i.getCodeMirror().refresh()}catch(e){}})});r=l.getContent;l.getContent=function(){return i.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>"}}else{l.iframe.style.cssText=o;d=i.getContent()||"<p>"+(browser.ie?"":"<br/>")+"</p>";d=d.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(e,t){return t&&!dtd.$inlineWithA[t.toLowerCase()]?e.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,""):e.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,"")});l.setContent=n;l.setContent(d);i.dispose();i=null;l.getContent=r;u=l.body.firstChild;if(!u){l.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";u=l.body.firstChild}l.undoManger&&l.undoManger.save(!0);if(browser.gecko){m=document.createElement("input");m.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(m);l.body.contentEditable=!1;setTimeout(function(){domUtils.setViewportOffset(m,{left:-32768,top:0});m.focus();setTimeout(function(){l.body.contentEditable=!0;l.selection.getRange().moveToAddress(s).select(!0);domUtils.remove(m)})})}else try{l.selection.getRange().moveToAddress(s).select(!0)}catch(e){}}this.fireEvent("sourcemodechanged",c)},queryCommandState:function(){return 0|c},notNeedUndo:1};a=l.queryCommandState;l.queryCommandState=function(e){e=e.toLowerCase();return c?e in{source:1,fullscreen:1}?1:-1:a.apply(this,arguments)};"codemirror"==d.sourceEditor&&l.addListener("ready",function(){utils.loadFile(document,{src:d.codeMirrorJsUrl||d.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){d.sourceEditorFirst&&setTimeout(function(){l.execCommand("source")},0)});utils.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:d.codeMirrorCssUrl||d.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}}();UE.plugins["enterkey"]=function(){var e,t=this,i=t.options.enterTag;t.addListener("keyup",function(i,n){var o,r,s,a,l,d,c,u=n.keyCode||n.which;if(13==u){o=t.selection.getRange(),r=o.startContainer;if(browser.ie)t.fireEvent("saveScene",!0,!0);else{if(/h\d/i.test(e)){if(browser.gecko){a=domUtils.findParentByTagName(r,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);if(!a){t.document.execCommand("formatBlock",!1,"<p>");s=1}}else if(1==r.nodeType){l=t.document.createTextNode("");o.insertNode(l);d=domUtils.findParentByTagName(l,"div",!0);if(d){c=t.document.createElement("p");for(;d.firstChild;)c.appendChild(d.firstChild);d.parentNode.insertBefore(c,d);domUtils.remove(d);o.setStartBefore(l).setCursor();s=1}domUtils.remove(l)}t.undoManger&&s&&t.undoManger.save()}browser.opera&&o.select()}}});t.addListener("keydown",function(n,o){var r,s,a,l,d,c,u,m=o.keyCode||o.which;if(13==m){if(t.fireEvent("beforeenterkeydown")){domUtils.preventDefault(o);return}t.fireEvent("saveScene",!0,!0);e="";r=t.selection.getRange();if(!r.collapsed){s=r.startContainer,a=r.endContainer,l=domUtils.findParentByTagName(s,"td",!0),d=domUtils.findParentByTagName(a,"td",!0);if(l&&d&&l!==d||!l&&d||l&&!d){o.preventDefault?o.preventDefault():o.returnValue=!1;return}}if("p"==i){if(!browser.ie){s=domUtils.findParentByTagName(r.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0);if(s||browser.opera){e=s.tagName;"p"==s.tagName.toLowerCase()&&browser.gecko&&domUtils.removeDirtyAttr(s)}else{t.document.execCommand("formatBlock",!1,"<p>");if(browser.gecko){r=t.selection.getRange();s=domUtils.findParentByTagName(r.startContainer,"p",!0);s&&domUtils.removeDirtyAttr(s)}}}}else{o.preventDefault?o.preventDefault():o.returnValue=!1;if(r.collapsed){c=r.document.createElement("br");r.insertNode(c);u=c.parentNode;if(u.lastChild===c){c.parentNode.insertBefore(c.cloneNode(!0),c);r.setStartBefore(c)}else r.setStartAfter(c);r.setCursor()}else{r.deleteContents();s=r.startContainer;if(1==s.nodeType&&(s=s.childNodes[r.startOffset])){for(;1==s.nodeType;){if(dtd.$empty[s.tagName]){r.setStartBefore(s).setCursor();t.undoManger&&t.undoManger.save();return!1}if(!s.firstChild){c=r.document.createElement("br");s.appendChild(c);r.setStart(s,0).setCursor();t.undoManger&&t.undoManger.save();return!1}s=s.firstChild}if(s===r.startContainer.childNodes[r.startOffset]){c=r.document.createElement("br");r.insertNode(c).setCursor()}else r.setStart(s,0).setCursor()}else{c=r.document.createElement("br");r.insertNode(c).setStartAfter(c).setCursor()}}}}})};UE.plugins["keystrokes"]=function(){var e=this,t=!0;e.addListener("keydown",function(i,n){var o,r,s,a,l,d,c,u,m,f,h,p,g,b,y,v=n.keyCode||n.which,C=e.selection.getRange();if(!C.collapsed&&!(n.ctrlKey||n.shiftKey||n.altKey||n.metaKey)&&(v>=65&&v<=90||v>=48&&v<=57||v>=96&&v<=111||{13:1,8:1,46:1}[v])){o=C.startContainer;domUtils.isFillChar(o)&&C.setStartBefore(o);o=C.endContainer;domUtils.isFillChar(o)&&C.setEndAfter(o);C.txtToElmBoundary();if(C.endContainer&&1==C.endContainer.nodeType){o=C.endContainer.childNodes[C.endOffset];o&&domUtils.isBr(o)&&C.setEndAfter(o)}if(0==C.startOffset){o=C.startContainer;if(domUtils.isBoundaryNode(o,"firstChild")){o=C.endContainer;if(C.endOffset==(3==o.nodeType?o.nodeValue.length:o.childNodes.length)&&domUtils.isBoundaryNode(o,"lastChild")){e.fireEvent("saveScene");e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>";C.setStart(e.body.firstChild,0).setCursor(!1,!0);e._selectionChange();return}}}}if(v==keymap.Backspace){C=e.selection.getRange();t=C.collapsed;if(e.fireEvent("delkeydown",n))return;if(C.collapsed&&C.inFillChar()){r=C.startContainer;if(domUtils.isFillChar(r)){C.setStartBefore(r).shrinkBoundary(!0).collapse(!0);domUtils.remove(r)}else{r.nodeValue=r.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"");C.startOffset--;C.collapse(!0).select(!0)}}if(r=C.getClosedNode()){e.fireEvent("saveScene");C.setStartBefore(r);domUtils.remove(r);C.setCursor();e.fireEvent("saveScene");domUtils.preventDefault(n);return}if(!browser.ie){r=domUtils.findParentByTagName(C.startContainer,"table",!0);s=domUtils.findParentByTagName(C.endContainer,"table",!0);if(r&&!s||!r&&s||r!==s){n.preventDefault();return}}}if(v==keymap.Tab){a={ol:1,ul:1,table:1};if(e.fireEvent("tabkeydown",n)){domUtils.preventDefault(n);return}l=e.selection.getRange();e.fireEvent("saveScene");for(d=0,c="",u=e.options.tabSize||4,m=e.options.tabNode||"&nbsp;";d<u;d++)c+=m;f=e.document.createElement("span");f.innerHTML=c+domUtils.fillChar;if(l.collapsed)l.insertNode(f.cloneNode(!0).firstChild).setCursor(!0);else{h=function(e){return domUtils.isBlockElm(e)&&!a[e.tagName.toLowerCase()]};r=domUtils.findParent(l.startContainer,h,!0);s=domUtils.findParent(l.endContainer,h,!0);if(r&&s&&r===s){l.deleteContents();l.insertNode(f.cloneNode(!0).firstChild).setCursor(!0)}else{p=l.createBookmark();l.enlarge(!0);g=l.createBookmark(),b=domUtils.getNextDomNode(g.start,!1,h);for(;b&&!(domUtils.getPosition(b,g.end)&domUtils.POSITION_FOLLOWING);){b.insertBefore(f.cloneNode(!0).firstChild,b.firstChild);b=domUtils.getNextDomNode(b,!1,h)}l.moveToBookmark(g).moveToBookmark(p).select()}}domUtils.preventDefault(n)}if(browser.gecko&&46==v){l=e.selection.getRange();if(l.collapsed){r=l.startContainer;if(domUtils.isEmptyBlock(r)){y=r.parentNode;for(;1==domUtils.getChildCount(y)&&!domUtils.isBody(y);){r=y;y=y.parentNode}r===y.lastChild&&n.preventDefault();return}}}});e.addListener("keyup",function(e,i){var n,o,r,s,a,l,d=i.keyCode||i.which,c=this;if(d==keymap.Backspace){if(c.fireEvent("delkeyup"))return;n=c.selection.getRange();if(n.collapsed){r=["h1","h2","h3","h4","h5","h6"];if((o=domUtils.findParentByTagName(n.startContainer,r,!0))&&domUtils.isEmptyBlock(o)){s=o.previousSibling;if(s&&"TABLE"!=s.nodeName){domUtils.remove(o);n.setStartAtLast(s).setCursor(!1,!0);return}a=o.nextSibling;if(a&&"TABLE"!=a.nodeName){domUtils.remove(o);n.setStartAtFirst(a).setCursor(!1,!0);return}}if(domUtils.isBody(n.startContainer)){o=domUtils.createElement(c.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});n.insertNode(o).setStart(o,0).setCursor(!1,!0)}}if(!t&&(3==n.startContainer.nodeType||1==n.startContainer.nodeType&&domUtils.isEmptyBlock(n.startContainer)))if(browser.ie){l=n.document.createElement("span");n.insertNode(l).setStartBefore(l).collapse(!0);n.select();domUtils.remove(l)}else n.select()}})};UE.plugins["fiximgclick"]=function(){function e(){this.editor=null;this.resizer=null;this.cover=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0}}var t=!1;!function(){var n=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];e.prototype={init:function(e){var t,n,o,r=this;r.editor=e;r.startPos=this.prePos={x:0,y:0};r.dragId=-1;t=[],n=r.cover=document.createElement("div"),o=r.resizer=document.createElement("div");n.id=r.editor.ui.id+"_imagescale_cover";n.style.cssText="position:absolute;display:none;z-index:"+r.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";domUtils.on(n,"mousedown click",function(){r.hide()});for(i=0;i<8;i++)t.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');o.id=r.editor.ui.id+"_imagescale";o.className="edui-editor-imagescale";o.innerHTML=t.join("");o.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+r.editor.options.zIndex+";";r.editor.ui.getDom().appendChild(n);r.editor.ui.getDom().appendChild(o);r.initStyle();r.initEvents()},initStyle:function(){utils.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},initEvents:function(){var e=this;e.startPos.x=e.startPos.y=0;e.isDraging=!1},_eventHandler:function(e){var i,n=this;switch(e.type){case"mousedown":i=e.target||e.srcElement;if(i.className.indexOf("edui-editor-imagescale-hand")!=-1&&n.dragId==-1){n.dragId=i.className.slice(-1);n.startPos.x=n.prePos.x=e.clientX;n.startPos.y=n.prePos.y=e.clientY;domUtils.on(n.doc,"mousemove",n.proxy(n._eventHandler,n))}break;case"mousemove":if(n.dragId!=-1){n.updateContainerStyle(n.dragId,{x:e.clientX-n.prePos.x,y:e.clientY-n.prePos.y});n.prePos.x=e.clientX;n.prePos.y=e.clientY;t=!0;n.updateTargetElement()}break;case"mouseup":if(n.dragId!=-1){n.updateContainerStyle(n.dragId,{x:e.clientX-n.prePos.x,y:e.clientY-n.prePos.y});n.updateTargetElement();n.target.parentNode&&n.attachTo(n.target);n.dragId=-1}domUtils.un(n.doc,"mousemove",n.proxy(n._eventHandler,n));if(t){t=!1;n.editor.fireEvent("contentchange")}}},updateTargetElement:function(){var e=this;domUtils.setStyles(e.target,{width:e.resizer.style.width,height:e.resizer.style.height});e.target.width=parseInt(e.resizer.style.width);e.target.height=parseInt(e.resizer.style.height);e.attachTo(e.target)},updateContainerStyle:function(e,t){var i,o=this,r=o.resizer;if(0!=n[e][0]){i=parseInt(r.style.left)+t.x;r.style.left=o._validScaledProp("left",i)+"px"}if(0!=n[e][1]){i=parseInt(r.style.top)+t.y;r.style.top=o._validScaledProp("top",i)+"px"}if(0!=n[e][2]){i=r.clientWidth+n[e][2]*t.x;r.style.width=o._validScaledProp("width",i)+"px"}if(0!=n[e][3]){i=r.clientHeight+n[e][3]*t.y;r.style.height=o._validScaledProp("height",i)+"px"}},_validScaledProp:function(e,t){var i=this.resizer,n=document;t=isNaN(t)?0:t;switch(e){case"left":return t<0?0:t+i.clientWidth>n.clientWidth?n.clientWidth-i.clientWidth:t;case"top":return t<0?0:t+i.clientHeight>n.clientHeight?n.clientHeight-i.clientHeight:t;case"width":return t<=0?1:t+i.offsetLeft>n.clientWidth?n.clientWidth-i.offsetLeft:t;case"height":return t<=0?1:t+i.offsetTop>n.clientHeight?n.clientHeight-i.offsetTop:t}},hideCover:function(){this.cover.style.display="none"},showCover:function(){var e=this,t=domUtils.getXY(e.editor.ui.getDom()),i=domUtils.getXY(e.editor.iframe);domUtils.setStyles(e.cover,{width:e.editor.iframe.offsetWidth+"px",height:e.editor.iframe.offsetHeight+"px",top:i.y-t.y+"px",left:i.x-t.x+"px",position:"absolute",display:""})},show:function(e){var t=this;t.resizer.style.display="block";e&&t.attachTo(e);domUtils.on(this.resizer,"mousedown",t.proxy(t._eventHandler,t));domUtils.on(t.doc,"mouseup",t.proxy(t._eventHandler,t));t.showCover();t.editor.fireEvent("afterscaleshow",t);t.editor.fireEvent("saveScene")},hide:function(){var e=this;e.hideCover();e.resizer.style.display="none";domUtils.un(e.resizer,"mousedown",e.proxy(e._eventHandler,e));domUtils.un(e.doc,"mouseup",e.proxy(e._eventHandler,e));e.editor.fireEvent("afterscalehide",e)},proxy:function(e,t){return function(i){return e.apply(t||this,arguments)}},attachTo:function(e){var t=this,i=t.target=e,n=this.resizer,o=domUtils.getXY(i),r=domUtils.getXY(t.editor.iframe),s=domUtils.getXY(n.parentNode);domUtils.setStyles(n,{width:i.width+"px",height:i.height+"px",left:r.x+o.x-t.editor.document.body.scrollLeft-s.x-parseInt(n.style.borderLeftWidth)+"px",top:r.y+o.y-t.editor.document.body.scrollTop-s.y-parseInt(n.style.borderTopWidth)+"px"})}}}();return function(){var t,i=this;i.setOpt("imageScaleEnabled",!0);!browser.ie&&i.options.imageScaleEnabled&&i.addListener("click",function(n,o){var r,s,a,l=i.selection.getRange(),d=l.getClosedNode();if(d&&"IMG"==d.tagName&&"false"!=i.body.contentEditable){if(d.className.indexOf("edui-faked-music")!=-1||d.getAttribute("anchorname")||domUtils.hasClass(d,"loadingclass")||domUtils.hasClass(d,"loaderrorclass"))return;if(!t){t=new e;t.init(i);i.ui.getDom().appendChild(t.resizer);r=function(e){t.hide();t.target&&i.selection.getRange().selectNode(t.target).select()},s=function(e){var t=e.target||e.srcElement;!t||void 0!==t.className&&t.className.indexOf("edui-editor-imagescale")!=-1||r(e)};i.addListener("afterscaleshow",function(e){i.addListener("beforekeydown",r);i.addListener("beforemousedown",s);domUtils.on(document,"keydown",r);domUtils.on(document,"mousedown",s);i.selection.getNative().removeAllRanges()});i.addListener("afterscalehide",function(e){i.removeListener("beforekeydown",r);i.removeListener("beforemousedown",s);domUtils.un(document,"keydown",r);domUtils.un(document,"mousedown",s);var n=t.target;n.parentNode&&i.selection.getRange().selectNode(n).select()});domUtils.on(t.resizer,"mousedown",function(e){i.selection.getNative().removeAllRanges();var n=e.target||e.srcElement;n&&n.className.indexOf("edui-editor-imagescale-hand")==-1&&(a=setTimeout(function(){t.hide();t.target&&i.selection.getRange().selectNode(n).select()},200))});domUtils.on(t.resizer,"mouseup",function(e){var t=e.target||e.srcElement;t&&t.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(a)})}t.show(d)}else t&&"none"!=t.resizer.style.display&&t.hide()});browser.webkit&&i.addListener("click",function(e,t){if("IMG"==t.target.tagName&&"false"!=i.body.contentEditable){var n=new dom.Range(i.document);n.selectNode(t.target).select()}})}}();UE.plugin.register("autolink",function(){var e=0;return browser.ie?{}:{bindEvents:{reset:function(){e=0},keydown:function(e,t){var i,n,o,r,s,a,l,d,c=this,u=t.keyCode||t.which;if(32==u||13==u){i=c.selection.getNative(),n=i.getRangeAt(0).cloneRange();s=n.startContainer;for(;1==s.nodeType&&n.startOffset>0;){s=n.startContainer.childNodes[n.startOffset-1];if(!s)break;n.setStart(s,1==s.nodeType?s.childNodes.length:s.nodeValue.length);n.collapse(!0);s=n.startContainer}do{if(0==n.startOffset){s=n.startContainer.previousSibling;for(;s&&1==s.nodeType;)s=s.lastChild;if(!s||domUtils.isFillChar(s))break;o=s.nodeValue.length}else{s=n.startContainer;o=n.startOffset}n.setStart(s,o-1);r=n.toString().charCodeAt(0)}while(160!=r&&32!=r);if(n.toString().replace(new RegExp(domUtils.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;n.toString().length&&!/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(n.toString());)try{n.setStart(n.startContainer,n.startOffset+1)}catch(e){s=n.startContainer;for(;!(next=s.nextSibling);){if(domUtils.isBody(s))return;s=s.parentNode}n.setStart(next,0)}if(domUtils.findParentByTagName(n.startContainer,"a",!0))return;a=c.document.createElement("a"),l=c.document.createTextNode(" ");c.undoManger&&c.undoManger.save();a.appendChild(n.extractContents());a.href=a.innerHTML=a.innerHTML.replace(/<[^>]+>/g,"");d=a.getAttribute("href").replace(new RegExp(domUtils.fillChar,"g"),"");d=/^(?:https?:\/\/)/gi.test(d)?d:"http://"+d;a.setAttribute("_src",utils.html(d));a.href=utils.html(d);n.insertNode(a);a.parentNode.insertBefore(l,a.nextSibling);n.setStart(l,0);n.collapse(!0);i.removeAllRanges();i.addRange(n);c.undoManger&&c.undoManger.save()}}}}}},function(){function e(e){if(3==e.nodeType)return null;if("A"==e.nodeName)return e;for(var t=e.lastChild;t;){if("A"==t.nodeName)return t;if(3==t.nodeType){if(domUtils.isWhitespace(t)){t=t.previousSibling;continue}return null}t=t.lastChild}}var t={37:1,38:1,39:1,40:1,13:1,32:1};browser.ie&&this.addListener("keyup",function(i,n){var o,r,s,a,l=this,d=n.keyCode;if(t[d]){o=l.selection.getRange();r=o.startContainer;if(13==d){for(;r&&!domUtils.isBody(r)&&!domUtils.isBlockElm(r);)r=r.parentNode;if(r&&!domUtils.isBody(r)&&"P"==r.nodeName){s=r.previousSibling;if(s&&1==s.nodeType){s=e(s);s&&!s.getAttribute("_href")&&domUtils.remove(s,!0)}}}else if(32==d){if(3==r.nodeType&&/^\s$/.test(r.nodeValue)){r=r.previousSibling;r&&"A"==r.nodeName&&!r.getAttribute("_href")&&domUtils.remove(r,!0)}}else{r=domUtils.findParentByTagName(r,"a",!0);if(r&&!r.getAttribute("_href")){a=o.createBookmark();domUtils.remove(r,!0);o.moveToBookmark(a).select(!0)}}}})});UE.plugins["autoheight"]=function(){function e(){var e=this;clearTimeout(r);s||(!e.queryCommandState||e.queryCommandState&&1!=e.queryCommandState("source"))&&(r=setTimeout(function(){for(var t=e.body.lastChild;t&&1!=t.nodeType;)t=t.previousSibling;if(t&&1==t.nodeType){t.style.clear="both";o=Math.max(domUtils.getXY(t).y+t.offsetHeight+25,Math.max(n.minFrameHeight,n.initialFrameHeight));if(o!=i){o!==parseInt(e.iframe.parentNode.style.height)&&(e.iframe.parentNode.style.height=o+"px");e.body.style.height=o+"px";i=o}domUtils.removeStyle(t,"clear")}},50))}var t,i,n,o,r,s,a=this;a.autoHeightEnabled=a.options.autoHeightEnabled!==!1;if(a.autoHeightEnabled){i=0,n=a.options;a.addListener("fullscreenchanged",function(e,t){s=t});a.addListener("destroy",function(){a.removeListener("contentchange afterinserthtml keyup mouseup",e)});a.enableAutoHeight=function(){var i,n=this;if(n.autoHeightEnabled){i=n.document;n.autoHeightEnabled=!0;t=i.body.style.overflowY;i.body.style.overflowY="hidden";n.addListener("contentchange afterinserthtml keyup mouseup",e);setTimeout(function(){e.call(n)},browser.gecko?100:0);n.fireEvent("autoheightchanged",n.autoHeightEnabled)}};a.disableAutoHeight=function(){a.body.style.overflowY=t||"";a.removeListener("contentchange",e);a.removeListener("keyup",e);a.removeListener("mouseup",e);a.autoHeightEnabled=!1;
a.fireEvent("autoheightchanged",a.autoHeightEnabled)};a.on("setHeight",function(){a.disableAutoHeight()});a.addListener("ready",function(){var t,i;a.enableAutoHeight();domUtils.on(browser.ie?a.body:a.document,browser.webkit?"dragover":"drop",function(){clearTimeout(t);t=setTimeout(function(){e.call(a)},100)});window.onscroll=function(){if(null===i)i=this.scrollY;else if(0==this.scrollY&&0!=i){a.window.scrollTo(0,0);i=null}}})}};UE.plugins["autofloat"]=function(){function e(){if(!UE.ui){alert(y.autofloatMsg);return 0}return 1}function t(){var e=document.body.style;e.backgroundImage='url("about:blank")';e.backgroundAttachment="fixed"}function i(){var e=domUtils.getXY(m),t=domUtils.getComputedStyle(m,"position"),i=domUtils.getComputedStyle(m,"left");m.style.width=m.offsetWidth+"px";m.style.zIndex=1*b.options.zIndex+1;m.parentNode.insertBefore(u,m);if(l||d&&browser.ie){"absolute"!=m.style.position&&(m.style.position="absolute");m.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-f+s+"px"}else{if(browser.ie7Compat&&p){p=!1;m.style.left=domUtils.getXY(m).x-document.documentElement.getBoundingClientRect().left+2+"px"}if("fixed"!=m.style.position){m.style.position="fixed";m.style.top=s+"px";("absolute"==t||"relative"==t)&&parseFloat(i)&&(m.style.left=e.x+"px")}}}function n(){p=!0;u.parentNode&&u.parentNode.removeChild(u);m.style.cssText=c}function o(){var e=h(b.container),t=b.options.toolbarTopOffset||0;e.top<0&&e.bottom-m.offsetHeight>t?i():n()}var r,s,a,l,d,c,u,m,f,h,p,g,b=this,y=b.getLang();b.setOpt({topOffset:0});r=b.options.autoFloatEnabled!==!1,s=b.options.topOffset;if(r){a=UE.ui.uiUtils,l=browser.ie&&browser.version<=6,d=browser.quirks;u=document.createElement("div"),p=!0;g=utils.defer(function(){o()},browser.ie?200:100,!0);b.addListener("destroy",function(){domUtils.un(window,["scroll","resize"],o);b.removeListener("keydown",g)});b.addListener("ready",function(){if(e(b)){if(!b.ui)return;h=a.getClientRect;m=b.ui.getDom("toolbarbox");f=h(m).top;c=m.style.cssText;u.style.height=m.offsetHeight+"px";l&&t();domUtils.on(window,["scroll","resize"],o);b.addListener("keydown",g);b.addListener("beforefullscreenchange",function(e,t){t&&n()});b.addListener("fullscreenchanged",function(e,t){t||o()});b.addListener("sourcemodechanged",function(e,t){setTimeout(function(){o()},0)});b.addListener("clearDoc",function(){setTimeout(function(){o()},0)})}})}};UE.plugins["video"]=function(){function e(e,t,n,o,r,s,a){var l,d;e=utils.unhtmlForUrl(e);r=utils.unhtml(r);s=utils.unhtml(s);t=parseInt(t,10)||0;n=parseInt(n,10)||0;switch(a){case"image":l="<img "+(o?'id="'+o+'"':"")+' width="'+t+'" height="'+n+'" _url="'+e+'" class="'+s.replace(/\bvideo-js\b/,"")+'" src="'+i.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+i.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(r?"float:"+r+";":"")+'" />';break;case"embed":l='<embed type="application/x-shockwave-flash" class="'+s+'" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+utils.html(e)+'" width="'+t+'" height="'+n+'"'+(r?' style="float:'+r+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >';break;case"video":d=e.substr(e.lastIndexOf(".")+1);"ogv"==d&&(d="ogg");l="<video"+(o?' id="'+o+'"':"")+' class="'+s+' video-js" '+(r?' style="float:'+r+'"':"")+' controls preload="none" width="'+t+'" height="'+n+'" src="'+e+'" data-setup="{}"><source src="'+e+'" type="video/'+d+'" /></video>'}return l}function t(t,i){utils.each(t.getNodesByTagName(i?"img":"embed video"),function(t){var n,o=t.getAttr("class");if(o&&o.indexOf("edui-faked-video")!=-1){n=e(i?t.getAttr("_url"):t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),null,t.getStyle("float")||"",o,i?"embed":"image");t.parentNode.replaceChild(UE.uNode.createElement(n),t)}if(o&&o.indexOf("edui-upload-video")!=-1){n=e(i?t.getAttr("_url"):t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),null,t.getStyle("float")||"",o,i?"video":"image");t.parentNode.replaceChild(UE.uNode.createElement(n),t)}})}var i=this;i.addOutputRule(function(e){t(e,!0)});i.addInputRule(function(e){t(e)});i.commands["insertvideo"]={execCommand:function(t,n,o){var r,s,a,l,d,c,u,m;n=utils.isArray(n)?n:[n];r=[],s="tmpVedio";for(l=0,c=n.length;l<c;l++){d=n[l];a="upload"==o?"edui-upload-video video-js vjs-default-skin":"edui-faked-video";r.push(e(d.url,d.width||420,d.height||280,s+l,null,a,"image"))}i.execCommand("inserthtml",r.join(""),!0);u=this.selection.getRange();for(l=0,c=n.length;l<c;l++){m=this.document.getElementById("tmpVedio"+l);domUtils.removeAttributes(m,"id");u.selectNode(m).select();i.execCommand("imagefloat",n[l].align)}},queryCommandState:function(){var e=i.selection.getRange().getClosedNode(),t=e&&("edui-faked-video"==e.className||e.className.indexOf("edui-upload-video")!=-1);return t?1:0}}};!function(){function e(e){}var t=UE.UETable=function(e){this.table=e;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(e)};t.removeSelectedClass=function(e){utils.each(e,function(e){domUtils.removeClasses(e,"selectTdClass")})};t.addSelectedClass=function(e){utils.each(e,function(e){domUtils.addClass(e,"selectTdClass")})};t.isEmptyBlock=function(e){var t,i=new RegExp(domUtils.fillChar,"g");if(e[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(i,"").length>0)return 0;for(t in dtd.$isNotEmpty)if(dtd.$isNotEmpty.hasOwnProperty(t)&&e.getElementsByTagName(t).length)return 0;return 1};t.getWidth=function(e){return e?parseInt(domUtils.getComputedStyle(e,"width"),10):0};t.getTableCellAlignState=function(e){!utils.isArray(e)&&(e=[e]);var t={},i=["align","valign"],n=null,o=!0;utils.each(e,function(e){utils.each(i,function(i){n=e.getAttribute(i);if(!t[i]&&n)t[i]=n;else if(!t[i]||n!==t[i]){o=!1;return!1}});return o});return o?t:null};t.getTableItemsByRange=function(e){var t,i,n,o,r=e.selection.getStart();r&&r.id&&0===r.id.indexOf("_baidu_bookmark_start_")&&r.nextSibling&&(r=r.nextSibling);t=r&&domUtils.findParentByTagName(r,["td","th"],!0),i=t&&t.parentNode,n=r&&domUtils.findParentByTagName(r,"caption",!0),o=n?n.parentNode:i&&i.parentNode.parentNode;return{cell:t,tr:i,table:o,caption:n}};t.getUETableBySelected=function(e){var i=t.getTableItemsByRange(e).table;return i&&i.ueTable&&i.ueTable.selectedTds.length?i.ueTable:null};t.getDefaultValue=function(e,t){var i,n,o,r,s,a={thin:"0px",medium:"1px",thick:"2px"};if(t){s=t.getElementsByTagName("td")[0];r=domUtils.getComputedStyle(t,"border-left-width");i=parseInt(a[r]||r,10);r=domUtils.getComputedStyle(s,"padding-left");n=parseInt(a[r]||r,10);r=domUtils.getComputedStyle(s,"border-left-width");o=parseInt(a[r]||r,10);return{tableBorder:i,tdPadding:n,tdBorder:o}}t=e.document.createElement("table");t.insertRow(0).insertCell(0).innerHTML="xxx";e.body.appendChild(t);s=t.getElementsByTagName("td")[0];r=domUtils.getComputedStyle(t,"border-left-width");i=parseInt(a[r]||r,10);r=domUtils.getComputedStyle(s,"padding-left");n=parseInt(a[r]||r,10);r=domUtils.getComputedStyle(s,"border-left-width");o=parseInt(a[r]||r,10);domUtils.remove(t);return{tableBorder:i,tdPadding:n,tdBorder:o}};t.getUETable=function(e){var i=e.tagName.toLowerCase();e="td"==i||"th"==i||"caption"==i?domUtils.findParentByTagName(e,"table",!0):e;e.ueTable||(e.ueTable=new t(e));return e.ueTable};t.cloneCell=function(e,t,i){var n,o;if(!e||utils.isString(e))return this.table.ownerDocument.createElement(e||"td");n=domUtils.hasClass(e,"selectTdClass");n&&domUtils.removeClasses(e,"selectTdClass");o=e.cloneNode(!0);t&&(o.rowSpan=o.colSpan=1);!i&&domUtils.removeAttributes(o,"width height");!i&&domUtils.removeAttributes(o,"style");o.style.borderLeftStyle="";o.style.borderTopStyle="";o.style.borderLeftColor=e.style.borderRightColor;o.style.borderLeftWidth=e.style.borderRightWidth;o.style.borderTopColor=e.style.borderBottomColor;o.style.borderTopWidth=e.style.borderBottomWidth;n&&domUtils.addClass(e,"selectTdClass");return o};t.prototype={getMaxRows:function(){var e,t,i,n,o,r=this.table.rows,s=1;for(e=0;t=r[e];e++){i=1;for(n=0;o=t.cells[n++];)i=Math.max(o.rowSpan||1,i);s=Math.max(i+e,s)}return s},getMaxCols:function(){var e,t,i,n,o,r,s=this.table.rows,a=0,l={};for(e=0;t=s[e];e++){i=0;for(n=0;o=t.cells[n++];){i+=o.colSpan||1;if(o.rowSpan&&o.rowSpan>1)for(r=1;r<o.rowSpan;r++)l["row_"+(e+r)]?l["row_"+(e+r)]++:l["row_"+(e+r)]=o.colSpan||1}i+=l["row_"+e]||0;a=Math.max(i,a)}return a},getCellColIndex:function(e){},getHSideCell:function(t,i){var n,o,r,s,a;try{n=this.getCellInfo(t);s=this.selectedTds.length,a=this.cellsRange;if(!i&&(s?!a.beginColIndex:!n.colIndex)||i&&(s?a.endColIndex==this.colsNum-1:n.colIndex==this.colsNum-1))return null;o=s?a.beginRowIndex:n.rowIndex;r=i?s?a.endColIndex+1:n.colIndex+1:s?a.beginColIndex-1:n.colIndex<1?0:n.colIndex-1;return this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(t){e(t)}},getTabNextCell:function(e,t){var i,n=this.getCellInfo(e),o=t||n.rowIndex,r=n.colIndex+1+(n.colSpan-1);try{i=this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(e){try{o=1*o+1;r=0;i=this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(e){}}return i},getVSideCell:function(t,i,n){var o,r,s,a,l;try{o=this.getCellInfo(t);a=this.selectedTds.length&&!n,l=this.cellsRange;if(!i&&0==o.rowIndex||i&&(a?l.endRowIndex==this.rowsNum-1:o.rowIndex+o.rowSpan>this.rowsNum-1))return null;r=i?a?l.endRowIndex+1:o.rowIndex+o.rowSpan:a?l.beginRowIndex-1:o.rowIndex-1;s=a?l.beginColIndex:o.colIndex;return this.getCell(this.indexTable[r][s].rowIndex,this.indexTable[r][s].cellIndex)}catch(t){e(t)}},getSameEndPosCells:function(t,i){var n,o,r,s,a,l,d,c,u;try{n="x"===i.toLowerCase(),o=domUtils.getXY(t)[n?"x":"y"]+t["offset"+(n?"Width":"Height")],r=this.table.rows,s=null,a=[];for(l=0;l<this.rowsNum;l++){s=r[l].cells;for(d=0;c=s[d++];){u=domUtils.getXY(c)[n?"x":"y"]+c["offset"+(n?"Width":"Height")];if(u>o&&n)break;if(t==c||o==u){1==c[n?"colSpan":"rowSpan"]&&a.push(c);if(n)break}}}return a}catch(t){e(t)}},setCellContent:function(e,t){e.innerHTML=t||(browser.ie?domUtils.fillChar:"<br />")},cloneCell:t.cloneCell,getSameStartPosXCells:function(t){var i,n,o,r,s,a,l,d;try{i=domUtils.getXY(t).x+t.offsetWidth,n=this.table.rows,r=[];for(s=0;s<this.rowsNum;s++){o=n[s].cells;for(a=0;l=o[a++];){d=domUtils.getXY(l).x;if(d>i)break;if(d==i&&1==l.colSpan){r.push(l);break}}}return r}catch(t){e(t)}},update:function(e){var t,i,n,o,r,s,a,l,d,c,u,m,f,h,p,g,b,y,v,C,N,x;this.table=e||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];t=this.table.rows,i=this.getMaxRows(),n=i-t.length,o=this.getMaxCols();for(;n--;)this.table.insertRow(t.length);this.rowsNum=i;this.colsNum=o;for(r=0,s=t.length;r<s;r++)this.indexTable[r]=new Array(o);for(a=0;l=t[a];a++)for(d=0,u=l.cells;c=u[d];d++){c.rowSpan>i&&(c.rowSpan=i);m=d,f=c.rowSpan||1,h=c.colSpan||1;for(;this.indexTable[a][m];)m++;for(p=0;p<f;p++)for(g=0;g<h;g++)this.indexTable[a+p][m+g]={rowIndex:a,cellIndex:d,colIndex:m,rowSpan:f,colSpan:h}}for(p=0;p<i;p++)for(g=0;g<o;g++)if(void 0===this.indexTable[p][g]){l=t[p];c=l.cells[l.cells.length-1];c=c?c.cloneNode(!0):this.table.ownerDocument.createElement("td");this.setCellContent(c);1!==c.colSpan&&(c.colSpan=1);1!==c.rowSpan&&(c.rowSpan=1);l.appendChild(c);this.indexTable[p][g]={rowIndex:p,cellIndex:c.cellIndex,colIndex:g,rowSpan:1,colSpan:1}}b=domUtils.getElementsByTagName(this.table,"td"),y=[];utils.each(b,function(e){domUtils.hasClass(e,"selectTdClass")&&y.push(e)});if(y.length){v=y[0],C=y[y.length-1],N=this.getCellInfo(v),x=this.getCellInfo(C);this.selectedTds=y;this.cellsRange={beginRowIndex:N.rowIndex,beginColIndex:N.colIndex,endRowIndex:x.rowIndex+x.rowSpan-1,endColIndex:x.colIndex+x.colSpan-1}}if(!domUtils.hasClass(this.table.rows[0],"firstRow")){domUtils.addClass(this.table.rows[0],"firstRow");for(r=1;r<this.table.rows.length;r++)domUtils.removeClasses(this.table.rows[r],"firstRow")}},getCellInfo:function(e){var t,i,n,o,r,s;if(e){t=e.cellIndex,i=e.parentNode.rowIndex,n=this.indexTable[i],o=this.colsNum;for(r=t;r<o;r++){s=n[r];if(s.rowIndex===i&&s.cellIndex===t)return s}}},getCell:function(e,t){return e<this.rowsNum&&this.table.rows[e].cells[t]||null},deleteCell:function(e,t){t="number"==typeof t?t:e.parentNode.rowIndex;var i=this.table.rows[t];i.deleteCell(e.cellIndex)},getCellsRange:function(e,t){function i(e,t,o,r){var s,a,l,d=e,c=t,u=o,m=r;if(e>0)for(a=t;a<r;a++){s=n.indexTable[e][a];l=s.rowIndex;l<e&&(d=Math.min(l,d))}if(r<n.colsNum)for(l=e;l<o;l++){s=n.indexTable[l][r];a=s.colIndex+s.colSpan-1;a>r&&(m=Math.max(a,m))}if(o<n.rowsNum)for(a=t;a<r;a++){s=n.indexTable[o][a];l=s.rowIndex+s.rowSpan-1;l>o&&(u=Math.max(l,u))}if(t>0)for(l=e;l<o;l++){s=n.indexTable[l][t];a=s.colIndex;a<t&&(c=Math.min(s.colIndex,c))}return d!=e||c!=t||u!=o||m!=r?i(d,c,u,m):{beginRowIndex:e,beginColIndex:t,endRowIndex:o,endColIndex:r}}var n,o,r,s,a,l,d;try{n=this,o=n.getCellInfo(e);if(e===t)return{beginRowIndex:o.rowIndex,beginColIndex:o.colIndex,endRowIndex:o.rowIndex+o.rowSpan-1,endColIndex:o.colIndex+o.colSpan-1};r=n.getCellInfo(t);s=Math.min(o.rowIndex,r.rowIndex),a=Math.min(o.colIndex,r.colIndex),l=Math.max(o.rowIndex+o.rowSpan-1,r.rowIndex+r.rowSpan-1),d=Math.max(o.colIndex+o.colSpan-1,r.colIndex+r.colSpan-1);return i(s,a,l,d)}catch(e){}},getCells:function(e){var t,i,n,o,r,s,a,l,d,c,u,m;this.clearSelected();t=e.beginRowIndex,i=e.beginColIndex,n=e.endRowIndex,o=e.endColIndex,l={},d=[];for(c=t;c<=n;c++)for(u=i;u<=o;u++){r=this.indexTable[c][u];s=r.rowIndex;a=r.colIndex;m=s+"|"+a;if(!l[m]){l[m]=1;if(s<c||a<u||s+r.rowSpan-1>n||a+r.colSpan-1>o)return null;d.push(this.getCell(s,r.cellIndex))}}return d},clearSelected:function(){t.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(e){var i=this.getCells(e);t.addSelectedClass(i);this.selectedTds=i;this.cellsRange=e},isFullRow:function(){var e=this.cellsRange;return e.endColIndex-e.beginColIndex+1==this.colsNum},isFullCol:function(){var e=this.cellsRange,t=this.table,i=t.getElementsByTagName("th"),n=e.endRowIndex-e.beginRowIndex+1;return i.length?n==this.rowsNum||n==this.rowsNum-1:n==this.rowsNum},getNextCell:function(t,i,n){var o,r,s,a,l;try{o=this.getCellInfo(t);a=this.selectedTds.length&&!n,l=this.cellsRange;if(!i&&0==o.rowIndex||i&&(a?l.endRowIndex==this.rowsNum-1:o.rowIndex+o.rowSpan>this.rowsNum-1))return null;r=i?a?l.endRowIndex+1:o.rowIndex+o.rowSpan:a?l.beginRowIndex-1:o.rowIndex-1;s=a?l.beginColIndex:o.colIndex;return this.getCell(this.indexTable[r][s].rowIndex,this.indexTable[r][s].cellIndex)}catch(t){e(t)}},getPreviewCell:function(t,i){var n,o,r,s,a;try{n=this.getCellInfo(t);s=this.selectedTds.length,a=this.cellsRange;if(!i&&(s?!a.beginColIndex:!n.colIndex)||i&&(s?a.endColIndex==this.colsNum-1:n.rowIndex>this.colsNum-1))return null;o=i?s?a.beginRowIndex:n.rowIndex<1?0:n.rowIndex-1:s?a.beginRowIndex:n.rowIndex;r=i?s?a.endColIndex+1:n.colIndex:s?a.beginColIndex-1:n.colIndex<1?0:n.colIndex-1;return this.getCell(this.indexTable[o][r].rowIndex,this.indexTable[o][r].cellIndex)}catch(t){e(t)}},moveContent:function(e,i){if(!t.isEmptyBlock(i))if(t.isEmptyBlock(e))e.innerHTML=i.innerHTML;else{var n=e.lastChild;3!=n.nodeType&&dtd.$block[n.tagName]||e.appendChild(e.ownerDocument.createElement("br"));for(;n=i.firstChild;)e.appendChild(n)}},mergeRight:function(e){var t=this.getCellInfo(e),i=t.colIndex+t.colSpan,n=this.indexTable[t.rowIndex][i],o=this.getCell(n.rowIndex,n.cellIndex);e.colSpan=t.colSpan+n.colSpan;e.removeAttribute("width");this.moveContent(e,o);this.deleteCell(o,n.rowIndex);this.update()},mergeDown:function(e){var t=this.getCellInfo(e),i=t.rowIndex+t.rowSpan,n=this.indexTable[i][t.colIndex],o=this.getCell(n.rowIndex,n.cellIndex);e.rowSpan=t.rowSpan+n.rowSpan;e.removeAttribute("height");this.moveContent(e,o);this.deleteCell(o,n.rowIndex);this.update()},mergeRange:function(){var e,t,i,n,o,r,s,a,l,d=this.cellsRange,c=this.getCell(d.beginRowIndex,this.indexTable[d.beginRowIndex][d.beginColIndex].cellIndex);if("TH"==c.tagName&&d.endRowIndex!==d.beginRowIndex){e=this.indexTable,t=this.getCellInfo(c);c=this.getCell(1,e[1][t.colIndex].cellIndex);d=this.getCellsRange(c,this.getCell(e[this.rowsNum-1][t.colIndex].rowIndex,e[this.rowsNum-1][t.colIndex].cellIndex))}i=this.getCells(d);for(n=0;o=i[n++];)if(o!==c){this.moveContent(c,o);this.deleteCell(o)}c.rowSpan=d.endRowIndex-d.beginRowIndex+1;c.rowSpan>1&&c.removeAttribute("height");c.colSpan=d.endColIndex-d.beginColIndex+1;c.colSpan>1&&c.removeAttribute("width");c.rowSpan==this.rowsNum&&1!=c.colSpan&&(c.colSpan=1);if(c.colSpan==this.colsNum&&1!=c.rowSpan){r=c.parentNode.rowIndex;if(this.table.deleteRow)for(n=r+1,s=r+1,a=c.rowSpan;n<a;n++)this.table.deleteRow(s);else for(n=0,a=c.rowSpan-1;n<a;n++){l=this.table.rows[r+1];l.parentNode.removeChild(l)}c.rowSpan=1}this.update()},insertRow:function(e,t){function i(e,t,i){var n,o,r;if(0==e){n=i.nextSibling||i.previousSibling,o=n.cells[e];if("TH"==o.tagName){o=t.ownerDocument.createElement("th");o.appendChild(t.firstChild);i.insertBefore(o,t);domUtils.remove(t)}}else if("TH"==t.tagName){r=t.ownerDocument.createElement("td");r.appendChild(t.firstChild);i.insertBefore(r,t);domUtils.remove(t)}}var n,o,r,s,a,l=this.colsNum,d=this.table,c=d.insertRow(e),u="string"==typeof t&&"TH"==t.toUpperCase();if(0==e||e==this.rowsNum)for(o=0;o<l;o++){n=this.cloneCell(t,!0);this.setCellContent(n);n.getAttribute("vAlign")&&n.setAttribute("vAlign",n.getAttribute("vAlign"));c.appendChild(n);u||i(o,n,c)}else{r=this.indexTable[e],s=0;for(o=0;o<l;o++){a=r[o];if(a.rowIndex<e){n=this.getCell(a.rowIndex,a.cellIndex);n.rowSpan=a.rowSpan+1}else{n=this.cloneCell(t,!0);this.setCellContent(n);c.appendChild(n)}u||i(o,n,c)}}this.update();return c},deleteRow:function(e){var t,i,n,o,r,s,a,l,d,c,u,m,f,h,p=this.table.rows[e],g=this.indexTable[e],b=this.colsNum,y=0;for(t=0;t<b;){i=g[t],n=this.getCell(i.rowIndex,i.cellIndex);if(n.rowSpan>1&&i.rowIndex==e){o=n.cloneNode(!0);o.rowSpan=n.rowSpan-1;o.innerHTML="";n.rowSpan=1;r=e+1,s=this.table.rows[r],l=this.getPreviewMergedCellsNum(r,t)-y;if(l<t){a=t-l-1;domUtils.insertAfter(s.cells[a],o)}else s.cells.length&&s.insertBefore(o,s.cells[0]);y+=1}t+=n.colSpan||1}d=[],c={};for(t=0;t<b;t++){u=g[t].rowIndex,m=g[t].cellIndex,f=u+"_"+m;if(!c[f]){c[f]=1;n=this.getCell(u,m);d.push(n)}}h=[];utils.each(d,function(e){1==e.rowSpan?e.parentNode.removeChild(e):h.push(e)});utils.each(h,function(e){e.rowSpan--});p.parentNode.removeChild(p);this.update()},insertCol:function(e,t,i){function n(e,t,i){var n,o;if(0==e){n=t.nextSibling||t.previousSibling;if("TH"==n.tagName){n=t.ownerDocument.createElement("th");n.appendChild(t.firstChild);i.insertBefore(n,t);domUtils.remove(t)}}else if("TH"==t.tagName){o=t.ownerDocument.createElement("td");o.appendChild(t.firstChild);i.insertBefore(o,t);domUtils.remove(t)}}var o,r,s,a,l=this.rowsNum,d=0,c=parseInt((this.table.offsetWidth-20*(this.colsNum+1)-(this.colsNum+1))/(this.colsNum+1),10),u="string"==typeof t&&"TH"==t.toUpperCase();if(0==e||e==this.colsNum)for(;d<l;d++){o=this.table.rows[d];s=o.cells[0==e?e:o.cells.length];r=this.cloneCell(t,!0);this.setCellContent(r);r.setAttribute("vAlign",r.getAttribute("vAlign"));s&&r.setAttribute("width",s.getAttribute("width"));e?domUtils.insertAfter(o.cells[o.cells.length-1],r):o.insertBefore(r,o.cells[0]);u||n(d,r,o)}else for(;d<l;d++){a=this.indexTable[d][e];if(a.colIndex<e){r=this.getCell(a.rowIndex,a.cellIndex);r.colSpan=a.colSpan+1}else{o=this.table.rows[d];s=o.cells[a.cellIndex];r=this.cloneCell(t,!0);this.setCellContent(r);r.setAttribute("vAlign",r.getAttribute("vAlign"));s&&r.setAttribute("width",s.getAttribute("width"));s?o.insertBefore(r,s):o.appendChild(r)}u||n(d,r,o)}this.update();this.updateWidth(c,i||{tdPadding:10,tdBorder:1})},updateWidth:function(e,i){var n,o=this.table,r=t.getWidth(o)-2*i.tdPadding-i.tdBorder+e;if(r<o.ownerDocument.body.offsetWidth)o.setAttribute("width",r);else{n=domUtils.getElementsByTagName(this.table,"td th");utils.each(n,function(t){t.setAttribute("width",e)})}},deleteCol:function(e){var t,i,n,o,r,s=this.indexTable,a=this.table.rows,l=this.table.getAttribute("width"),d=0,c=this.rowsNum,u={};for(t=0;t<c;){i=s[t],n=i[e],o=n.rowIndex+"_"+n.colIndex;if(!u[o]){u[o]=1;r=this.getCell(n.rowIndex,n.cellIndex);d||(d=r&&parseInt(r.offsetWidth/r.colSpan,10).toFixed(0));r.colSpan>1?r.colSpan--:a[t].deleteCell(n.cellIndex);t+=n.rowSpan||1}}this.table.setAttribute("width",l-d);this.update()},splitToCells:function(e){var t=this,i=this.splitToRows(e);utils.each(i,function(e){t.splitToCols(e)})},splitToRows:function(e){var t,i,n,o,r=this.getCellInfo(e),s=r.rowIndex,a=r.colIndex,l=[];e.rowSpan=1;l.push(e);for(t=s,i=s+r.rowSpan;t<i;t++)if(t!=s){n=this.table.rows[t],o=n.insertCell(a-this.getPreviewMergedCellsNum(t,a));o.colSpan=r.colSpan;this.setCellContent(o);o.setAttribute("vAlign",e.getAttribute("vAlign"));o.setAttribute("align",e.getAttribute("align"));e.style.cssText&&(o.style.cssText=e.style.cssText);l.push(o)}this.update();return l},getPreviewMergedCellsNum:function(e,t){var i,n,o,r=this.indexTable[e],s=0;for(i=0;i<t;){n=r[i].colSpan,o=r[i].rowIndex;s+=n-(o==e?1:0);i+=n}return s},splitToCols:function(e){var t,i,n,o,r,s=(e.offsetWidth/e.colSpan-22).toFixed(0),a=this.getCellInfo(e),l=a.rowIndex,d=a.colIndex,c=[];e.colSpan=1;e.setAttribute("width",s);c.push(e);for(t=d,i=d+a.colSpan;t<i;t++)if(t!=d){n=this.table.rows[l],o=n.insertCell(this.indexTable[l][t].cellIndex+1);o.rowSpan=a.rowSpan;this.setCellContent(o);o.setAttribute("vAlign",e.getAttribute("vAlign"));o.setAttribute("align",e.getAttribute("align"));o.setAttribute("width",s);e.style.cssText&&(o.style.cssText=e.style.cssText);if("TH"==e.tagName){r=e.ownerDocument.createElement("th");r.appendChild(o.firstChild);r.setAttribute("vAlign",e.getAttribute("vAlign"));r.rowSpan=o.rowSpan;n.insertBefore(r,o);domUtils.remove(o)}c.push(o)}this.update();return c},isLastCell:function(e,t,i){t=t||this.rowsNum;i=i||this.colsNum;var n=this.getCellInfo(e);return n.rowIndex+n.rowSpan==t&&n.colIndex+n.colSpan==i},getLastCell:function(e){var t,i,n,o,r,s,a;e=e||this.table.getElementsByTagName("td");t=this.getCellInfo(e[0]);i=this,n=e[0],o=n.parentNode,r=0,s=0;utils.each(e,function(e){e.parentNode==o&&(s+=e.colSpan||1);r+=e.rowSpan*e.colSpan||1});a=r/s;utils.each(e,function(e){if(i.isLastCell(e,a,s)){n=e;return!1}});return n},selectRow:function(e){var t=this.indexTable[e],i=this.getCell(t[0].rowIndex,t[0].cellIndex),n=this.getCell(t[this.colsNum-1].rowIndex,t[this.colsNum-1].cellIndex),o=this.getCellsRange(i,n);this.setSelected(o)},selectTable:function(){var e=this.table.getElementsByTagName("td"),t=this.getCellsRange(e[0],e[e.length-1]);this.setSelected(t)},setBackground:function(e,t){var i,n,o,r,s,a,l;if("string"===typeof t)utils.each(e,function(e){e.style.backgroundColor=t});else if("object"===typeof t){t=utils.extend({repeat:!0,colorList:["#ddd","#fff"]},t);i=this.getCellInfo(e[0]).rowIndex,n=0,o=t.colorList,r=function(e,t,i){return e[t]?e[t]:i?e[t%e.length]:""};for(s=0;a=e[s++];){l=this.getCellInfo(a);a.style.backgroundColor=r(o,i+n==l.rowIndex?n:++n,t.repeat)}}},removeBackground:function(e){utils.each(e,function(e){e.style.backgroundColor=""})}}}();!function(){function e(e,i){var n,o=domUtils.getElementsByTagName(e,"td th");utils.each(o,function(e){e.removeAttribute("width")});e.setAttribute("width",t(i,!0,s(i,e)));n=[];setTimeout(function(){utils.each(o,function(e){1==e.colSpan&&n.push(e.offsetWidth)});utils.each(o,function(e,t){1==e.colSpan&&e.setAttribute("width",n[t]+"")})},0)}function t(e,t,i){var n=e.body;return n.offsetWidth-(t?2*parseInt(domUtils.getComputedStyle(n,"margin-left"),10):0)-2*i.tableBorder-(e.options.offsetWidth||0)}function i(e){var t,i=o(e).cell;if(i){t=a(i);return t.selectedTds.length?t.selectedTds:[i]}return[]}var n=UE.UETable,o=function(e){return n.getTableItemsByRange(e)},r=function(e){return n.getUETableBySelected(e)},s=function(e,t){return n.getDefaultValue(e,t)},a=function(e){return n.getUETable(e)};UE.commands["inserttable"]={queryCommandState:function(){return o(this).table?-1:0},execCommand:function(e,t){function i(e,t){var i,n,o=[],r=e.numRows,s=e.numCols;for(i=0;i<r;i++){o.push("<tr"+(0==i?' class="firstRow"':"")+">");for(n=0;n<s;n++)o.push('<td width="'+t+'"  vAlign="'+e.tdvalign+'" >'+(browser.ie&&browser.version<11?domUtils.fillChar:"<br/>")+"</td>");o.push("</tr>")}return"<table><tbody>"+o.join("")+"</tbody></table>"}var n,o,r,a,l,d,c;t||(t=utils.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));n=this;o=this.selection.getRange(),r=o.startContainer,a=domUtils.findParent(r,function(e){return domUtils.isBlockElm(e)},!0)||n.body;l=s(n),d=a.offsetWidth,c=Math.floor(d/t.numCols-2*l.tdPadding-l.tdBorder);!t.tdvalign&&(t.tdvalign=n.options.tdvalign);n.execCommand("inserthtml",i(t,c))}};UE.commands["insertparagraphbeforetable"]={queryCommandState:function(){return o(this).cell?0:-1},execCommand:function(){var e,t=o(this).table;if(t){e=this.document.createElement("p");e.innerHTML=browser.ie?"&nbsp;":"<br />";t.parentNode.insertBefore(e,t);this.selection.getRange().setStart(e,0).setCursor()}}};UE.commands["deletetable"]={queryCommandState:function(){var e=this.selection.getRange();return domUtils.findParentByTagName(e.startContainer,"table",!0)?0:-1},execCommand:function(e,t){var i,n=this.selection.getRange();t=t||domUtils.findParentByTagName(n.startContainer,"table",!0);if(t){i=t.nextSibling;if(!i){i=domUtils.createElement(this.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});t.parentNode.insertBefore(i,t)}domUtils.remove(t);n=this.selection.getRange();3==i.nodeType?n.setStartBefore(i):n.setStart(i,0);n.setCursor(!1,!0);this.fireEvent("tablehasdeleted")}}};UE.commands["cellalign"]={queryCommandState:function(){return i(this).length?0:-1},execCommand:function(e,t){var n,o,r=i(this);if(r.length)for(n=0;o=r[n++];)o.setAttribute("align",t)}};UE.commands["cellvalign"]={queryCommandState:function(){return i(this).length?0:-1},execCommand:function(e,t){var n,o,r=i(this);if(r.length)for(n=0;o=r[n++];)o.setAttribute("vAlign",t)}};UE.commands["insertcaption"]={queryCommandState:function(){var e=o(this).table;return e&&0==e.getElementsByTagName("caption").length?1:-1},execCommand:function(){var e,t,i=o(this).table;if(i){e=this.document.createElement("caption");e.innerHTML=browser.ie?domUtils.fillChar:"<br/>";i.insertBefore(e,i.firstChild);t=this.selection.getRange();t.setStart(e,0).setCursor()}}};UE.commands["deletecaption"]={queryCommandState:function(){var e=this.selection.getRange(),t=domUtils.findParentByTagName(e.startContainer,"table");return t?0==t.getElementsByTagName("caption").length?-1:1:-1},execCommand:function(){var e,t=this.selection.getRange(),i=domUtils.findParentByTagName(t.startContainer,"table");if(i){domUtils.remove(i.getElementsByTagName("caption")[0]);e=this.selection.getRange();e.setStart(i.rows[0].cells[0],0).setCursor()}}};UE.commands["inserttitle"]={queryCommandState:function(){var e,t=o(this).table;if(t){e=t.rows[0];return"th"!=e.cells[e.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var e,t=o(this).table;t&&a(t).insertRow(0,"th");e=t.getElementsByTagName("th")[0];this.selection.getRange().setStart(e,0).setCursor(!1,!0)}};UE.commands["deletetitle"]={queryCommandState:function(){var e,t=o(this).table;if(t){e=t.rows[0];return"th"==e.cells[e.cells.length-1].tagName.toLowerCase()?0:-1}return-1},execCommand:function(){var e,t=o(this).table;t&&domUtils.remove(t.rows[0]);e=t.getElementsByTagName("td")[0];this.selection.getRange().setStart(e,0).setCursor(!1,!0)}};UE.commands["inserttitlecol"]={queryCommandState:function(){var e,t=o(this).table;if(t){e=t.rows[t.rows.length-1];return e.getElementsByTagName("th").length?-1:0}return-1},execCommand:function(t){var i,n=o(this).table;n&&a(n).insertCol(0,"th");e(n,this);i=n.getElementsByTagName("th")[0];this.selection.getRange().setStart(i,0).setCursor(!1,!0)}};UE.commands["deletetitlecol"]={queryCommandState:function(){var e,t=o(this).table;if(t){e=t.rows[t.rows.length-1];return e.getElementsByTagName("th").length?0:-1}return-1},execCommand:function(){var t,i,n=o(this).table;if(n)for(t=0;t<n.rows.length;t++)domUtils.remove(n.rows[t].children[0]);e(n,this);i=n.getElementsByTagName("td")[0];this.selection.getRange().setStart(i,0).setCursor(!1,!0)}};UE.commands["mergeright"]={queryCommandState:function(e){var t,i,n,r,s,l=o(this),d=l.table,c=l.cell;if(!d||!c)return-1;t=a(d);if(t.selectedTds.length)return-1;i=t.getCellInfo(c),n=i.colIndex+i.colSpan;if(n>=t.colsNum)return-1;r=t.indexTable[i.rowIndex][n],s=d.rows[r.rowIndex].cells[r.cellIndex];return s&&c.tagName==s.tagName&&r.rowIndex==i.rowIndex&&r.rowSpan==i.rowSpan?0:-1},execCommand:function(e){var t=this.selection.getRange(),i=t.createBookmark(!0),n=o(this).cell,r=a(n);r.mergeRight(n);t.moveToBookmark(i).select()}};UE.commands["mergedown"]={queryCommandState:function(e){var t,i,n,r,s,l=o(this),d=l.table,c=l.cell;if(!d||!c)return-1;t=a(d);if(t.selectedTds.length)return-1;i=t.getCellInfo(c),n=i.rowIndex+i.rowSpan;if(n>=t.rowsNum)return-1;r=t.indexTable[n][i.colIndex],s=d.rows[r.rowIndex].cells[r.cellIndex];return s&&c.tagName==s.tagName&&r.colIndex==i.colIndex&&r.colSpan==i.colSpan?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),i=o(this).cell,n=a(i);n.mergeDown(i);e.moveToBookmark(t).select()}};UE.commands["mergecells"]={queryCommandState:function(){return r(this)?0:-1},execCommand:function(){var e,t,i=r(this);if(i&&i.selectedTds.length){e=i.selectedTds[0];i.mergeRange();t=this.selection.getRange();domUtils.isEmptyBlock(e)?t.setStart(e,0).collapse(!0):t.selectNodeContents(e);t.select()}}};UE.commands["insertrow"]={queryCommandState:function(){var e=o(this),t=e.cell;return t&&("TD"==t.tagName||"TH"==t.tagName&&e.tr!==e.table.rows[0])&&a(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e,t,i,n=this.selection.getRange(),r=n.createBookmark(!0),s=o(this),l=s.cell,d=s.table,c=a(d),u=c.getCellInfo(l);if(c.selectedTds.length){e=c.cellsRange;for(t=0,i=e.endRowIndex-e.beginRowIndex+1;t<i;t++)c.insertRow(e.beginRowIndex,l)}else c.insertRow(u.rowIndex,l);n.moveToBookmark(r).select();"enabled"===d.getAttribute("interlaced")&&this.fireEvent("interlacetable",d)}};UE.commands["insertrownext"]={queryCommandState:function(){var e=o(this),t=e.cell;return t&&"TD"==t.tagName&&a(e.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var e,t,i,n=this.selection.getRange(),r=n.createBookmark(!0),s=o(this),l=s.cell,d=s.table,c=a(d),u=c.getCellInfo(l);if(c.selectedTds.length){e=c.cellsRange;for(t=0,i=e.endRowIndex-e.beginRowIndex+1;t<i;t++)c.insertRow(e.endRowIndex+1,l)}else c.insertRow(u.rowIndex+u.rowSpan,l);n.moveToBookmark(r).select();"enabled"===d.getAttribute("interlaced")&&this.fireEvent("interlacetable",d)}};UE.commands["deleterow"]={queryCommandState:function(){var e=o(this);return e.cell?0:-1},execCommand:function(){var e,t,i,n,r=o(this).cell,s=a(r),l=s.cellsRange,d=s.getCellInfo(r),c=s.getVSideCell(r),u=s.getVSideCell(r,!0),m=this.selection.getRange();if(utils.isEmptyObject(l))s.deleteRow(d.rowIndex);else for(e=l.beginRowIndex;e<l.endRowIndex+1;e++)s.deleteRow(l.beginRowIndex);t=s.table;if(t.getElementsByTagName("td").length)if(1==d.rowSpan||d.rowSpan==l.endRowIndex-l.beginRowIndex+1)(u||c)&&m.selectNodeContents(u||c).setCursor(!1,!0);else{n=s.getCell(d.rowIndex,s.indexTable[d.rowIndex][d.colIndex].cellIndex);n&&m.selectNodeContents(n).setCursor(!1,!0)}else{i=t.nextSibling;domUtils.remove(t);i&&m.setStart(i,0).setCursor(!1,!0)}"enabled"===t.getAttribute("interlaced")&&this.fireEvent("interlacetable",t)}};UE.commands["insertcol"]={queryCommandState:function(e){var t=o(this),i=t.cell;return i&&("TD"==i.tagName||"TH"==i.tagName&&i!==t.tr.cells[0])&&a(t.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(e){
var t,i,n,r,s,l,d=this.selection.getRange(),c=d.createBookmark(!0);if(this.queryCommandState(e)!=-1){t=o(this).cell,i=a(t),n=i.getCellInfo(t);if(i.selectedTds.length){r=i.cellsRange;for(s=0,l=r.endColIndex-r.beginColIndex+1;s<l;s++)i.insertCol(r.beginColIndex,t)}else i.insertCol(n.colIndex,t);d.moveToBookmark(c).select(!0)}}};UE.commands["insertcolnext"]={queryCommandState:function(){var e=o(this),t=e.cell;return t&&a(e.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var e,t,i,n=this.selection.getRange(),r=n.createBookmark(!0),s=o(this).cell,l=a(s),d=l.getCellInfo(s);if(l.selectedTds.length){e=l.cellsRange;for(t=0,i=e.endColIndex-e.beginColIndex+1;t<i;t++)l.insertCol(e.endColIndex+1,s)}else l.insertCol(d.colIndex+d.colSpan,s);n.moveToBookmark(r).select()}};UE.commands["deletecol"]={queryCommandState:function(){var e=o(this);return e.cell?0:-1},execCommand:function(){var e,t,i,n,r=o(this).cell,s=a(r),l=s.cellsRange,d=s.getCellInfo(r),c=s.getHSideCell(r),u=s.getHSideCell(r,!0);if(utils.isEmptyObject(l))s.deleteCol(d.colIndex);else for(e=l.beginColIndex;e<l.endColIndex+1;e++)s.deleteCol(l.beginColIndex);t=s.table,i=this.selection.getRange();if(t.getElementsByTagName("td").length)domUtils.inDoc(r,this.document)?i.setStart(r,0).setCursor(!1,!0):u&&domUtils.inDoc(u,this.document)?i.selectNodeContents(u).setCursor(!1,!0):c&&domUtils.inDoc(c,this.document)&&i.selectNodeContents(c).setCursor(!0,!0);else{n=t.nextSibling;domUtils.remove(t);n&&i.setStart(n,0).setCursor(!1,!0)}}};UE.commands["splittocells"]={queryCommandState:function(){var e,t=o(this),i=t.cell;if(!i)return-1;e=a(t.table);return e.selectedTds.length>0?-1:i&&(i.colSpan>1||i.rowSpan>1)?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),i=o(this).cell,n=a(i);n.splitToCells(i);e.moveToBookmark(t).select()}};UE.commands["splittorows"]={queryCommandState:function(){var e,t=o(this),i=t.cell;if(!i)return-1;e=a(t.table);return e.selectedTds.length>0?-1:i&&i.rowSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),i=o(this).cell,n=a(i);n.splitToRows(i);e.moveToBookmark(t).select()}};UE.commands["splittocols"]={queryCommandState:function(){var e,t=o(this),i=t.cell;if(!i)return-1;e=a(t.table);return e.selectedTds.length>0?-1:i&&i.colSpan>1?0:-1},execCommand:function(){var e=this.selection.getRange(),t=e.createBookmark(!0),i=o(this).cell,n=a(i);n.splitToCols(i);e.moveToBookmark(t).select()}};UE.commands["adaptbytext"]=UE.commands["adaptbywindow"]={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(t){var i,n=o(this),r=n.table;if(r)if("adaptbywindow"==t)e(r,this);else{i=domUtils.getElementsByTagName(r,"td th");utils.each(i,function(e){e.removeAttribute("width")});r.removeAttribute("width")}}};UE.commands["averagedistributecol"]={queryCommandState:function(){var e=r(this);return e&&(e.isFullRow()||e.isFullCol())?0:-1},execCommand:function(e){function t(){var e,t,i,r,a,l=o.table,d=0,c=0,u=s(n,l);if(o.isFullRow()){d=l.offsetWidth;c=o.colsNum}else{t=o.cellsRange.beginColIndex,i=o.cellsRange.endColIndex;for(a=t;a<=i;){r=o.selectedTds[a];d+=r.offsetWidth;a+=r.colSpan;c+=1}}e=Math.ceil(d/c)-2*u.tdBorder-2*u.tdPadding;return e}function i(e){utils.each(domUtils.getElementsByTagName(o.table,"th"),function(e){e.setAttribute("width","")});var t=o.isFullRow()?domUtils.getElementsByTagName(o.table,"td"):o.selectedTds;utils.each(t,function(t){1==t.colSpan&&t.setAttribute("width",e)})}var n=this,o=r(n);o&&o.selectedTds.length&&i(t())}};UE.commands["averagedistributerow"]={queryCommandState:function(){var e=r(this);return e?e.selectedTds&&/th/gi.test(e.selectedTds[0].tagName)?-1:e.isFullRow()||e.isFullCol()?0:-1:-1},execCommand:function(e){function t(){var e,t,i,r,a,l,d,c,u,m,f,h=0,p=o.table,g=s(n,p),b=parseInt(domUtils.getComputedStyle(p.getElementsByTagName("td")[0],"padding-top"));if(o.isFullCol()){i=domUtils.getElementsByTagName(p,"caption"),r=domUtils.getElementsByTagName(p,"th");i.length>0&&(a=i[0].offsetHeight);r.length>0&&(l=r[0].offsetHeight);h=p.offsetHeight-(a||0)-(l||0);t=0==r.length?o.rowsNum:o.rowsNum-1}else{d=o.cellsRange.beginRowIndex,c=o.cellsRange.endRowIndex,u=0,m=domUtils.getElementsByTagName(p,"tr");for(f=d;f<=c;f++){h+=m[f].offsetHeight;u+=1}t=u}e=browser.ie&&browser.version<9?Math.ceil(h/t):Math.ceil(h/t)-2*g.tdBorder-2*b;return e}function i(e){var t=o.isFullCol()?domUtils.getElementsByTagName(o.table,"td"):o.selectedTds;utils.each(t,function(t){1==t.rowSpan&&t.setAttribute("height",e)})}var n=this,o=r(n);o&&o.selectedTds.length&&i(t())}};UE.commands["cellalignment"]={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var i,n,o=this,s=r(o);if(s)utils.each(s.selectedTds,function(e){domUtils.setAttributes(e,t)});else{i=o.selection.getStart(),n=i&&domUtils.findParentByTagName(i,["td","th","caption"],!0);if(/caption/gi.test(n.tagName)){n.style.textAlign=t.align;n.style.verticalAlign=t.vAlign}else domUtils.setAttributes(n,t);o.selection.getRange().setCursor(!0)}},queryCommandValue:function(e){var t,n=o(this).cell;n||(n=i(this)[0]);if(n){t=UE.UETable.getUETable(n).selectedTds;!t.length&&(t=n);return UE.UETable.getTableCellAlignState(t)}return null}};UE.commands["tablealignment"]={queryCommandState:function(){return browser.ie&&browser.version<8?-1:o(this).table?0:-1},execCommand:function(e,t){var i=this,n=i.selection.getStart(),o=n&&domUtils.findParentByTagName(n,["table"],!0);o&&o.setAttribute("align",t)}};UE.commands["edittable"]={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var i,n=this.selection.getRange(),o=domUtils.findParentByTagName(n.startContainer,"table");if(o){i=domUtils.getElementsByTagName(o,"td").concat(domUtils.getElementsByTagName(o,"th"),domUtils.getElementsByTagName(o,"caption"));utils.each(i,function(e){e.style.borderColor=t})}}};UE.commands["edittd"]={queryCommandState:function(){return o(this).table?0:-1},execCommand:function(e,t){var i,n,o=this,s=r(o);if(s)utils.each(s.selectedTds,function(e){e.style.backgroundColor=t});else{i=o.selection.getStart(),n=i&&domUtils.findParentByTagName(i,["td","th","caption"],!0);n&&(n.style.backgroundColor=t)}}};UE.commands["settablebackground"]={queryCommandState:function(){return i(this).length>1?0:-1},execCommand:function(e,t){var n,o;n=i(this);o=a(n[0]);o.setBackground(n,t)}};UE.commands["cleartablebackground"]={queryCommandState:function(){var e,t,n=i(this);if(!n.length)return-1;for(e=0;t=n[e++];)if(""!==t.style.backgroundColor)return 0;return-1},execCommand:function(){var e=i(this),t=a(e[0]);t.removeBackground(e)}};UE.commands["interlacetable"]=UE.commands["uninterlacetable"]={queryCommandState:function(e){var t,i=o(this).table;if(!i)return-1;t=i.getAttribute("interlaced");return"interlacetable"==e?"enabled"===t?-1:0:t&&"disabled"!==t?0:-1},execCommand:function(e,t){var i=o(this).table;if("interlacetable"==e){i.setAttribute("interlaced","enabled");this.fireEvent("interlacetable",i,t)}else{i.setAttribute("interlaced","disabled");this.fireEvent("uninterlacetable",i)}}};UE.commands["setbordervisible"]={queryCommandState:function(e){var t=o(this).table;return t?0:-1},execCommand:function(){var e=o(this).table;utils.each(domUtils.getElementsByTagName(e,"td"),function(e){e.style.borderWidth="1px";e.style.borderStyle="solid"})}}}();UE.plugins["table"]=function(){function e(e){}function t(e,t){i(e,"width",!0);i(e,"height",!0)}function i(e,t,i){if(e.style[t]){i&&e.setAttribute(t,parseInt(e.style[t],10));e.style[t]=""}}function n(e){if("TD"==e.tagName||"TH"==e.tagName)return e;var t;return(t=domUtils.findParentByTagName(e,"td",!0)||domUtils.findParentByTagName(e,"th",!0))?t:null}function o(e){var t,i=new RegExp(domUtils.fillChar,"g");if(e[browser.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(i,"").length>0)return 0;for(t in dtd.$isNotEmpty)if(e.getElementsByTagName(t).length)return 0;return 1}function r(e){return e.pageX||e.pageY?{x:e.pageX,y:e.pageY}:{x:e.clientX+J.document.body.scrollLeft-J.document.body.clientLeft,y:e.clientY+J.document.body.scrollTop-J.document.body.clientTop}}function s(t){var i,o,s,l,h;if(!T())try{i=n(t.target||t.srcElement);if(te){J.body.style.webkitUserSelect="none";if(Math.abs(re.x-t.clientX)>ne||Math.abs(re.y-t.clientY)>ne){v();te=!1;oe=0;N(t)}}if($&&j){oe=0;J.body.style.webkitUserSelect="none";J.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();o=r(t);m(J,!0,$,o,i);"h"==$?W.style.left=c(j,t)+"px":"v"==$&&(W.style.top=u(j,t)+"px");return}if(i){if(J.fireEvent("excludetable",i)===!0)return;o=r(t);s=f(i,o),l=domUtils.findParentByTagName(i,"table",!0);if(d(l,i,t,!0)){if(J.fireEvent("excludetable",l)===!0)return;J.body.style.cursor="url("+J.options.cursorpath+"h.png),pointer"}else if(d(l,i,t)){if(J.fireEvent("excludetable",l)===!0)return;J.body.style.cursor="url("+J.options.cursorpath+"v.png),pointer"}else{J.body.style.cursor="text";h=i;if(/\d/.test(s)){s=s.replace(/\d/,"");i=le(i).getPreviewCell(i,"v"==s)}m(J,!!i&&!!s,i?s:"",o,i)}}else a(!1,l,J)}catch(t){e(t)}}function a(e,t,i){if(e)l(t,i);else{if(z)return;G=setTimeout(function(){!z&&V&&V.parentNode&&V.parentNode.removeChild(V)},2e3)}}function l(e,t){function i(i,n){clearTimeout(o);o=setTimeout(function(){t.fireEvent("tableClicked",e,n)},300)}function n(i){clearTimeout(o);var n=le(e),r=e.rows[0].cells[0],s=n.getLastCell(),a=n.getCellsRange(r,s);t.selection.getRange().setStart(r,0).setCursor(!1,!0);n.setSelected(a)}var o,r=domUtils.getXY(e),s=e.ownerDocument;if(V&&V.parentNode)return V;V=s.createElement("div");V.contentEditable=!1;V.innerHTML="";V.style.cssText="width:15px;height:15px;background-image:url("+t.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(r.y-15)+"px;left:"+r.x+"px;";domUtils.unSelectable(V);V.onmouseover=function(e){z=!0};V.onmouseout=function(e){z=!1};domUtils.on(V,"click",function(e,t){i(t,this)});domUtils.on(V,"dblclick",function(e,t){n(t)});domUtils.on(V,"dragstart",function(e,t){domUtils.preventDefault(t)});s.body.appendChild(V)}function d(e,t,i,n){var o,s,a=r(i),l=f(t,a);if(n){o=e.getElementsByTagName("caption")[0],s=o?o.offsetHeight:0;return"v1"==l&&a.y-domUtils.getXY(e).y-s<8}return"h1"==l&&a.x-domUtils.getXY(e).x<8}function c(e,t){var i,n,o,s,a,l=le(e);if(l){i=l.getSameEndPosCells(e,"x")[0],n=l.getSameStartPosXCells(e)[0],o=r(t).x,s=(i?domUtils.getXY(i).x:domUtils.getXY(l.table).x)+20,a=n?domUtils.getXY(n).x+n.offsetWidth-20:J.body.offsetWidth+5||parseInt(domUtils.getComputedStyle(J.body,"width"),10);s+=ee;a-=ee;return o<s?s:o>a?a:o}}function u(t,i){try{var n=domUtils.getXY(t).y,o=r(i).y;return o<n?n:o}catch(t){e(t)}}function m(t,i,n,o,r){try{t.body.style.cursor="h"==n?"col-resize":"v"==n?"row-resize":"text";if(browser.ie)if(!n||X||de(t))L(t);else{R(t,t.document);D(n,r)}q=i}catch(t){e(t)}}function f(e,t){var i=domUtils.getXY(e);return i?i.x+e.offsetWidth-t.x<ie?"h":t.x-i.x<ie?"h1":i.y+e.offsetHeight-t.y<ie?"v":t.y-i.y<ie?"v1":"":""}function h(e,t){var i,n,o;if(!T()){re={x:t.clientX,y:t.clientY};if(2==t.button){i=de(J),n=!1;if(i){o=M(J,t);utils.each(i.selectedTds,function(e){e===o&&(n=!0)});if(n){o=i.selectedTds[0];setTimeout(function(){J.selection.getRange().setStart(o,0).setCursor(!1,!0)},0)}else{ue(domUtils.getElementsByTagName(J.body,"th td"));i.clearSelected()}}}else g(t)}}function p(e){var t,i,o,s,a,l,c,u;oe=0;e=e||J.window.event;t=n(e.target||e.srcElement);if(t&&(i=f(t,r(e)))){L(J);if("h1"==i){i="h";if(d(domUtils.findParentByTagName(t,"table"),t,e))J.execCommand("adaptbywindow");else{t=le(t).getPreviewCell(t);if(t){o=J.selection.getRange();o.selectNodeContents(t).setCursor(!0,!0)}}}if("h"==i){s=le(t),a=s.table,l=k(t,a,!0);l=y(l,"left");s.width=s.offsetWidth;c=[],u=[];utils.each(l,function(e){c.push(e.offsetWidth)});utils.each(l,function(e){e.removeAttribute("width")});window.setTimeout(function(){var e,t=!0;utils.each(l,function(e,i){var n=e.offsetWidth;if(n>c[i]){t=!1;return!1}u.push(n)});e=t?u:c;utils.each(l,function(t,i){t.width=e[i]-A()})},0)}}}function g(e){ue(domUtils.getElementsByTagName(J.body,"td th"));utils.each(J.document.getElementsByTagName("table"),function(e){e.ueTable=null});H=M(J,e);if(H){var t=domUtils.findParentByTagName(H,"table",!0);ut=le(t);ut&&ut.clearSelected();if(q)b(e);else{J.document.body.style.webkitUserSelect="";X=!0;J.addListener("mouseover",w)}}}function b(e){browser.ie&&(e=C(e));v();te=!0;Z=setTimeout(function(){N(e)},se)}function y(e,t){var i,n,o=[],r=null;for(i=0,n=e.length;i<n;i++){r=e[i][t];r&&o.push(r)}return o}function v(){Z&&clearTimeout(Z);Z=null}function C(e){var t,i,n,o=["pageX","pageY","clientX","clientY","srcElement","target"],r={};if(e)for(t=0;i=o[t];t++){n=e[i];n&&(r[i]=n)}return r}function N(e){te=!1;H=e.target||e.srcElement;if(H){var t=f(H,r(e));if(/\d/.test(t)){t=t.replace(/\d/,"");H=le(H).getPreviewCell(H,"v"==t)}L(J);R(J,J.document);J.fireEvent("saveScene");D(t,H);X=!0;$=t;j=H}}function x(e,t){var i,n,o,r,s,a,l,d,c;if(!T()){v();te=!1;if(q){oe=++oe%3;re={x:t.clientX,y:t.clientY};Q=setTimeout(function(){oe>0&&oe--},se);if(2===oe){oe=0;p(t);return}}if(2!=t.button){i=this;n=i.selection.getRange(),o=domUtils.findParentByTagName(n.startContainer,"table",!0),r=domUtils.findParentByTagName(n.endContainer,"table",!0);if(o||r)if(o===r){o=domUtils.findParentByTagName(n.startContainer,["td","th","caption"],!0);r=domUtils.findParentByTagName(n.endContainer,["td","th","caption"],!0);o!==r&&i.selection.clearRange()}else i.selection.clearRange();X=!1;i.document.body.style.webkitUserSelect="";if($&&j){i.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();oe=0;W=i.document.getElementById("ue_tableDragLine");if(W){s=domUtils.getXY(j),a=domUtils.getXY(W);switch($){case"h":E(j,a.x-s.x);break;case"v":S(j,a.y-s.y-j.offsetHeight)}$="";j=null;L(i);i.fireEvent("saveScene");return}}if(H){d=le(H),c=d?d.selectedTds[0]:null;if(c){n=new dom.Range(i.document);domUtils.isEmptyBlock(c)?n.setStart(c,0).setCursor(!1,!0):n.selectNodeContents(c).shrinkBoundary().setCursor(!1,!0)}else{n=i.selection.getRange().shrinkBoundary();if(!n.collapsed){o=domUtils.findParentByTagName(n.startContainer,["td","th"],!0),r=domUtils.findParentByTagName(n.endContainer,["td","th"],!0);(o&&!r||!o&&r||o&&r&&o!==r)&&n.setCursor(!1,!0)}}H=null;i.removeListener("mouseover",w)}else{l=domUtils.findParentByTagName(t.target||t.srcElement,"td",!0);l||(l=domUtils.findParentByTagName(t.target||t.srcElement,"th",!0));if(l&&("TD"==l.tagName||"TH"==l.tagName)){if(i.fireEvent("excludetable",l)===!0)return;n=new dom.Range(i.document);n.setStart(l,0).setCursor(!1,!0)}}i._selectionChange(250,t)}}}function w(e,t){var i,n,o,r;if(!T()){i=this,n=t.target||t.srcElement;F=domUtils.findParentByTagName(n,"td",!0)||domUtils.findParentByTagName(n,"th",!0);if(H&&F&&("TD"==H.tagName&&"TD"==F.tagName||"TH"==H.tagName&&"TH"==F.tagName)&&domUtils.findParentByTagName(H,"table")==domUtils.findParentByTagName(F,"table")){o=le(F);if(H!=F){i.document.body.style.webkitUserSelect="none";i.selection.getNative()[browser.ie9below?"empty":"removeAllRanges"]();r=o.getCellsRange(H,F);o.setSelected(r)}else{i.document.body.style.webkitUserSelect="";o.clearSelected()}}t.preventDefault?t.preventDefault():t.returnValue=!1}}function U(e,t,i){var n=parseInt(domUtils.getComputedStyle(e,"line-height"),10),o=i+t;t=o<n?n:o;e.style.height&&(e.style.height="");1==e.rowSpan?e.setAttribute("height",t):e.removeAttribute&&e.removeAttribute("height")}function E(e,t){var i,n,o,r=le(e);if(r){i=r.table,n=k(e,i);i.style.width="";i.removeAttribute("width");t=B(t,e,n);if(e.nextSibling){o=0;utils.each(n,function(e){e.left.width=+e.left.width+t;e.right&&(e.right.width=+e.right.width-t)})}else utils.each(n,function(e){e.left.width-=-t})}}function T(){return"false"===J.body.contentEditable}function S(e,t){var i,n,o,r,s;if(!(Math.abs(t)<10)){i=le(e);if(i){n=i.getSameEndPosCells(e,"y"),o=n[0]?n[0].offsetHeight:0;for(r=0;s=n[r++];)U(s,t,o)}}}function k(e,t,i){var n,o,r,s,a;t||(t=domUtils.findParentByTagName(e,"table"));if(!t)return null;n=domUtils.getNodeIndex(e),o=e,r=t.rows,s=0;for(;o;){1===o.nodeType&&(s+=o.colSpan||1);o=o.previousSibling}o=null;a=[];utils.each(r,function(e){var t=e.cells,n=0;utils.each(t,function(e){n+=e.colSpan||1;if(n===s){a.push({left:e,right:e.nextSibling||null});return!1}if(n>s){i&&a.push({left:e});return!1}})});return a}function B(e,t,i){e-=A();if(e<0)return 0;e-=I(t);var n=e<0?"left":"right";e=Math.abs(e);utils.each(i,function(t){var i=t[n];i&&(e=Math.min(e,I(i)-ee))});e=e<0?0:e;return"left"===n?-e:e}function I(e){var t=0,t=e.offsetWidth-A();e.nextSibling||(t-=_(e));t=t<0?0:t;try{e.width=t}catch(e){}return t}function _(e){tab=domUtils.findParentByTagName(e,"table",!1);if(void 0===tab.offsetVal){var t=e.previousSibling;t?tab.offsetVal=e.offsetWidth-t.offsetWidth===ae.borderWidth?ae.borderWidth:0:tab.offsetVal=0}return tab.offsetVal}function A(){var e,t,i,n,o,r,s;if(void 0===ae.tabcellSpace){e=null,t=J.document.createElement("table"),i=J.document.createElement("tbody"),n=J.document.createElement("tr"),o=J.document.createElement("td"),r=null;o.style.cssText="border: 0;";o.width=1;n.appendChild(o);n.appendChild(r=o.cloneNode(!1));i.appendChild(n);t.appendChild(i);t.style.cssText="visibility: hidden;";J.body.appendChild(t);ae.paddingSpace=o.offsetWidth-1;s=t.offsetWidth;o.style.cssText="";r.style.cssText="";ae.borderWidth=(t.offsetWidth-s)/3;ae.tabcellSpace=ae.paddingSpace+ae.borderWidth;J.body.removeChild(t)}A=function(){return ae.tabcellSpace};return ae.tabcellSpace}function R(e,t){if(!X){W=e.document.createElement("div");domUtils.setAttributes(W,{id:"ue_tableDragLine",unselectable:"on",contenteditable:!1,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});e.body.appendChild(W)}}function L(e){if(!X)for(var t;t=e.document.getElementById("ue_tableDragLine");)domUtils.remove(t)}function D(e,t){if(t){var i,n=domUtils.findParentByTagName(t,"table"),o=n.getElementsByTagName("caption"),r=n.offsetWidth,s=n.offsetHeight-(o.length>0?o[0].offsetHeight:0),a=domUtils.getXY(n),l=domUtils.getXY(t);switch(e){case"h":i="height:"+s+"px;top:"+(a.y+(o.length>0?o[0].offsetHeight:0))+"px;left:"+(l.x+t.offsetWidth);W.style.cssText=i+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":i="width:"+r+"px;left:"+a.x+"px;top:"+(l.y+t.offsetHeight);W.style.cssText=i+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)"}}}function O(e,t){var i,n,o,r,s=domUtils.getElementsByTagName(e.body,"table");for(n=0;o=s[n++];){r=domUtils.getElementsByTagName(o,"td");if(r[0])if(t){i=r[0].style.borderColor.replace(/\s/g,"");/(#ffffff)|(rgb\(255,255,255\))/gi.test(i)&&domUtils.addClass(o,"noBorderTable")}else domUtils.removeClasses(o,"noBorderTable")}}function P(e,t,i){var n=e.body;return n.offsetWidth-(t?2*parseInt(domUtils.getComputedStyle(n,"margin-left"),10):0)-2*i.tableBorder-(e.options.offsetWidth||0)}function M(e,t){var i,n,o,s=domUtils.findParentByTagName(t.target||t.srcElement,["td","th"],!0),a=null;if(!s)return null;a=f(s,r(t));if(!s)return null;if("h1"===a&&s.previousSibling){i=domUtils.getXY(s),n=s.offsetWidth;Math.abs(i.x+n-t.clientX)>n/3&&(s=s.previousSibling)}else if("v1"===a&&s.parentNode.previousSibling){i=domUtils.getXY(s),o=s.offsetHeight;Math.abs(i.y+o-t.clientY)>o/3&&(s=s.parentNode.previousSibling.firstChild)}return s&&e.fireEvent("excludetable",s)!==!0?s:null}var H,F,$,q,V,z,W,j,X,Y,K,G,J=this,Z=null,Q=null,ee=5,te=!1,ie=5,ne=10,oe=0,re=null,se=360,ae=UE.UETable,le=function(e){return ae.getUETable(e)},de=function(e){return ae.getUETableBySelected(e)},ce=function(e,t){return ae.getDefaultValue(e,t)},ue=function(e){return ae.removeSelectedClass(e)};J.ready(function(){var e=this,t=e.selection.getText;e.selection.getText=function(){var i,n=de(e);if(n){i="";utils.each(n.selectedTds,function(e){i+=e[browser.ie?"innerText":"textContent"]});return i}return t.call(e.selection)}});H=null,F=null,$="",q=!1,V=null,z=!1,W=null,j=null;X=!1,Y=!0;J.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:J.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:!1,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]});J.getUETable=le;K={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};J.ready(function(){var e,i,r,l,c,u;utils.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",J.document);J.addListener("keydown",function(t,n){var s,a,l,d,c,u,m,f,h,p,g,b,y=this,v=n.keyCode||n.which;if(8==v){s=de(y);if(s&&s.selectedTds.length){s.isFullCol()?y.execCommand("deletecol"):s.isFullRow()?y.execCommand("deleterow"):y.fireEvent("delcells");domUtils.preventDefault(n)}a=domUtils.findParentByTagName(y.selection.getStart(),"caption",!0),l=y.selection.getRange();if(l.collapsed&&a&&o(a)){y.fireEvent("saveScene");d=a.parentNode;domUtils.remove(a);d&&l.setStart(d.rows[0].cells[0],0).setCursor(!1,!0);y.fireEvent("saveScene")}}if(46==v){s=de(y);if(s){y.fireEvent("saveScene");for(c=0;u=s.selectedTds[c++];)domUtils.fillNode(y.document,u);y.fireEvent("saveScene");domUtils.preventDefault(n)}}if(13==v){m=y.selection.getRange(),a=domUtils.findParentByTagName(m.startContainer,"caption",!0);if(a){d=domUtils.findParentByTagName(a,"table");if(m.collapsed)a&&m.setStart(d.rows[0].cells[0],0).setCursor(!1,!0);else{m.deleteContents();y.fireEvent("saveScene")}domUtils.preventDefault(n);return}if(m.collapsed){d=domUtils.findParentByTagName(m.startContainer,"table");if(d){f=d.rows[0].cells[0],h=domUtils.findParentByTagName(y.selection.getStart(),["td","th"],!0),p=d.previousSibling;if(f===h&&(!p||1==p.nodeType&&"TABLE"==p.tagName)&&domUtils.isStartInblock(m)){g=domUtils.findParent(y.selection.getStart(),function(e){return domUtils.isBlockElm(e)},!0);if(g&&(/t(h|d)/i.test(g.tagName)||g===h.firstChild)){y.execCommand("insertparagraphbeforetable");domUtils.preventDefault(n)}}}}}if((n.ctrlKey||n.metaKey)&&"67"==n.keyCode){e=null;s=de(y);if(s){b=s.selectedTds;i=s.isFullCol();r=s.isFullRow();e=[[s.cloneCell(b[0],null,!0)]];for(c=1;u=b[c];c++)u.parentNode!==b[c-1].parentNode?e.push([s.cloneCell(u,null,!0)]):e[e.length-1].push(s.cloneCell(u,null,!0))}}});J.addListener("tablehasdeleted",function(){m(this,!1,"",null);V&&domUtils.remove(V)});J.addListener("beforepaste",function(n,s){var a,l,d,c,u,m,f,h,p,g,b,y,v,C,N,x,w,U,E,T=this,S=T.selection.getRange();if(domUtils.findParentByTagName(S.startContainer,"caption",!0)){a=T.document.createElement("div");a.innerHTML=s.html;s.html=a[browser.ie9below?"innerText":"textContent"]}else{l=de(T);if(e){T.fireEvent("saveScene");S=T.selection.getRange();d=domUtils.findParentByTagName(S.startContainer,["td","th"],!0);if(d){m=le(d);if(r){f=m.getCellInfo(d).rowIndex;"TH"==d.tagName&&f++;for(h=0;p=e[h++];){g=m.insertRow(f++,"td");for(b=0;y=p[b];b++){v=g.cells[b];v||(v=g.insertCell(b));v.innerHTML=y.innerHTML;y.getAttribute("width")&&v.setAttribute("width",y.getAttribute("width"));y.getAttribute("vAlign")&&v.setAttribute("vAlign",y.getAttribute("vAlign"));y.getAttribute("align")&&v.setAttribute("align",y.getAttribute("align"));y.style.cssText&&(v.style.cssText=y.style.cssText)}for(b=0;(y=g.cells[b])&&p[b];b++){y.innerHTML=p[b].innerHTML;p[b].getAttribute("width")&&y.setAttribute("width",p[b].getAttribute("width"));p[b].getAttribute("vAlign")&&y.setAttribute("vAlign",p[b].getAttribute("vAlign"));p[b].getAttribute("align")&&y.setAttribute("align",p[b].getAttribute("align"));p[b].style.cssText&&(y.style.cssText=p[b].style.cssText)}}}else{if(i){x=m.getCellInfo(d);C=0;for(b=0,p=e[0];y=p[b++];)C+=y.colSpan||1;T.__hasEnterExecCommand=!0;for(h=0;h<C;h++)T.execCommand("insertcol");T.__hasEnterExecCommand=!1;d=m.table.rows[0].cells[x.cellIndex];"TH"==d.tagName&&(d=m.table.rows[1].cells[x.cellIndex])}for(h=0;p=e[h++];){c=d;for(b=0;y=p[b++];)if(d){d.innerHTML=y.innerHTML;y.getAttribute("width")&&d.setAttribute("width",y.getAttribute("width"));y.getAttribute("vAlign")&&d.setAttribute("vAlign",y.getAttribute("vAlign"));y.getAttribute("align")&&d.setAttribute("align",y.getAttribute("align"));y.style.cssText&&(d.style.cssText=y.style.cssText);u=d;d=d.nextSibling}else{N=y.cloneNode(!0);domUtils.removeAttributes(N,["class","rowSpan","colSpan"]);u.parentNode.appendChild(N)}d=m.getNextCell(c,!0,!0);if(!e[h])break;if(!d){x=m.getCellInfo(c);m.table.insertRow(m.table.rows.length);m.update();d=m.getVSideCell(c,!0)}}}m.update()}else{l=T.document.createElement("table");for(h=0;p=e[h++];){g=l.insertRow(l.rows.length);for(b=0;y=p[b++];){N=ae.cloneCell(y,null,!0);domUtils.removeAttributes(N,["class"]);g.appendChild(N)}2==b&&N.rowSpan>1&&(N.rowSpan=1)}w=ce(T),U=T.body.offsetWidth-(Y?2*parseInt(domUtils.getComputedStyle(T.body,"margin-left"),10):0)-2*w.tableBorder-(T.options.offsetWidth||0);T.execCommand("insertHTML","<table  "+(i&&r?'width="'+U+'"':"")+">"+l.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}T.fireEvent("contentchange");T.fireEvent("saveScene");s.html="";return!0}a=T.document.createElement("div");a.innerHTML=s.html;E=a.getElementsByTagName("table");if(domUtils.findParentByTagName(T.selection.getStart(),"table")){utils.each(E,function(e){domUtils.remove(e)});domUtils.findParentByTagName(T.selection.getStart(),"caption",!0)&&(a.innerHTML=a[browser.ie?"innerText":"textContent"])}else utils.each(E,function(e){t(e,!0);domUtils.removeAttributes(e,["style","border"]);utils.each(domUtils.getElementsByTagName(e,"td"),function(e){o(e)&&domUtils.fillNode(T.document,e);t(e,!0)})});s.html=a.innerHTML}});J.addListener("afterpaste",function(){utils.each(domUtils.getElementsByTagName(J.body,"table"),function(e){if(e.offsetWidth>J.body.offsetWidth){var t=ce(J,e);e.style.width=J.body.offsetWidth-(Y?2*parseInt(domUtils.getComputedStyle(J.body,"margin-left"),10):0)-2*t.tableBorder-(J.options.offsetWidth||0)+"px"}})});J.addListener("blur",function(){e=null});J.addListener("keydown",function(){clearTimeout(l);l=setTimeout(function(){var e,t=J.selection.getRange(),i=domUtils.findParentByTagName(t.startContainer,["th","td"],!0);if(i){e=i.parentNode.parentNode.parentNode;e.offsetWidth>e.getAttribute("width")&&(i.style.wordBreak="break-all")}},100)});J.addListener("selectionchange",function(){m(J,!1,"",null)});J.addListener("contentchange",function(){var e,t,i=this;L(i);if(!de(i)){e=i.selection.getRange();t=e.startContainer;t=domUtils.findParentByTagName(t,["td","th"],!0);utils.each(domUtils.getElementsByTagName(i.document,"table"),function(e){if(i.fireEvent("excludetable",e)!==!0){e.ueTable=new ae(e);e.onmouseover=function(){i.fireEvent("tablemouseover",e)};e.onmousemove=function(){i.fireEvent("tablemousemove",e);i.options.tableDragable&&a(!0,this,i);utils.defer(function(){i.fireEvent("contentchange",50)},!0)};e.onmouseout=function(){i.fireEvent("tablemouseout",e);m(i,!1,"",null);L(i)};e.onclick=function(e){var t,o,r,s,a,l,c,u;e=i.window.event||e;t=n(e.target||e.srcElement);if(t){o=le(t),r=o.table,s=o.getCellInfo(t),l=i.selection.getRange();if(d(r,t,e,!0)){c=o.getCell(o.indexTable[o.rowsNum-1][s.colIndex].rowIndex,o.indexTable[o.rowsNum-1][s.colIndex].cellIndex);if(e.shiftKey&&o.selectedTds.length)if(o.selectedTds[0]!==c){a=o.getCellsRange(o.selectedTds[0],c);o.setSelected(a)}else l&&l.selectNodeContents(c).select();else if(t!==c){a=o.getCellsRange(t,c);o.setSelected(a)}else l&&l.selectNodeContents(c).select()}else if(d(r,t,e)){u=o.getCell(o.indexTable[s.rowIndex][o.colsNum-1].rowIndex,o.indexTable[s.rowIndex][o.colsNum-1].cellIndex);if(e.shiftKey&&o.selectedTds.length)if(o.selectedTds[0]!==u){a=o.getCellsRange(o.selectedTds[0],u);o.setSelected(a)}else l&&l.selectNodeContents(u).select();else if(t!==u){a=o.getCellsRange(t,u);o.setSelected(a)}else l&&l.selectNodeContents(u).select()}}}}});O(i,!0)}});domUtils.on(J.document,"mousemove",s);domUtils.on(J.document,"mouseout",function(e){var t=e.target||e.srcElement;"TABLE"==t.tagName&&m(J,!1,"",null)});J.addListener("interlacetable",function(e,t,i){var n,o,r,s,a;if(t){n=this,o=t.rows,r=o.length,s=function(e,t,i){return e[t]?e[t]:i?e[t%e.length]:""};for(a=0;a<r;a++)o[a].className=s(i||n.options.classList,a,!0)}});J.addListener("uninterlacetable",function(e,t){var i,n,o,r,s;if(t){i=this,n=t.rows,o=i.options.classList,r=n.length;for(s=0;s<r;s++)domUtils.removeClasses(n[s],o)}});J.addListener("mousedown",h);J.addListener("mouseup",x);domUtils.on(J.body,"dragstart",function(e){x.call(J,"dragstart",e)});J.addOutputRule(function(e){utils.each(e.getNodesByTagName("div"),function(e){"ue_tableDragLine"==e.getAttr("id")&&e.parentNode.removeChild(e)})});c=0;J.addListener("mousedown",function(){c=0});J.addListener("tabkeydown",function(){var e,t,i,n=this.selection.getRange(),r=n.getCommonAncestor(!0,!0),s=domUtils.findParentByTagName(r,"table");if(s){if(domUtils.findParentByTagName(r,"caption",!0)){e=domUtils.getElementsByTagName(s,"th td");e&&e.length&&n.setStart(e[0],0).setCursor(!1,!0)}else{e=domUtils.findParentByTagName(r,["td","th"],!0),t=le(e);c=e.rowSpan>1?c:t.getCellInfo(e).rowIndex;i=t.getTabNextCell(e,c);if(i)o(i)?n.setStart(i,0).setCursor(!1,!0):n.selectNodeContents(i).select();else{J.fireEvent("saveScene");J.__hasEnterExecCommand=!0;this.execCommand("insertrownext");J.__hasEnterExecCommand=!1;n=this.selection.getRange();n.setStart(s.rows[s.rows.length-1].cells[0],0).setCursor();J.fireEvent("saveScene")}}return!0}});browser.ie&&J.addListener("selectionchange",function(){m(this,!1,"",null)});J.addListener("keydown",function(e,t){var i,n,o=this,r=t.keyCode||t.which;if(8!=r&&46!=r){i=!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey;i&&ue(domUtils.getElementsByTagName(o.body,"td"));n=de(o);n&&i&&n.clearSelected()}});J.addListener("beforegetcontent",function(){O(this,!1);browser.ie&&utils.each(this.document.getElementsByTagName("caption"),function(e){domUtils.isEmptyNode(e)&&(e.innerHTML="&nbsp;")})});J.addListener("aftergetcontent",function(){O(this,!0)});J.addListener("getAllHtml",function(){ue(J.document.getElementsByTagName("td"))});J.addListener("fullscreenchanged",function(e,t){if(!t){var i=this.body.offsetWidth/document.body.offsetWidth,n=domUtils.getElementsByTagName(this.body,"table");utils.each(n,function(e){var t,n,o,r;if(e.offsetWidth<J.body.offsetWidth)return!1;t=domUtils.getElementsByTagName(e,"td"),n=[];utils.each(t,function(e){n.push(e.offsetWidth)});for(o=0;r=t[o];o++)r.setAttribute("width",Math.floor(n[o]*i));e.setAttribute("width",Math.floor(P(J,Y,ce(J))))})}});u=J.execCommand;J.execCommand=function(e,t){var i,n,r,s,a,l,d,c,m,f,h,p=this;e=e.toLowerCase();i=de(p),r=new dom.Range(p.document),s=p.commands[e]||UE.commands[e];if(s){if(!i||K[e]||s.notNeedUndo||p.__hasEnterExecCommand)a=u.apply(p,arguments);else{p.__hasEnterExecCommand=!0;p.fireEvent("beforeexeccommand",e);n=i.selectedTds;l=-2,d=-2;for(f=0;h=n[f];f++){o(h)?r.setStart(h,0).setCursor(!1,!0):r.selectNode(h).select(!0);m=p.queryCommandState(e);
c=p.queryCommandValue(e);if(m!=-1){if(l!==m||d!==c){p._ignoreContentChange=!0;a=u.apply(p,arguments);p._ignoreContentChange=!1}l=p.queryCommandState(e);d=p.queryCommandValue(e);domUtils.isEmptyBlock(h)&&domUtils.fillNode(p.document,h)}}r.setStart(n[0],0).shrinkBoundary(!0).setCursor(!1,!0);p.fireEvent("contentchange");p.fireEvent("afterexeccommand",e);p.__hasEnterExecCommand=!1;p._selectionChange()}return a}}})};UE.UETable.prototype.sortTable=function(e,t){var i,n,o,r,s,a,l,d=this.table,c=d.rows,u=[],m="TH"===c[0].cells[0].tagName,f=0;if(this.selectedTds.length){i=this.cellsRange,n=i.endRowIndex+1;for(o=i.beginRowIndex;o<n;o++)u[o]=c[o];u.splice(0,i.beginRowIndex);f=i.endRowIndex+1===this.rowsNum?0:i.endRowIndex+1}else for(o=0,n=c.length;o<n;o++)u[o]=c[o];r={reversecurrent:function(e,t){return 1},orderbyasc:function(e,t){var i=e.innerText||e.textContent,n=t.innerText||t.textContent;return i.localeCompare(n)},reversebyasc:function(e,t){var i=e.innerHTML,n=t.innerHTML;return n.localeCompare(i)},orderbynum:function(e,t){var i=e[browser.ie?"innerText":"textContent"].match(/\d+/),n=t[browser.ie?"innerText":"textContent"].match(/\d+/);i&&(i=+i[0]);n&&(n=+n[0]);return(i||0)-(n||0)},reversebynum:function(e,t){var i=e[browser.ie?"innerText":"textContent"].match(/\d+/),n=t[browser.ie?"innerText":"textContent"].match(/\d+/);i&&(i=+i[0]);n&&(n=+n[0]);return(n||0)-(i||0)}};d.setAttribute("data-sort-type",t&&"string"===typeof t&&r[t]?t:"");m&&u.splice(0,1);u=utils.sort(u,function(i,n){var o;o=t&&"function"===typeof t?t.call(this,i.cells[e],n.cells[e]):t&&"number"===typeof t?1:t&&"string"===typeof t&&r[t]?r[t].call(this,i.cells[e],n.cells[e]):r["orderbyasc"].call(this,i.cells[e],n.cells[e]);return o});s=d.ownerDocument.createDocumentFragment();for(a=0,n=u.length;a<n;a++)s.appendChild(u[a]);l=d.getElementsByTagName("tbody")[0];f?l.insertBefore(s,c[f-i.endRowIndex+i.beginRowIndex-1]):l.appendChild(s)};UE.plugins["tablesort"]=function(){var e=this,t=UE.UETable,i=function(e){return t.getUETable(e)},n=function(e){return t.getTableItemsByRange(e)};e.ready(function(){utils.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+e.options.themePath+e.options.theme+"/images/sortable.png);}",e.document);e.addListener("afterexeccommand",function(e,t){"mergeright"!=t&&"mergedown"!=t&&"mergecells"!=t||this.execCommand("disablesort")})});UE.commands["sorttable"]={queryCommandState:function(){var e,t,i,o,r=this,s=n(r);if(!s.cell)return-1;e=s.table,t=e.getElementsByTagName("td");for(i=0;o=t[i++];)if(1!=o.rowSpan||1!=o.colSpan)return-1;return 0},execCommand:function(e,t){var o=this,r=o.selection.getRange(),s=r.createBookmark(!0),a=n(o),l=a.cell,d=i(a.table),c=d.getCellInfo(l);d.sortTable(c.cellIndex,t);r.moveToBookmark(s);try{r.select()}catch(e){}}};UE.commands["enablesort"]=UE.commands["disablesort"]={queryCommandState:function(e){var t,i,o=n(this).table;if(o&&"enablesort"==e){t=domUtils.getElementsByTagName(o,"th td");for(i=0;i<t.length;i++)if(t[i].getAttribute("colspan")>1||t[i].getAttribute("rowspan")>1)return-1}return o?"enablesort"==e^"sortEnabled"!=o.getAttribute("data-sort")?-1:0:-1},execCommand:function(e){var t=n(this).table;t.setAttribute("data-sort","enablesort"==e?"sortEnabled":"sortDisabled");"enablesort"==e?domUtils.addClass(t,"sortEnabled"):domUtils.removeClasses(t,"sortEnabled")}}};UE.plugins["contextmenu"]=function(){var e,t,i,n,o=this;o.setOpt("enableContextMenu",!0);if(o.getOpt("enableContextMenu")!==!1){e=o.getLang("contextMenu"),i=o.options.contextMenu||[{label:e["selectall"],cmdName:"selectall"},{label:e.cleardoc,cmdName:"cleardoc",exec:function(){confirm(e.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:e.unlink,cmdName:"unlink"},"-",{group:e.paragraph,icon:"justifyjustify",subMenu:[{label:e.justifyleft,cmdName:"justify",value:"left"},{label:e.justifyright,cmdName:"justify",value:"right"},{label:e.justifycenter,cmdName:"justify",value:"center"},{label:e.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:e.table,icon:"table",subMenu:[{label:e.inserttable,cmdName:"inserttable"},{label:e.deletetable,cmdName:"deletetable"},"-",{label:e.deleterow,cmdName:"deleterow"},{label:e.deletecol,cmdName:"deletecol"},{label:e.insertcol,cmdName:"insertcol"},{label:e.insertcolnext,cmdName:"insertcolnext"},{label:e.insertrow,cmdName:"insertrow"},{label:e.insertrownext,cmdName:"insertrownext"},"-",{label:e.insertcaption,cmdName:"insertcaption"},{label:e.deletecaption,cmdName:"deletecaption"},{label:e.inserttitle,cmdName:"inserttitle"},{label:e.deletetitle,cmdName:"deletetitle"},{label:e.inserttitlecol,cmdName:"inserttitlecol"},{label:e.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:e.mergecells,cmdName:"mergecells"},{label:e.mergeright,cmdName:"mergeright"},{label:e.mergedown,cmdName:"mergedown"},"-",{label:e.splittorows,cmdName:"splittorows"},{label:e.splittocols,cmdName:"splittocols"},{label:e.splittocells,cmdName:"splittocells"},"-",{label:e.averageDiseRow,cmdName:"averagedistributerow"},{label:e.averageDisCol,cmdName:"averagedistributecol"},"-",{label:e.edittd,cmdName:"edittd",exec:function(){UE.ui["edittd"]&&new UE.ui["edittd"](this);this.getDialog("edittd").open()}},{label:e.edittable,cmdName:"edittable",exec:function(){UE.ui["edittable"]&&new UE.ui["edittable"](this);this.getDialog("edittable").open()}},{label:e.setbordervisible,cmdName:"setbordervisible"}]},{group:e.tablesort,icon:"tablesort",subMenu:[{label:e.enablesort,cmdName:"enablesort"},{label:e.disablesort,cmdName:"disablesort"},"-",{label:e.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:e.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:e.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:e.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:e.reversebynum,cmdName:"sorttable",value:"reversebynum"}]},{group:e.borderbk,icon:"borderBack",subMenu:[{label:e.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:e.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:e.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#bbb","#ccc"]})}},{label:e.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},{label:e.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["red","blue"]})}},{label:e.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:!0,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:e.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:e.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:e.tableleft,value:"left"},{cmdName:"tablealignment",className:"center",label:e.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:e.tableright,value:"right"}]},"-",{label:e.insertparagraphbefore,cmdName:"insertparagraph",value:!0},{label:e.insertparagraphafter,cmdName:"insertparagraph"},{label:e["copy"],cmdName:"copy"},{label:e["paste"],cmdName:"paste"}];if(i.length){n=UE.ui.uiUtils;o.addListener("contextmenu",function(r,s){var a,l,d,c,u,m,f=n.getViewportOffsetByEvent(s);o.fireEvent("beforeselectionchange");t&&t.destroy();for(a=0,d=[];l=i[a];a++)!function(t){function i(){switch(t.icon){case"table":return o.getLang("contextMenu.table");case"justifyjustify":return o.getLang("contextMenu.paragraph");case"aligntd":return o.getLang("contextMenu.aligntd");case"aligntable":return o.getLang("contextMenu.aligntable");case"tablesort":return e.tablesort;case"borderBack":return e.borderbk;default:return""}}if("-"==t)(c=d[d.length-1])&&"-"!==c&&d.push("-");else if(t.hasOwnProperty("group")){for(var n,r=0,s=[];n=t.subMenu[r];r++)!function(e){"-"==e?(c=s[s.length-1])&&"-"!==c?s.push("-"):s.splice(s.length-1):(o.commands[e.cmdName]||UE.commands[e.cmdName]||e.query)&&(e.query?e.query():o.queryCommandState(e.cmdName))>-1&&s.push({label:e.label||o.getLang("contextMenu."+e.cmdName+(e.value||""))||"",className:"edui-for-"+e.cmdName+(e.className?" edui-for-"+e.cmdName+"-"+e.className:""),onclick:e.exec?function(){e.exec.call(o)}:function(){o.execCommand(e.cmdName,e.value)}})}(n);s.length&&d.push({label:i(),className:"edui-for-"+t.icon,subMenu:{items:s,editor:o}})}else(o.commands[t.cmdName]||UE.commands[t.cmdName]||t.query)&&(t.query?t.query.call(o):o.queryCommandState(t.cmdName))>-1&&d.push({label:t.label||o.getLang("contextMenu."+t.cmdName),className:"edui-for-"+(t.icon?t.icon:t.cmdName+(t.value||"")),onclick:t.exec?function(){t.exec.call(o)}:function(){o.execCommand(t.cmdName,t.value)}})}(l);"-"==d[d.length-1]&&d.pop();t=new UE.ui.Menu({items:d,className:"edui-contextmenu",editor:o});t.render();t.showAt(f);o.fireEvent("aftershowcontextmenu",t);domUtils.preventDefault(s);if(browser.ie){try{u=o.selection.getNative().createRange()}catch(e){return}if(u.item){m=new dom.Range(o.document);m.selectNode(u.item(0)).select(!0,!0)}}});o.addListener("aftershowcontextmenu",function(e,t){var i,n;if(o.zeroclipboard){i=t.items;for(n in i)"edui-for-copy"==i[n].className&&o.zeroclipboard.clip(i[n].getDom())}})}}};UE.plugins["shortcutmenu"]=function(){var e,t=this,i=t.options.shortcutMenu||[];if(i.length){t.addListener("contextmenu mouseup",function(t,n){var o,r,s=this,a={type:t,target:n.target||n.srcElement,screenX:n.screenX,screenY:n.screenY,clientX:n.clientX,clientY:n.clientY};setTimeout(function(){var n=s.selection.getRange();if(n.collapsed===!1||"contextmenu"==t){if(!e){e=new baidu.editor.ui.ShortCutMenu({editor:s,items:i,theme:s.options.theme,className:"edui-shortcutmenu"});e.render();s.fireEvent("afterrendershortcutmenu",e)}e.show(a,!!UE.plugins["contextmenu"])}});if("contextmenu"==t){domUtils.preventDefault(n);if(browser.ie9below){try{o=s.selection.getNative().createRange()}catch(e){return}if(o.item){r=new dom.Range(s.document);r.selectNode(o.item(0)).select(!0,!0)}}}});t.addListener("keydown",function(t){"keydown"==t&&e&&!e.isHidden&&e.hide()})}};UE.plugins["basestyle"]=function(){var e,t={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},i=function(e,t){return domUtils.filterNodeList(e.selection.getStartElementPath(),t)},n=this;n.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});n.addInputRule(function(e){utils.each(e.getNodesByTagName("b i"),function(e){switch(e.tagName){case"b":e.tagName="strong";break;case"i":e.tagName="em"}})});for(e in t)!function(e,t){n.commands[e]={execCommand:function(e){var o,r,s=n.selection.getRange(),a=i(this,t);if(s.collapsed){if(a){o=n.document.createTextNode("");s.insertNode(o).removeInlineStyle(t);s.setStartBefore(o);domUtils.remove(o)}else{r=s.document.createElement(t[0]);if("superscript"==e||"subscript"==e){o=n.document.createTextNode("");s.insertNode(o).removeInlineStyle(["sub","sup"]).setStartBefore(o).collapse(!0)}s.insertNode(r).setStart(r,0)}s.collapse(!0)}else{"superscript"!=e&&"subscript"!=e||a&&a.tagName.toLowerCase()==e||s.removeInlineStyle(["sub","sup"]);a?s.removeInlineStyle(t):s.applyInlineStyle(t[0])}s.select()},queryCommandState:function(){return i(this,t)?1:0}}}(e,t[e])};UE.plugins["elementpath"]=function(){var e,t,i=this;i.setOpt("elementPathEnabled",!0);i.options.elementPathEnabled&&(i.commands["elementpath"]={execCommand:function(n,o){var r=t[o],s=i.selection.getRange();e=1*o;s.selectNode(r).select()},queryCommandValue:function(){var i,n,o,r=[].concat(this.selection.getStartElementPath()).reverse(),s=[];t=r;for(i=0;n=r[i];i++)if(3!=n.nodeType){o=n.tagName.toLowerCase();"img"==o&&n.getAttribute("anchorname")&&(o="anchor");s[i]=o;if(e==i){e=-1;break}}return s}})};UE.plugins["formatmatch"]=function(){function e(r,s){function a(e){m&&e.selectNode(m);return e.applyInlineStyle(n[n.length-1].tagName,null,n)}var l,d,c,u,m,f;browser.webkit&&(l="IMG"==s.target.tagName?s.target:null);i.undoManger&&i.undoManger.save();d=i.selection.getRange(),c=l||d.getClosedNode();if(t&&c&&"IMG"==c.tagName){c.style.cssText+=";float:"+(t.style.cssFloat||t.style.styleFloat||"none")+";display:"+(t.style.display||"inline");t=null}else if(!t){u=d.collapsed;if(u){m=i.document.createTextNode("match");d.insertNode(m).select()}i.__hasEnterExecCommand=!0;f=i.options.removeFormatAttributes;i.options.removeFormatAttributes="";i.execCommand("removeformat");i.options.removeFormatAttributes=f;i.__hasEnterExecCommand=!1;d=i.selection.getRange();n.length&&a(d);m&&d.setStartBefore(m).collapse(!0);d.select();m&&domUtils.remove(m)}i.undoManger&&i.undoManger.save();i.removeListener("mouseup",e);o=0}var t,i=this,n=[],o=0;i.addListener("reset",function(){n=[];o=0});i.commands["formatmatch"]={execCommand:function(r){var s,a,l,d;if(o){o=0;n=[];i.removeListener("mouseup",e)}else{s=i.selection.getRange();t=s.getClosedNode();if(!t||"IMG"!=t.tagName){s.collapse(!0).shrinkBoundary();a=s.startContainer;n=domUtils.findParents(a,!0,function(e){return!domUtils.isBlockElm(e)&&1==e.nodeType});for(l=0;d=n[l];l++)if("A"==d.tagName){n.splice(l,1);break}}i.addListener("mouseup",e);o=1}},queryCommandState:function(){return o},notNeedUndo:1}};UE.plugin.register("searchreplace",function(){function e(e,t,i){var n,o,r=t.searchStr;if(t.dir==-1){e=e.split("").reverse().join("");r=r.split("").reverse().join("");i=e.length-i}n=new RegExp(r,"g"+(t.casesensitive?"":"i"));for(;o=n.exec(e);)if(o.index>=i)return t.dir==-1?e.length-o.index-t.searchStr.length:o.index;return-1}function t(t,i,n){var o,r,a,l=n.all||1==n.dir?"getNextDomNode":"getPreDomNode";domUtils.isBody(t)&&(t=t.firstChild);a=1;for(;t;){o=3==t.nodeType?t.nodeValue:t[browser.ie?"innerText":"textContent"];r=e(o,n,i);a=0;if(r!=-1)return{node:t,index:r};t=domUtils[l](t);for(;t&&s[t.nodeName.toLowerCase()];)t=domUtils[l](t,!0);t&&(i=n.dir==-1?(3==t.nodeType?t.nodeValue:t[browser.ie?"innerText":"textContent"]).length:0)}}function i(e,t,n){for(var o,r=0,s=e.firstChild,a=0;s;){if(3==s.nodeType){a=s.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;r+=a;if(r>=t)return{node:s,index:a-(r-t)}}else if(!dtd.$empty[s.tagName]){a=s[browser.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;r+=a;if(r>=t){o=i(s,a-(r-t),n);if(o)return o}}s=domUtils.getNextDomNode(s)}}function n(e,n){var r,s,a,l,d,c,u=e.selection.getRange(),m=n.searchStr,f=e.document.createElement("span");f.innerHTML="$$ueditor_searchreplace_key$$";u.shrinkBoundary(!0);if(!u.collapsed){u.select();s=e.selection.getText();if(new RegExp("^"+n.searchStr+"$",n.casesensitive?"":"i").test(s)){if(void 0!=n.replaceStr){o(u,n.replaceStr);u.select();return!0}u.collapse(n.dir==-1)}}u.insertNode(f);u.enlargeToBlockElm(!0);r=u.startContainer;a=r[browser.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$");u.setStartBefore(f);domUtils.remove(f);l=t(r,a,n);if(l){d=i(l.node,l.index,m);c=i(l.node,l.index+m.length,m);u.setStart(d.node,d.index).setEnd(c.node,c.index);void 0!==n.replaceStr&&o(u,n.replaceStr);u.select();return!0}u.setCursor()}function o(e,t){t=r.document.createTextNode(t);e.deleteContents().insertNode(t)}var r=this,s={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(e,t){var i,o,s;utils.extend(t,{all:!1,casesensitive:!1,dir:1},!0);i=0;if(t.all){o=r.selection.getRange(),s=r.body.firstChild;if(s&&1==s.nodeType){o.setStart(s,0);o.shrinkBoundary(!0)}else 3==s.nodeType&&o.setStartBefore(s);o.collapse(!0).select(!0);void 0!==t.replaceStr&&r.fireEvent("saveScene");for(;n(this,t);)i++;i&&r.fireEvent("saveScene")}else{void 0!==t.replaceStr&&r.fireEvent("saveScene");n(this,t)&&i++;i&&r.fireEvent("saveScene")}return i},notNeedUndo:1}}}});UE.plugins["customstyle"]=function(){var e=this;e.setOpt({customstyle:[{tag:"h1",name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});e.commands["customstyle"]={execCommand:function(e,t){var i,n,o,r,s,a,l,d,c,u,m,f=this,h=t.tag,p=domUtils.findParent(f.selection.getStart(),function(e){return e.getAttribute("label")},!0),g={};for(o in t)void 0!==t[o]&&(g[o]=t[o]);delete g.tag;if(p&&p.getAttribute("label")==t.label){i=this.selection.getRange();n=i.createBookmark();if(i.collapsed)if(dtd.$block[p.tagName]){r=f.document.createElement("p");domUtils.moveChild(p,r);p.parentNode.insertBefore(r,p);domUtils.remove(p)}else domUtils.remove(p,!0);else{s=domUtils.getCommonAncestor(n.start,n.end),a=domUtils.getElementsByTagName(s,h);new RegExp(h,"i").test(s.tagName)&&a.push(s);for(l=0;d=a[l++];)if(d.getAttribute("label")==t.label){c=domUtils.getPosition(d,n.start),u=domUtils.getPosition(d,n.end);if((c&domUtils.POSITION_FOLLOWING||c&domUtils.POSITION_CONTAINS)&&(u&domUtils.POSITION_PRECEDING||u&domUtils.POSITION_CONTAINS)&&dtd.$block[h]){r=f.document.createElement("p");domUtils.moveChild(d,r);d.parentNode.insertBefore(r,d)}domUtils.remove(d,!0)}p=domUtils.findParent(s,function(e){return e.getAttribute("label")==t.label},!0);p&&domUtils.remove(p,!0)}i.moveToBookmark(n).select()}else if(dtd.$block[h]){this.execCommand("paragraph",h,g,"customstyle");i=f.selection.getRange();if(!i.collapsed){i.collapse();p=domUtils.findParent(f.selection.getStart(),function(e){return e.getAttribute("label")==t.label},!0);m=f.document.createElement("p");domUtils.insertAfter(p,m);domUtils.fillNode(f.document,m);i.setStart(m,0).setCursor()}}else{i=f.selection.getRange();if(i.collapsed){p=f.document.createElement(h);domUtils.setAttributes(p,g);i.insertNode(p).setStart(p,0).setCursor();return}n=i.createBookmark();i.applyInlineStyle(h,g).moveToBookmark(n).select()}},queryCommandValue:function(){var e=domUtils.filterNodeList(this.selection.getStartElementPath(),function(e){return e.getAttribute("label")});return e?e.getAttribute("label"):""}};e.addListener("keyup",function(t,i){var n,o,r,s=i.keyCode||i.which;if(32==s||13==s){n=e.selection.getRange();if(n.collapsed){o=domUtils.findParent(e.selection.getStart(),function(e){return e.getAttribute("label")},!0);if(o&&dtd.$block[o.tagName]&&domUtils.isEmptyNode(o)){r=e.document.createElement("p");domUtils.insertAfter(o,r);domUtils.fillNode(e.document,r);domUtils.remove(o);n.setStart(r,0).setCursor()}}}})};UE.plugins["catchremoteimage"]=function(){var me=this,ajax=UE.ajax;if(me.options.catchRemoteImageEnable!==!1){me.setOpt({catchRemoteImageEnable:!1});me.addListener("afterpaste",function(){me.fireEvent("catchRemoteImage")});me.addListener("catchRemoteImage",function(){function catchremoteimage(e,t){var i=utils.serializeParam(me.queryCommandValue("serverparam"))||"",n=utils.formatUrl(catcherActionUrl+(catcherActionUrl.indexOf("?")==-1?"?":"&")+i),o=utils.isCrossDomainUrl(n),r={method:"POST",dataType:o?"jsonp":"",timeout:6e4,onsuccess:t["success"],onerror:t["error"]};r[catcherFieldName]=e;ajax.request(n,r)}var i,ci,src,catcherLocalDomain=me.getOpt("catcherLocalDomain"),catcherActionUrl=me.getActionUrl(me.getOpt("catcherActionName")),catcherUrlPrefix=me.getOpt("catcherUrlPrefix"),catcherFieldName=me.getOpt("catcherFieldName"),remoteImages=[],imgs=domUtils.getElementsByTagName(me.document,"img"),test=function(e,t){if(e.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(e))return!0;if(t)for(var i,n=0;i=t[n++];)if(e.indexOf(i)!==-1)return!0;return!1};for(i=0;ci=imgs[i++];)if(!ci.getAttribute("word_img")){src=ci.getAttribute("_src")||ci.src||"";/^(https?|ftp):/i.test(src)&&!test(src,catcherLocalDomain)&&remoteImages.push(src)}remoteImages.length&&catchremoteimage(remoteImages,{success:function(r){var info,i,j,ci,cj,oldSrc,newSrc,list;try{info=void 0!==r.state?r:eval("("+r.responseText+")")}catch(e){return}list=info.list;for(i=0;ci=imgs[i++];){oldSrc=ci.getAttribute("_src")||ci.src||"";for(j=0;cj=list[j++];)if(oldSrc==cj.source&&"SUCCESS"==cj.state){newSrc=catcherUrlPrefix+cj.url;domUtils.setAttributes(ci,{src:newSrc,_src:newSrc});break}}me.fireEvent("catchremotesuccess")},error:function(){me.fireEvent("catchremoteerror")}})})}};UE.plugin.register("snapscreen",function(){function getLocation(e){var t,i=document.createElement("a"),n=utils.serializeParam(me.queryCommandValue("serverparam"))||"";i.href=e;browser.ie&&(i.href=i.href);t=i.search;if(n){t=t+(t.indexOf("?")==-1?"?":"&")+n;t=t.replace(/[&]+/gi,"&")}return{port:i.port,hostname:i.hostname,path:i.pathname+t||+i.hash}}var snapplugin,me=this;return{commands:{snapscreen:{execCommand:function(cmd){function onSuccess(rs){try{rs=eval("("+rs+")");if("SUCCESS"==rs.state){var opt=me.options;me.execCommand("insertimage",{src:opt.snapscreenUrlPrefix+rs.url,_src:opt.snapscreenUrlPrefix+rs.url,alt:rs.title||"",floatStyle:opt.snapscreenImgAlign})}else alert(rs.state)}catch(e){alert(lang.callBackErrorMsg)}}var url,local,res,container,doc,lang=me.getLang("snapScreen_plugin");if(!snapplugin){container=me.container;doc=me.container.ownerDocument||me.container.document;snapplugin=doc.createElement("object");try{snapplugin.type="application/x-pluginbaidusnap"}catch(e){return}snapplugin.style.cssText="position:absolute;left:-9999px;width:0;height:0;";snapplugin.setAttribute("width","0");snapplugin.setAttribute("height","0");container.appendChild(snapplugin)}url=me.getActionUrl(me.getOpt("snapscreenActionName"));local=getLocation(url);setTimeout(function(){try{res=snapplugin.saveSnapshot(local.hostname,local.path,local.port)}catch(e){me.ui._dialogs["snapscreenDialog"].open();return}onSuccess(res)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}});UE.commands["insertparagraph"]={execCommand:function(e,t){for(var i,n,o=this,r=o.selection.getRange(),s=r.startContainer;s&&!domUtils.isBody(s);){i=s;s=s.parentNode}if(i){n=o.document.createElement("p");t?i.parentNode.insertBefore(n,i):i.parentNode.insertBefore(n,i.nextSibling);domUtils.fillNode(o.document,n);r.setStart(n,0).setCursor(!1,!0)}}};UE.plugin.register("webapp",function(){function e(e,i){return i?'<iframe class="edui-faked-webapp" title="'+e.title+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+'width="'+e.width+'" height="'+e.height+'"  scrolling="no" frameborder="0" src="'+e.url+'" logo_url = "'+e.logo+'"></iframe>':'<img title="'+e.title+'" width="'+e.width+'" height="'+e.height+'" src="'+t.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+e.logo+'" style="background:url('+e.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+e.url+'" '+(e.align&&!e.cssfloat?'align="'+e.align+'"':"")+(e.cssfloat?'style="float:'+e.cssfloat+'"':"")+"/>"}var t=this;return{outputRule:function(t){utils.each(t.getNodesByTagName("img"),function(t){var i,n;if("edui-faked-webapp"==t.getAttr("class")){i=e({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("_url"),logo:t.getAttr("_logo_url")},!0);n=UE.uNode.createElement(i);t.parentNode.replaceChild(n,t)}})},inputRule:function(t){utils.each(t.getNodesByTagName("iframe"),function(t){if("edui-faked-webapp"==t.getAttr("class")){var i=UE.uNode.createElement(e({title:t.getAttr("title"),width:t.getAttr("width"),height:t.getAttr("height"),align:t.getAttr("align"),cssfloat:t.getStyle("float"),url:t.getAttr("src"),logo:t.getAttr("logo_url")}));t.parentNode.replaceChild(i,t)}})},commands:{webapp:{execCommand:function(t,i){var n=this,o=e(utils.extend(i,{align:"none"}),!1);n.execCommand("inserthtml",o)},queryCommandState:function(){var e=this,t=e.selection.getRange().getClosedNode(),i=t&&"edui-faked-webapp"==t.className;return i?1:0}}}}});UE.plugins["template"]=function(){UE.commands["template"]={execCommand:function(e,t){t.html&&this.execCommand("inserthtml",t.html)}};this.addListener("click",function(e,t){var i=t.target||t.srcElement,n=this.selection.getRange(),o=domUtils.findParent(i,function(e){if(e.className&&domUtils.hasClass(e,"ue_t"))return e},!0);o&&n.selectNode(o).shrinkBoundary().select()});this.addListener("keydown",function(e,t){var i,n=this.selection.getRange();if(!n.collapsed&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){i=domUtils.findParent(n.startContainer,function(e){if(e.className&&domUtils.hasClass(e,"ue_t"))return e},!0);i&&domUtils.removeClasses(i,["ue_t"])}})};UE.plugin.register("music",function(){function e(e,i,n,o,r,s){return s?'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+e+'" width="'+i+'" height="'+n+'" '+(o&&!r?'align="'+o+'"':"")+(r?'style="float:'+r+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':"<img "+(o&&!r?'align="'+o+'"':"")+(r?'style="float:'+r+'"':"")+' width="'+i+'" height="'+n+'" _url="'+e+'" class="edui-faked-music" src="'+t.options.langPath+t.options.lang+'/images/music.png" />'}var t=this;return{outputRule:function(t){utils.each(t.getNodesByTagName("img"),function(t){var i,n,o,r;if("edui-faked-music"==t.getAttr("class")){n=t.getStyle("float");o=t.getAttr("align");i=e(t.getAttr("_url"),t.getAttr("width"),t.getAttr("height"),o,n,!0);r=UE.uNode.createElement(i);t.parentNode.replaceChild(r,t)}})},inputRule:function(t){utils.each(t.getNodesByTagName("embed"),function(t){var i,n,o;if("edui-faked-music"==t.getAttr("class")){i=t.getStyle("float");n=t.getAttr("align");html=e(t.getAttr("src"),t.getAttr("width"),t.getAttr("height"),n,i,!1);o=UE.uNode.createElement(html);t.parentNode.replaceChild(o,t)}})},commands:{music:{execCommand:function(t,i){var n=this,o=e(i.url,i.width||400,i.height||95,"none",!1);n.execCommand("inserthtml",o)},queryCommandState:function(){var e=this,t=e.selection.getRange().getClosedNode(),i=t&&"edui-faked-music"==t.className;return i?1:0}}}}});UE.plugin.register("autoupload",function(){function e(e,t){var i,n,o,r,s,a,l,d=t,c=/image\/\w+/i.test(e.type)?"image":"file",u="loading_"+(+new Date).toString(36),m=d.getOpt(c+"FieldName"),f=d.getOpt(c+"UrlPrefix"),h=d.getOpt(c+"MaxSize"),p=d.getOpt(c+"AllowFiles"),g=d.getActionUrl(d.getOpt(c+"ActionName")),b=function(e){var t=d.document.getElementById(u);t&&domUtils.remove(t);d.fireEvent("showmessage",{id:u,content:e,type:"error",timeout:4e3})};if("image"==c){i='<img class="loadingclass" id="'+u+'" src="'+d.options.themePath+d.options.theme+'/images/spacer.gif" title="'+(d.getLang("autoupload.loading")||"")+'" >';n=function(e){var t=f+e.url,i=d.document.getElementById(u);if(i){i.setAttribute("src",t);i.setAttribute("_src",t);i.setAttribute("title",e.title||"");i.setAttribute("alt",e.original||"");i.removeAttribute("id");domUtils.removeClasses(i,"loadingclass")}}}else{i='<p><img class="loadingclass" id="'+u+'" src="'+d.options.themePath+d.options.theme+'/images/spacer.gif" title="'+(d.getLang("autoupload.loading")||"")+'" ></p>';n=function(e){var t=f+e.url,i=d.document.getElementById(u),n=d.selection.getRange(),o=n.createBookmark();n.selectNode(i).select();d.execCommand("insertfile",{url:t});n.moveToBookmark(o).select()}}d.execCommand("inserthtml",i);if(d.getOpt(c+"ActionName"))if(e.size>h)b(d.getLang("autoupload.exceedSizeError"));else{o=e.name?e.name.substr(e.name.lastIndexOf(".")):"";if(o&&"image"!=c||p&&(p.join("")+".").indexOf(o.toLowerCase()+".")==-1)b(d.getLang("autoupload.exceedTypeError"));else{r=new XMLHttpRequest,s=new FormData,a=utils.serializeParam(d.queryCommandValue("serverparam"))||"",l=utils.formatUrl(g+(g.indexOf("?")==-1?"?":"&")+a);s.append(m,e,e.name||"blob."+e.type.substr("image/".length));s.append("type","ajax");r.open("post",l,!0);r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.addEventListener("load",function(e){try{var t=new Function("return "+utils.trim(e.target.response))();"SUCCESS"==t.state&&t.url?n(t):b(t.state)}catch(e){b(d.getLang("autoupload.loadError"))}});r.send(s)}}else b(d.getLang("autoupload.errorLoadConfig"))}function t(e){return e.clipboardData&&e.clipboardData.items&&1==e.clipboardData.items.length&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null}function i(e){return e.dataTransfer&&e.dataTransfer.files?e.dataTransfer.files:null}return{outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)});utils.each(e.getNodesByTagName("p"),function(e){/\bloadpara\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},bindEvents:{ready:function(n){var o=this;if(window.FormData&&window.FileReader){domUtils.on(o.body,"paste drop",function(n){var r,s,a=!1,l="paste"==n.type?t(n):i(n);if(l){r=l.length;for(;r--;){s=l[r];s.getAsFile&&(s=s.getAsFile());if(s&&s.size>0){e(s,o);a=!0}}a&&n.preventDefault()}});domUtils.on(o.body,"dragover",function(e){"Files"==e.dataTransfer.types[0]&&e.preventDefault()});utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)}}}}});UE.plugin.register("autosave",function(){function e(e){var r;if(!(new Date-i<n))if(e.hasContents()){i=new Date;e._saveFlag=null;r=t.body.innerHTML;if(e.fireEvent("beforeautosave",{content:r})!==!1){t.setPreferences(o,r);e.fireEvent("afterautosave",{content:r})}}else o&&t.removePreferences(o)}var t=this,i=new Date,n=20,o=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e="-drafts-data",i=null;i=t.key?t.key+e:(t.container.parentNode.id||"ue-common")+e;o=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+i},contentchange:function(){if(o){t._saveFlag&&window.clearTimeout(t._saveFlag);t.options.saveInterval>0?t._saveFlag=window.setTimeout(function(){e(t)},t.options.saveInterval):e(t)}}},commands:{clearlocaldata:{execCommand:function(e,i){o&&t.getPreferences(o)&&t.removePreferences(o)},notNeedUndo:!0,ignoreContentChange:!0},getlocaldata:{execCommand:function(e,i){return o?t.getPreferences(o)||"":""},notNeedUndo:!0,ignoreContentChange:!0},drafts:{execCommand:function(e,i){if(o){t.body.innerHTML=t.getPreferences(o)||"<p>"+domUtils.fillHtml+"</p>";t.focus(!0)}},queryCommandState:function(){return o?null===t.getPreferences(o)?-1:0:-1},notNeedUndo:!0,ignoreContentChange:!0}}}});UE.plugin.register("charts",function(){function e(e){var t,i,n,o,r,s=null,a=0;if(e.rows.length<2)return!1;if(e.rows[0].cells.length<2)return!1;s=e.rows[0].cells;a=s.length;for(t=0;i=s[t];t++)if("th"!==i.tagName.toLowerCase())return!1;for(t=1;n=e.rows[t];t++){if(n.cells.length!=a)return!1;if("th"!==n.cells[0].tagName.toLowerCase())return!1;for(o=1;i=n.cells[o];o++){r=utils.trim(i.innerText||i.textContent||"");
r=r.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,"");if(!/^\d*\.?\d+$/.test(r))return!1}}return!0}var t=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(i,n){var o,r=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",!0),s=[],a={};if(!r)return!1;if(!e(r)){t.fireEvent("chartserror");return!1}a.title=n.title||"";a.subTitle=n.subTitle||"";a.xTitle=n.xTitle||"";a.yTitle=n.yTitle||"";a.suffix=n.suffix||"";a.tip=n.tip||"";a.dataFormat=n.tableDataFormat||"";a.chartType=n.chartType||0;for(o in a)a.hasOwnProperty(o)&&s.push(o+":"+a[o]);r.setAttribute("data-chart",s.join(";"));domUtils.addClass(r,"edui-charts-table")},queryCommandState:function(t,i){var n=domUtils.findParentByTagName(this.selection.getRange().startContainer,"table",!0);return n&&e(n)?0:-1}}},inputRule:function(e){utils.each(e.getNodesByTagName("table"),function(e){void 0!==e.getAttr("data-chart")&&e.setAttr("style")})},outputRule:function(e){utils.each(e.getNodesByTagName("table"),function(e){void 0!==e.getAttr("data-chart")&&e.setAttr("style","display: none;")})}}});UE.plugin.register("section",function(){function e(e){this.tag="";this.level=-1,this.dom=null;this.nextSection=null;this.previousSection=null;this.parentSection=null;this.startAddress=[];this.endAddress=[];this.children=[]}function t(t){var i=new e;return utils.extend(i,t)}function i(e,t){var i,n=t;for(i=0;i<e.length;i++){if(!n.childNodes)return null;n=n.childNodes[e[i]]}return n}var n=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){n.fireEvent("updateSections")}},bindEvents:{ready:function(){n.fireEvent("updateSections");domUtils.on(n.body,"drop paste",function(){n.fireEvent("updateSections")})},afterexeccommand:function(e,t){"paragraph"==t&&n.fireEvent("updateSections")},keyup:function(e,t){var i,n=this,o=n.selection.getRange();if(1!=o.collapsed)n.fireEvent("updateSections");else{i=t.keyCode||t.which;13!=i&&8!=i&&46!=i||n.fireEvent("updateSections")}}},commands:{getsections:{execCommand:function(e,i){function n(e){for(var t=0;t<d.length;t++)if(d[t](e))return t;return-1}function o(e,i){var r,a,d,c,u,m,f,h=null,p=e.childNodes;for(c=0,u=p.length;c<u;c++){d=p[c];r=n(d);if(r>=0){m=s.selection.getRange().selectNode(d).createAddress(!0).startAddress,f=t({tag:d.tagName,title:d.innerText||d.textContent||"",level:r,dom:d,startAddress:utils.clone(m,[]),endAddress:utils.clone(m,[]),children:[]});l.nextSection=f;f.previousSection=l;a=l;for(;r<=a.level;)a=a.parentSection;f.parentSection=a;a.children.push(f);h=l=f}else{1===d.nodeType&&o(d,i);h&&h.endAddress[h.endAddress.length-1]++}}}var r,s,a,l,d=i||["h1","h2","h3","h4","h5","h6"];for(r=0;r<d.length;r++)"string"==typeof d[r]?d[r]=function(e){return function(t){return t.tagName==e.toUpperCase()}}(d[r]):"function"!=typeof d[r]&&(d[r]=function(e){return null});s=this,a=t({level:-1,title:"root"}),l=a;o(s.body,a);return a},notNeedUndo:!0},movesection:{execCommand:function(e,t,n,o){function r(e,t,i){var n,o=!1,r=!1;for(n=0;n<e.length&&!(n>=i.length);n++){if(i[n]>e[n]){o=!0;break}if(i[n]<e[n])break}for(n=0;n<t.length&&!(n>=i.length);n++){if(i[n]<e[n]){r=!0;break}if(i[n]>e[n])break}return o&&r}var s,a,l,d,c,u,m=this;if(t&&n&&n.level!=-1){s=o?n.endAddress:n.startAddress;a=i(s,m.body);if(s&&a&&!r(t.startAddress,t.endAddress,s)){l=i(t.startAddress,m.body),d=i(t.endAddress,m.body);if(o){c=d;for(;c&&!(domUtils.getPosition(l,c)&domUtils.POSITION_FOLLOWING);){u=c.previousSibling;domUtils.insertAfter(a,c);if(c==l)break;c=u}}else{c=l;for(;c&&!(domUtils.getPosition(c,d)&domUtils.POSITION_FOLLOWING);){u=c.nextSibling;a.parentNode.insertBefore(c,a);if(c==d)break;c=u}}m.fireEvent("updateSections")}}}},deletesection:{execCommand:function(e,t,i){function n(e){var t,i=l.body;for(t=0;t<e.length;t++){if(!i.childNodes)return null;i=i.childNodes[e[t]]}return i}var o,r,s,a,l=this;if(t){o=n(t.startAddress),r=n(t.endAddress),s=o;if(i)domUtils.remove(s);else for(;s&&domUtils.inDoc(r,l.document)&&!(domUtils.getPosition(s,r)&domUtils.POSITION_FOLLOWING);){a=s.nextSibling;domUtils.remove(s);s=a}l.fireEvent("updateSections")}}},selectsection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var i=this,n=i.selection.getRange(),o={startAddress:utils.clone(t.startAddress,[]),endAddress:utils.clone(t.endAddress,[])};o.endAddress[o.endAddress.length-1]++;n.moveToAddress(o).select().scrollToView();return!0},notNeedUndo:!0},scrolltosection:{execCommand:function(e,t){if(!t&&!t.dom)return!1;var i=this,n=i.selection.getRange(),o={startAddress:t.startAddress,endAddress:t.endAddress};o.endAddress[o.endAddress.length-1]++;n.moveToAddress(o).scrollToView();return!0},notNeedUndo:!0}}}});UE.plugin.register("simpleupload",function(){function e(){var e=t.offsetWidth||20,o=t.offsetHeight||20,r=document.createElement("iframe"),s="display:block;width:"+e+"px;height:"+o+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";domUtils.on(r,"load",function(){var t,a,l,d,c=(+new Date).toString(36),u=r.contentDocument||r.contentWindow.document,m=u.body,f=u.createElement("div");f.innerHTML='<form id="edui_form_'+c+'" target="edui_iframe_'+c+'" method="POST" enctype="multipart/form-data" action="'+i.getOpt("serverUrl")+'" style="'+s+'"><input id="edui_input_'+c+'" type="file" accept="image/*" name="'+i.options.imageFieldName+'" style="'+s+'"></form><iframe id="edui_iframe_'+c+'" name="edui_iframe_'+c+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';f.className="edui-"+i.options.theme;f.id=i.ui.id+"_iframeupload";m.style.cssText=s;m.style.width=e+"px";m.style.height=o+"px";m.appendChild(f);if(m.parentNode){m.parentNode.style.width=e+"px";m.parentNode.style.height=e+"px"}t=u.getElementById("edui_form_"+c);a=u.getElementById("edui_input_"+c);l=u.getElementById("edui_iframe_"+c);domUtils.on(a,"change",function(){function e(){try{var r,s,a,d=(l.contentDocument||l.contentWindow.document).body,c=d.innerText||d.textContent||"";s=new Function("return "+c)();r=i.options.imageUrlPrefix+s.url;if("SUCCESS"==s.state&&s.url){a=i.document.getElementById(o);a.setAttribute("src",r);a.setAttribute("_src",r);a.setAttribute("title",s.title||"");a.setAttribute("alt",s.original||"");a.removeAttribute("id");domUtils.removeClasses(a,"loadingclass")}else n&&n(s.state)}catch(e){n&&n(i.getLang("simpleupload.loadError"))}t.reset();domUtils.un(l,"load",e)}function n(e){if(o){var t=i.document.getElementById(o);t&&domUtils.remove(t);i.fireEvent("showmessage",{id:o,content:e,type:"error",timeout:4e3})}}var o,r,s,d,c,u;if(a.value){o="loading_"+(+new Date).toString(36);r=utils.serializeParam(i.queryCommandValue("serverparam"))||"";s=i.getActionUrl(i.getOpt("imageActionName"));d=i.getOpt("imageAllowFiles");i.focus();i.execCommand("inserthtml",'<img class="loadingclass" id="'+o+'" src="'+i.options.themePath+i.options.theme+'/images/spacer.gif" title="'+(i.getLang("simpleupload.loading")||"")+'" >');if(i.getOpt("imageActionName")){c=a.value,u=c?c.substr(c.lastIndexOf(".")):"";if(!u||d&&(d.join("")+".").indexOf(u.toLowerCase()+".")==-1)n(i.getLang("simpleupload.exceedTypeError"));else{domUtils.on(l,"load",e);t.action=utils.formatUrl(s+(s.indexOf("?")==-1?"?":"&")+r);t.submit()}}else errorHandler(i.getLang("autoupload.errorLoadConfig"))}});i.addListener("selectionchange",function(){clearTimeout(d);d=setTimeout(function(){var e=i.queryCommandState("simpleupload");e==-1?a.disabled="disabled":a.disabled=!1},400)});n=!0});r.style.cssText=s;t.appendChild(r)}var t,i=this,n=!1;return{bindEvents:{ready:function(){utils.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(n,o){t=o;i.afterConfigReady(e)}},outputRule:function(e){utils.each(e.getNodesByTagName("img"),function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},commands:{simpleupload:{queryCommandState:function(){return n?0:-1}}}}});UE.plugin.register("serverparam",function(){var e={};return{commands:{serverparam:{execCommand:function(t,i,n){void 0===i||null===i?e={}:utils.isString(i)?void 0===n||null===n?delete e[i]:e[i]=n:utils.isObject(i)?utils.extend(e,i,!0):utils.isFunction(i)&&utils.extend(e,i(),!0)},queryCommandValue:function(){return e||{}}}}}});UE.plugin.register("insertfile",function(){function e(e){var t=e.substr(e.lastIndexOf(".")+1).toLowerCase(),i={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return i[t]?i[t]:i["txt"]}var t=this;return{commands:{insertfile:{execCommand:function(i,n){n=utils.isArray(n)?n:[n];var o,r,s,a,l="",d=t.getOpt("UEDITOR_HOME_URL"),c=d+("/"==d.substr(d.length-1)?"":"/")+"dialogs/attachment/fileTypeImages/";for(o=0;o<n.length;o++){r=n[o];s=c+e(r.url);a=r.title||r.url.substr(r.url.lastIndexOf("/")+1);l+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+s+'" _src="'+s+'" /><a style="font-size:12px; color:#0066cc;" href="'+r.url+'" title="'+a+'">'+a+"</a></p>"}t.execCommand("insertHtml",l)}}}}});UE.plugins.xssFilter=function(){function e(e){var t=e.tagName,i=e.attrs;if(!n.hasOwnProperty(t)){e.parentNode.removeChild(e);return!1}UE.utils.each(i,function(i,o){n[t].indexOf(o)===-1&&e.setAttr(o)})}var t,i=UEDITOR_CONFIG,n=i.whitList;n&&i.xssFilterRules&&(this.options.filterRules=function(){var t={};UE.utils.each(n,function(i,n){t[n]=function(t){return e(t)}});return t}());t=[];UE.utils.each(n,function(e,i){t.push(i)});n&&i.inputXssFilter&&this.addInputRule(function(t){t.traversal(function(t){if("element"!==t.type)return!1;e(t)})});n&&i.outputXssFilter&&this.addOutputRule(function(t){t.traversal(function(t){if("element"!==t.type)return!1;e(t)})})};baidu=baidu||{};baidu.editor=baidu.editor||{};UE.ui=baidu.editor.ui={};!function(){function e(){var e=document.getElementById("edui_fixedlayer");l.setViewportOffset(e,{left:0,top:0})}function t(t){n.on(window,"scroll",e);n.on(window,"resize",baidu.editor.utils.defer(e,0,!0))}var i=baidu.editor.browser,n=baidu.editor.dom.domUtils,o="$EDITORUI",r=window[o]={},s="ID"+o,a=0,l=baidu.editor.ui.uiUtils={uid:function(e){return e?e[s]||(e[s]=++a):++a},hook:function(e,t){var i;if(e&&e._callbacks)i=e;else{i=function(){var t,n,o,r;e&&(t=e.apply(this,arguments));n=i._callbacks;o=n.length;for(;o--;){r=n[o].apply(this,arguments);void 0===t&&(t=r)}return t};i._callbacks=[]}i._callbacks.push(t);return i},createElementByHtml:function(e){var t=document.createElement("div");t.innerHTML=e;t=t.firstChild;t.parentNode.removeChild(t);return t},getViewportElement:function(){return i.ie&&i.quirks?document.body:document.documentElement},getClientRect:function(e){var t,i,o;try{t=e.getBoundingClientRect()}catch(e){t={left:0,top:0,height:0,width:0}}i={left:Math.round(t.left),top:Math.round(t.top),height:Math.round(t.bottom-t.top),width:Math.round(t.right-t.left)};for(;(o=e.ownerDocument)!==document&&(e=n.getWindow(o).frameElement);){t=e.getBoundingClientRect();i.left+=t.left;i.top+=t.top}i.bottom=i.top+i.height;i.right=i.left+i.width;return i},getViewportRect:function(){var e=l.getViewportElement(),t=0|(window.innerWidth||e.clientWidth),i=0|(window.innerHeight||e.clientHeight);return{left:0,top:0,height:i,width:t,bottom:i,right:t}},setViewportOffset:function(e,t){var i=l.getFixedLayer();if(e.parentNode===i){e.style.left=t.left+"px";e.style.top=t.top+"px"}else n.setViewportOffset(e,t)},getEventOffset:function(e){var t=e.target||e.srcElement,i=l.getClientRect(t),n=l.getViewportOffsetByEvent(e);return{left:n.left-i.left,top:n.top-i.top}},getViewportOffsetByEvent:function(e){var t,i=e.target||e.srcElement,o=n.getWindow(i).frameElement,r={left:e.clientX,top:e.clientY};if(o&&i.ownerDocument!==document){t=l.getClientRect(o);r.left+=t.left;r.top+=t.top}return r},setGlobal:function(e,t){r[e]=t;return o+'["'+e+'"]'},unsetGlobal:function(e){delete r[e]},copyAttributes:function(e,t){for(var o,r=t.attributes,s=r.length;s--;){o=r[s];"style"==o.nodeName||"class"==o.nodeName||i.ie&&!o.specified||e.setAttribute(o.nodeName,o.nodeValue)}t.className&&n.addClass(e,t.className);t.style.cssText&&(e.style.cssText+=";"+t.style.cssText)},removeStyle:function(e,t){if(e.style.removeProperty)e.style.removeProperty(t);else{if(!e.style.removeAttribute)throw"";e.style.removeAttribute(t)}},contains:function(e,t){return e&&t&&e!==t&&(e.contains?e.contains(t):16&e.compareDocumentPosition(t))},startDrag:function(e,t,i){function n(e){var i=e.clientX-s,n=e.clientY-a;t.ondragmove(i,n,e);e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function o(e){i.removeEventListener("mousemove",n,!0);i.removeEventListener("mouseup",o,!0);window.removeEventListener("mouseup",o,!0);t.ondragstop()}function r(){l.releaseCapture();l.detachEvent("onmousemove",n);l.detachEvent("onmouseup",r);l.detachEvent("onlosecaptrue",r);t.ondragstop()}var s,a,l;i=i||document;s=e.clientX;a=e.clientY;if(i.addEventListener){i.addEventListener("mousemove",n,!0);i.addEventListener("mouseup",o,!0);window.addEventListener("mouseup",o,!0);e.preventDefault()}else{l=e.srcElement;l.setCapture();l.attachEvent("onmousemove",n);l.attachEvent("onmouseup",r);l.attachEvent("onlosecaptrue",r);e.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var n=document.getElementById("edui_fixedlayer");if(null==n){n=document.createElement("div");n.id="edui_fixedlayer";document.body.appendChild(n);if(i.ie&&i.version<=8){n.style.position="absolute";t();setTimeout(e)}else n.style.position="fixed";n.style.left="0";n.style.top="0";n.style.width="0";n.style.height="0"}return n},makeUnselectable:function(e){if(i.opera||i.ie&&i.version<9){e.unselectable="on";if(e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++)1==e.childNodes[t].nodeType&&l.makeUnselectable(e.childNodes[t])}else void 0!==e.style.MozUserSelect?e.style.MozUserSelect="none":void 0!==e.style.WebkitUserSelect?e.style.WebkitUserSelect="none":void 0!==e.style.KhtmlUserSelect&&(e.style.KhtmlUserSelect="none")}}}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.EventBase,n=baidu.editor.ui.UIBase=function(){};n.prototype={className:"",uiName:"",initOptions:function(e){var i,n=this;for(i in e)n[i]=e[i];this.id=this.id||"edui"+t.uid()},initUIBase:function(){this._globalKey=e.unhtml(t.setGlobal(this.id,this))},render:function(e){var i,n,o,r=this.renderHtml(),s=t.createElementByHtml(r),a=domUtils.getElementsByTagName(s,"*"),l="edui-"+(this.theme||this.editor.options.theme),d=document.getElementById("edui_fixedlayer");for(i=0;n=a[i++];)domUtils.addClass(n,l);domUtils.addClass(s,l);if(d){d.className="";domUtils.addClass(d,l)}o=this.getDom();if(null!=o){o.parentNode.replaceChild(s,o);t.copyAttributes(s,o)}else{"string"==typeof e&&(e=document.getElementById(e));e=e||t.getFixedLayer();domUtils.addClass(e,l);e.appendChild(s)}this.postRender()},getDom:function(e){return e?document.getElementById(this.id+"_"+e):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(e){var t="edui-"+this.uiName;return e.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var e=this.getDom();e&&baidu.editor.dom.domUtils.remove(e);t.unsetGlobal(this.id)}};e.inherits(n,i)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Separator=function(e){this.initOptions(e);this.initSeparator()};i.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};e.inherits(i,t)}();!function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.UIBase,n=baidu.editor.ui.uiUtils,o=baidu.editor.ui.Mask=function(e){this.initOptions(e);this.initUIBase()};o.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;t.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return"none"==this.getDom().style.display},_onMouseDown:function(){return!1},_onClick:function(e,t){this.fireEvent("click",e,t)},_fill:function(){var e=this.getDom(),t=n.getViewportRect();e.style.width=t.width+"px";e.style.height=t.height+"px"}};e.inherits(o,i)}();!function(){function e(e,t){var i,n;for(i=0;i<a.length;i++){n=a[i];if(!n.isHidden()&&n.queryAutoHide(t)!==!1){if(e&&/scroll/gi.test(e.type)&&"edui-wordpastepop"==n.className)return;n.hide()}}a.length&&n.editor.fireEvent("afterhidepop")}var t,i=baidu.editor.utils,n=baidu.editor.ui.uiUtils,o=baidu.editor.dom.domUtils,r=baidu.editor.ui.UIBase,s=baidu.editor.ui.Popup=function(e){this.initOptions(e);this.initPopup()},a=[];s.postHide=e;t=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];s.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase();a.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return this.content?"string"==typeof this.content?this.content:this.content.renderHtml():""},_UIBase_postRender:r.prototype.postRender,postRender:function(){this.content instanceof r&&this.content.postRender();if(this.captureWheel&&!this.captured){this.captured=!0;var e=(document.documentElement.clientHeight||document.body.clientHeight)-80,t=this.getDom().offsetHeight,i=n.getClientRect(this.combox.getDom()).top,s=this.getDom("content"),a=this.getDom("body").getElementsByTagName("iframe"),l=this;a.length&&(a=a[0]);for(;i+t>e;)t-=30;s.style.height=t+"px";a&&(a.style.height=t+"px");window.XMLHttpRequest?o.on(s,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;e.wheelDelta?s.scrollTop-=e.wheelDelta/120*60:s.scrollTop-=e.detail/-3*60}):o.on(this.getDom(),"mousewheel",function(e){e.returnValue=!1;l.getDom("content").scrollTop-=e.wheelDelta/120*60})}this.fireEvent("postRenderAfter");this.hide(!0);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var e=this.getDom("content");return n.getClientRect(e)},fitSize:function(){var e,t,i;if(this.captureWheel&&this.sized)return this.__size;this.sized=!0;e=this.getDom("body");e.style.width="";e.style.height="";t=this.mesureSize();if(this.captureWheel){e.style.width=-(-20-t.width)+"px";i=parseInt(this.getDom("content").style.height,10);!window.isNaN(i)&&(t.height=i)}else e.style.width=t.width+"px";e.style.height=t.height+"px";this.__size=t;this.captureWheel&&(this.getDom("content").style.overflow="auto");return t},showAnchor:function(e,t){this.showAnchorRect(n.getClientRect(e),t)},showAnchorRect:function(e,i,r){var s,a,l,d,c,u,m;this._doAutoRender();s=n.getViewportRect();this.getDom().style.visibility="hidden";this._show();a=this.fitSize();if(i){l=this.canSideLeft&&e.right+a.width>s.right&&e.left>a.width;d=this.canSideUp&&e.top+a.height>s.bottom&&e.bottom>a.height;c=l?e.left-a.width:e.right;u=d?e.bottom-a.height:e.top}else{l=this.canSideLeft&&e.right+a.width>s.right&&e.left>a.width;d=this.canSideUp&&e.top+a.height>s.bottom&&e.bottom>a.height;c=l?e.right-a.width:e.left;u=d?e.top-a.height:e.bottom}m=this.getDom();n.setViewportOffset(m,{left:c,top:u});o.removeClasses(m,t);m.className+=" "+t[2*(d?1:0)+(l?1:0)];if(this.editor){m.style.zIndex=1*this.editor.container.style.zIndex+10;baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=m.style.zIndex-1}this.getDom().style.visibility="visible"},showAt:function(e){var t=e.left,i=e.top,n={left:t,top:i,right:t,bottom:i,height:0,width:0};this.showAnchorRect(n,!1,!0)},_show:function(){if(this._hidden){var e=this.getDom();e.style.display="";this._hidden=!1;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(e){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=!0;e||this.fireEvent("hide")}},queryAutoHide:function(e){return!e||!n.contains(this.getDom(),e)}};i.inherits(s,r);o.on(document,"mousedown",function(t){var i=t.target||t.srcElement;e(t,i)});o.on(window,"scroll",function(t,i){e(t,i)})}();!function(){function e(e,i){var n,o='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+i.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(n=0;n<t.length;n++){n&&n%10===0&&(o+="</tr>"+(60==n?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+i.getLang("standardColor")+"</td></tr>":"")+"<tr"+(60==n?' class="edui-colorpicker-tablefirstrow"':"")+">");o+=n<70?'<td style="padding: 0 2px;"><a hidefocus title="'+t[n]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+t[n]+'" style="background-color:#'+t[n]+";border:solid #ccc;"+(n<10||n>=60?"border-width:1px;":n>=10&&n<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}o+="</tr></table></div>";return o}var t,i=baidu.editor.utils,n=baidu.editor.ui.UIBase,o=baidu.editor.ui.ColorPicker=function(e){this.initOptions(e);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};o.prototype={getHtmlTpl:function(){return e(this.noColorText,this.editor)},_onTableClick:function(e){var t=e.target||e.srcElement,i=t.getAttribute("data-color");i&&this.fireEvent("pickcolor",i)},_onTableOver:function(e){var t=e.target||e.srcElement,i=t.getAttribute("data-color");i&&(this.getDom("preview").style.backgroundColor=i)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};i.inherits(o,n);t="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.ui.UIBase,n=baidu.editor.ui.TablePicker=function(e){this.initOptions(e);this.initTablePicker()};n.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:i.prototype.render,render:function(e){this._UIBase_render(e);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(e,t){var i,n=this.getDom("overlay").style,o=this.lengthOfCellSide;n.width=e*o+"px";n.height=t*o+"px";i=this.getDom("label");i.innerHTML=e+this.editor.getLang("t_col")+" x "+t+this.editor.getLang("t_row");this.numCols=e;this.numRows=t},_onMouseOver:function(e,i){var n=e.relatedTarget||e.fromElement;if(!t.contains(i,n)&&i!==n){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(e,i){var n=e.relatedTarget||e.toElement;if(!t.contains(i,n)&&i!==n){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(e,i){var n=(this.getDom("overlay").style,t.getEventOffset(e)),o=this.lengthOfCellSide,r=Math.ceil(n.left/o),s=Math.ceil(n.top/o);this._track(r,s)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};e.inherits(n,i)}();!function(){var e=baidu.editor.browser,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.uiUtils,n='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(e.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');baidu.editor.ui.Stateful={alwalysHoverable:!1,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var e=this._Stateful_dGetHtmlTpl();return e.replace(/stateful/g,function(){return n})},Stateful_onMouseEnter:function(e,t){this.target=t;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(e,t){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(e,t){var n=e.relatedTarget;i.contains(t,n)||t===n||this.Stateful_onMouseEnter(e,t)},Stateful_onMouseOut:function(e,t){var n=e.relatedTarget;i.contains(t,n)||t===n||this.Stateful_onMouseLeave(e,t)},Stateful_onMouseDown:function(e,t){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(e,t){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(e){return t.hasClass(this.getStateDom(),"edui-state-"+e)},addState:function(e){this.hasState(e)||(this.getStateDom().className+=" edui-state-"+e)},removeState:function(e){this.hasState(e)&&t.removeClasses(this.getStateDom(),["edui-state-"+e])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(e){!this.isDisabled()&&e?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(e){if(e){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else this.removeState("disabled")}}}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Stateful,n=baidu.editor.ui.Button=function(e){var t,i;if(e.name){t=e.name;i=e.cssRules;e.className||(e.className="edui-for-"+t);e.cssRules=".edui-default  .edui-for-"+t+" .edui-icon {"+i+"}"}this.initOptions(e);this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,cssRules:"",initButton:function(){this.initUIBase();this.Stateful_init();this.cssRules&&e.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onMouseDown:function(e){var t=e.target||e.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if("input"==i||"object"==i||"object"==i)return!1},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(e){var t=this.getDom("label");t.innerHTML=e}};e.inherits(n,t);e.extend(n.prototype,i)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=(baidu.editor.dom.domUtils,baidu.editor.ui.UIBase),n=baidu.editor.ui.Stateful,o=baidu.editor.ui.SplitButton=function(e){this.initOptions(e);this.initSplitButton()};o.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var e,t;this.initUIBase();this.Stateful_init();e=this;if(null!=this.popup){t=this.popup;this.popup=null;this.setPopup(t)}},_UIBase_postRender:i.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},setPopup:function(i){if(this.popup!==i){null!=this.popup&&this.popup.dispose();i.addListener("show",e.bind(this._onPopupShow,this));i.addListener("hide",e.bind(this._onPopupHide,this));i.addListener("postrender",e.bind(function(){i.getDom("body").appendChild(t.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(t.getClientRect(this.getDom()).width+20)+'px"></div>'));i.getDom().className+=" "+this.className},this));this.popup=i}},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var e=t.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS;e.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(e)},_onArrowClick:function(e,t){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick");
}};e.inherits(o,i);e.extend(o.prototype,n,!0)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.ui.ColorPicker,n=baidu.editor.ui.Popup,o=baidu.editor.ui.SplitButton,r=baidu.editor.ui.ColorButton=function(e){this.initOptions(e);this.initColorButton()};r.prototype={initColorButton:function(){var e=this;this.popup=new n({content:new i({noColorText:e.editor.getLang("clearColor"),editor:e.editor,onpickcolor:function(t,i){e._onPickColor(i)},onpicknocolor:function(t,i){e._onPickNoColor(i)}}),editor:e.editor});this.initSplitButton()},_SplitButton_postRender:o.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton"},setColor:function(e){this.getDom("colorlump").style.backgroundColor=e;this.color=e},_onPickColor:function(e){if(this.fireEvent("pickcolor",e)!==!1){this.setColor(e);this.popup.hide()}},_onPickNoColor:function(e){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}};e.inherits(r,o)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,i=baidu.editor.ui.TablePicker,n=baidu.editor.ui.SplitButton,o=baidu.editor.ui.TableButton=function(e){this.initOptions(e);this.initTableButton()};o.prototype={initTableButton:function(){var e=this;this.popup=new t({content:new i({editor:e.editor,onpicktable:function(t,i,n){e._onPickTable(i,n)}}),editor:e.editor});this.initSplitButton()},_onPickTable:function(e,t){this.fireEvent("picktable",e,t)!==!1&&this.popup.hide()}};e.inherits(o,n)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.AutoTypeSetPicker=function(e){this.initOptions(e);this.initAutoTypeSetPicker()};i.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){var e=this.editor,t=e.options.autotypeset,i=e.getLang("autoTypeSet"),n="textAlignValue"+e.uid,o="imageBlockLineValue"+e.uid,r="symbolConverValue"+e.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(t["mergeEmptyline"]?"checked":"")+">"+i.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(t["removeEmptyline"]?"checked":"")+">"+i.delLine+'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(t["removeClass"]?"checked":"")+">"+i.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(t["indent"]?"checked":"")+">"+i.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(t["textAlign"]?"checked":"")+">"+i.alignment+'</td><td colspan="2" id="'+n+'"><input type="radio" name="'+n+'" value="left" '+(t["textAlign"]&&"left"==t["textAlign"]?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+n+'" value="center" '+(t["textAlign"]&&"center"==t["textAlign"]?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+n+'" value="right" '+(t["textAlign"]&&"right"==t["textAlign"]?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(t["imageBlockLine"]?"checked":"")+">"+i.imageFloat+'</td><td nowrap id="'+o+'"><input type="radio" name="'+o+'" value="none" '+(t["imageBlockLine"]&&"none"==t["imageBlockLine"]?"checked":"")+">"+e.getLang("default")+'<input type="radio" name="'+o+'" value="left" '+(t["imageBlockLine"]&&"left"==t["imageBlockLine"]?"checked":"")+">"+e.getLang("justifyleft")+'<input type="radio" name="'+o+'" value="center" '+(t["imageBlockLine"]&&"center"==t["imageBlockLine"]?"checked":"")+">"+e.getLang("justifycenter")+'<input type="radio" name="'+o+'" value="right" '+(t["imageBlockLine"]&&"right"==t["imageBlockLine"]?"checked":"")+">"+e.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(t["clearFontSize"]?"checked":"")+">"+i.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(t["clearFontFamily"]?"checked":"")+">"+i.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(t["removeEmptyNode"]?"checked":"")+">"+i.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(t["pasteFilter"]?"checked":"")+">"+i.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(t["bdc2sb"]||t["tobdc"]?"checked":"")+">"+i.symbol+'</td><td id="'+r+'"><input type="radio" name="bdc" value="bdc2sb" '+(t["bdc2sb"]?"checked":"")+">"+i.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(t["tobdc"]?"checked":"")+">"+i.tobdc+'</td><td nowrap align="right"><button >'+i.run+"</button></td></tr></table></div></div>"},_UIBase_render:t.prototype.render};e.inherits(i,t)}();!function(){function e(e){var i,n,o,r,s,a,l,d,c,u={},m=e.getDom(),f=e.editor.uid,h=null,p=null,g=domUtils.getElementsByTagName(m,"input");for(i=g.length-1;n=g[i--];){h=n.getAttribute("type");if("checkbox"==h){p=n.getAttribute("name");u[p]&&delete u[p];if(n.checked){o=document.getElementById(p+"Value"+f);if(o)if(/input/gi.test(o.tagName))u[p]=o.value;else{r=o.getElementsByTagName("input");for(s=r.length-1;a=r[s--];)if(a.checked){u[p]=a.value;break}}else u[p]=!0}else u[p]=!1}else u[n.getAttribute("value")]=n.checked}l=domUtils.getElementsByTagName(m,"select");for(i=0;d=l[i++];){c=d.getAttribute("name");u[c]=u[c]?d.value:""}t.extend(e.editor.options.autotypeset,u);e.editor.setPreferences("autotypeset",u)}var t=baidu.editor.utils,i=baidu.editor.ui.Popup,n=baidu.editor.ui.AutoTypeSetPicker,o=baidu.editor.ui.SplitButton,r=baidu.editor.ui.AutoTypeSetButton=function(e){this.initOptions(e);this.initAutoTypeSetButton()};r.prototype={initAutoTypeSetButton:function(){var t,o=this;this.popup=new i({content:new n({editor:o.editor}),editor:o.editor,hide:function(){if(!this._hidden&&this.getDom()){e(this);this.getDom().style.display="none";this._hidden=!0;this.fireEvent("hide")}}});t=0;this.popup.addListener("postRenderAfter",function(){var i,n,r=this;if(!t){i=this.getDom(),n=i.getElementsByTagName("button")[0];n.onclick=function(){e(r);o.editor.execCommand("autotypeset");r.hide()};domUtils.on(i,"click",function(t){var i,n,s,a,l,d,c=t.target||t.srcElement,u=o.editor.uid;if(c&&"INPUT"==c.tagName){if("imageBlockLine"==c.name||"textAlign"==c.name||"symbolConver"==c.name){i=c.checked,n=document.getElementById(c.name+"Value"+u),s=n.getElementsByTagName("input"),a={imageBlockLine:"none",textAlign:"left",symbolConver:"tobdc"};for(l=0;l<s.length;l++)i?s[l].value==a[c.name]&&(s[l].checked="checked"):s[l].checked=!1}if(c.name=="imageBlockLineValue"+u||c.name=="textAlignValue"+u||"bdc"==c.name){d=c.parentNode.previousSibling.getElementsByTagName("input");d&&(d[0].checked=!0)}e(r)}});t=1}});this.initSplitButton()}};t.inherits(r,o)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,i=baidu.editor.ui.Stateful,n=baidu.editor.ui.UIBase,o=baidu.editor.ui.CellAlignPicker=function(e){this.initOptions(e);this.initSelected();this.initCellAlignPicker()};o.prototype={initSelected:function(){var e={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};this.selected&&(this.selectedIndex=e.valign[this.selected.valign]*e.count+e.align[this.selected.align])},initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){var e,t=["left","center","right"],i=9,n=null,o=-1,r=[];for(e=0;e<i;e++){n=this.selectedIndex===e?' class="edui-cellalign-selected" ':"";o=e%3;0===o&&r.push("<tr>");r.push('<td index="'+e+'" '+n+' stateful><div class="edui-icon edui-'+t[o]+'"></div></td>');2===o&&r.push("</tr>")}return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+r.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(e){var i=e.target||e.srcElement;if(/icon/.test(i.className)){this.items[i.parentNode.getAttribute("index")].onclick();t.postHide(e)}},_UIBase_render:n.prototype.render};e.inherits(o,n);e.extend(o.prototype,i,!0)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.Stateful,i=baidu.editor.ui.uiUtils,n=baidu.editor.ui.UIBase,o=baidu.editor.ui.PastePicker=function(e){this.initOptions(e);this.initPastePicker()};o.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=!0;this.editor.fireEvent("pasteTransfer",e)},_onClick:function(e){var t=domUtils.getNextDomNode(e),n=i.getViewportRect().height,o=i.getClientRect(t);o.top+o.height>n?t.style.top=-o.height-e.offsetHeight+"px":t.style.top="";if(/hidden/gi.test(domUtils.getComputedStyle(t,"visibility"))){t.style.visibility="visible";domUtils.addClass(e,"edui-state-opened")}else{t.style.visibility="hidden";domUtils.removeClasses(e,"edui-state-opened")}},_UIBase_render:n.prototype.render};e.inherits(o,n);e.extend(o.prototype,t,!0)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.ui.UIBase,n=baidu.editor.ui.Toolbar=function(e){this.initOptions(e);this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(e,t){void 0===t?this.items.push(e):this.items.splice(t,0,e)},getHtmlTpl:function(){var e,t=[];for(e=0;e<this.items.length;e++)t[e]=this.items[e].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"</div>"},postRender:function(){var e,i=this.getDom();for(e=0;e<this.items.length;e++)this.items[e].postRender();t.makeUnselectable(i)},_onMouseDown:function(e){var t=e.target||e.srcElement,i=t&&t.tagName&&t.tagName.toLowerCase();if("input"==i||"object"==i||"object"==i)return!1}};e.inherits(n,i)}();!function(){var e,t=baidu.editor.utils,i=baidu.editor.dom.domUtils,n=baidu.editor.ui.uiUtils,o=baidu.editor.ui.UIBase,r=baidu.editor.ui.Popup,s=baidu.editor.ui.Stateful,a=baidu.editor.ui.CellAlignPicker,l=baidu.editor.ui.Menu=function(e){this.initOptions(e);this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}};l.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){var t,i;for(t=0;t<this.items.length;t++){i=this.items[t];if("-"==i)this.items[t]=this.getSeparator();else if(!(i instanceof e)){i.editor=this.editor;i.theme=this.editor.options.theme;this.items[t]=this.createItem(i)}}},getSeparator:function(){return d},createItem:function(t){t.menu=this;return new e(t)},_Popup_getContentHtmlTpl:r.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){var e,t,i;if(0==this.items.length)return this._Popup_getContentHtmlTpl();e=[];for(t=0;t<this.items.length;t++){i=this.items[t];e[t]=i.renderHtml()}return'<div class="%%-body">'+e.join("")+"</div>"},_Popup_postRender:r.prototype.postRender,postRender:function(){var e,t,o=this;for(e=0;e<this.items.length;e++){t=this.items[e];t.ownerMenu=this;t.postRender()}i.on(this.getDom(),"mouseover",function(e){var t,i;e=e||event;t=e.relatedTarget||e.fromElement;i=o.getDom();n.contains(i,t)||i===t||o.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(e){var t,i;if(e){if(n.contains(this.getDom(),e))return!1;for(t=0;t<this.items.length;t++){i=this.items[t];if(i.queryAutoHide(e)===!1)return!1}}},clearItems:function(){var e,t;for(e=0;e<this.items.length;e++){t=this.items[e];clearTimeout(t._showingTimer);clearTimeout(t._closingTimer);t.subMenu&&t.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&i.remove(this.getDom());this.clearItems()},dispose:function(){this.destroy()}};t.inherits(l,r);e=baidu.editor.ui.MenuItem=function(e){this.initOptions(e);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof l))if(e.className&&e.className.indexOf("aligntd")!=-1){var t=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment");this.subMenu=new r({content:new a(this.subMenu),parentMenu:t,editor:t.editor,destroy:function(){this.getDom()&&i.remove(this.getDom())}});this.subMenu.addListener("postRenderAfter",function(){i.on(this.getDom(),"mouseover",function(){t.addState("opened")})})}else this.subMenu=new l(this.subMenu)};e.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var e=this;this.addListener("over",function(){e.ownerMenu.fireEvent("submenuover",e);e.subMenu&&e.delayShowSubMenu()});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){e.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(e._closingTimer);e._closingTimer=null;e.addState("opened")});this.ownerMenu.addListener("hide",function(){e.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(t,i){i!==e&&e.delayHideSubMenu()});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(t){return(!t||!n.contains(e.getDom(),t))&&this._bakQueryAutoHide(t)}}this.getDom().style.tabIndex="-1";n.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var e=this;if(!e.isDisabled()){e.addState("opened");clearTimeout(e._showingTimer);clearTimeout(e._closingTimer);e._closingTimer=null;e._showingTimer=setTimeout(function(){e.showSubMenu()},250)}},delayHideSubMenu:function(){var e=this;if(!e.isDisabled()){e.removeState("opened");clearTimeout(e._showingTimer);e._closingTimer||(e._closingTimer=setTimeout(function(){e.hasState("opened")||e.hideSubMenu();e._closingTimer=null},400))}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(e){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(e)},_onClick:function(e,t){this.hasState("disabled")||this.fireEvent("click",e,t)!==!1&&(this.subMenu?this.showSubMenu():r.postHide(e))},showSubMenu:function(){var e=n.getClientRect(this.getDom());e.right-=5;e.left+=2;e.width-=7;e.top-=4;e.bottom+=4;e.height+=8;this.subMenu.showAnchorRect(e,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}};t.inherits(e,o);t.extend(e.prototype,s,!0)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.uiUtils,i=baidu.editor.ui.Menu,n=baidu.editor.ui.SplitButton,o=baidu.editor.ui.Combox=function(e){this.initOptions(e);this.initCombox()};o.prototype={uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var e,t,n=this;this.items=this.items||[];for(e=0;e<this.items.length;e++){t=this.items[e];t.uiName="listitem";t.index=e;t.onclick=function(){n.selectByIndex(this.index)}}this.popup=new i({items:this.items,uiName:"list",editor:this.editor,captureWheel:!0,combox:this});this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"")},showPopup:function(){var e=t.getClientRect(this.getDom());e.top+=1;e.bottom-=1;e.height-=2;this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var t=this.indexByValue(e);if(t!=-1){this.selectedIndex=t;this.setLabel(this.items[t].label);this.value=this.items[t].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(e));this.value=e}},setLabel:function(e){this.getDom("button_body").innerHTML=e;this.label=e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var t=0;t<this.items.length;t++)if(e==this.items[t].value)return t;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){if(e<this.items.length&&this.fireEvent("select",e)!==!1){this.selectedIndex=e;this.value=this.items[e].value;this.setLabel(this.items[e].label)}}};e.inherits(o,n)}();!function(){var e,t,i,n=baidu.editor.utils,o=baidu.editor.dom.domUtils,r=baidu.editor.ui.uiUtils,s=baidu.editor.ui.Mask,a=baidu.editor.ui.UIBase,l=baidu.editor.ui.Button,d=baidu.editor.ui.Dialog=function(e){var t,i;if(e.name){t=e.name;i=e.cssRules;e.className||(e.className="edui-for-"+t);i&&(e.cssRules=".edui-default .edui-for-"+t+" .edui-dialog-content  {"+i+"}")}this.initOptions(n.extend({autoReset:!0,draggable:!0,onok:function(){},oncancel:function(){},onclose:function(e,t){return t?this.onok():this.oncancel()},holdScroll:!1},e));this.initDialog()};d.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var o,r=this,a=this.editor.options.theme;this.cssRules&&n.cssRule("edui-customize-"+this.name+"-style",this.cssRules);this.initUIBase();this.modalMask=e||(e=new s({className:"edui-dialog-modalmask",theme:a,onclick:function(){i&&i.close(!1)}}));this.dragMask=t||(t=new s({className:"edui-dialog-dragmask",theme:a}));this.closeButton=new l({className:"edui-dialog-closebutton",title:r.closeDialog,theme:a,onclick:function(){r.close(!1)}});this.fullscreen&&this.initResizeEvent();if(this.buttons)for(o=0;o<this.buttons.length;o++)this.buttons[o]instanceof l||(this.buttons[o]=new l(n.extend(this.buttons[o],{editor:this.editor},!0)))},initResizeEvent:function(){var e=this;o.on(window,"resize",function(){if(!e._hidden&&void 0!==e._hidden){e.__resizeTimer&&window.clearTimeout(e.__resizeTimer);e.__resizeTimer=window.setTimeout(function(){e.__resizeTimer=null;var t=e.getDom(),i=e.getDom("content"),n=UE.ui.uiUtils.getClientRect(t),o=UE.ui.uiUtils.getClientRect(i),s=r.getViewportRect();i.style.width=s.width-n.width+o.width+"px";i.style.height=s.height-n.height+o.height+"px";t.style.width=s.width+"px";t.style.height=s.height+"px";e.fireEvent("resize")},100)}})},fitSize:function(){var e=this.getDom("body"),t=this.mesureSize();e.style.width=t.width+"px";e.style.height=t.height+"px";return t},safeSetOffset:function(e){var t,i=this,n=i.getDom(),o=r.getViewportRect(),s=r.getClientRect(n),a=e.left;a+s.width>o.right&&(a=o.right-s.width);t=e.top;t+s.height>o.bottom&&(t=o.bottom-s.height);n.style.left=Math.max(a,0)+"px";n.style.top=Math.max(t,0)+"px"},showAtCenter:function(){var e,t,i,n,s,a,l,d,c,u=r.getViewportRect();if(this.fullscreen){a=this.getDom(),l=this.getDom("content");a.style.display="block";d=UE.ui.uiUtils.getClientRect(a),c=UE.ui.uiUtils.getClientRect(l);a.style.left="-100000px";l.style.width=u.width-d.width+c.width+"px";l.style.height=u.height-d.height+c.height+"px";a.style.width=u.width+"px";a.style.height=u.height+"px";a.style.left=0;this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY}};document.documentElement.style.overflowX="hidden";document.documentElement.style.overflowY="hidden";document.body.style.overflowX="hidden";document.body.style.overflowY="hidden"}else{this.getDom().style.display="";e=this.fitSize();t=0|this.getDom("titlebar").offsetHeight;i=u.width/2-e.width/2;n=u.height/2-(e.height-t)/2-t;s=this.getDom();this.safeSetOffset({left:Math.max(0|i,0),top:Math.max(0|n,0)});o.hasClass(s,"edui-state-centered")||(s.className+=" edui-state-centered")}this._show()},getContentHtml:function(){var e="";"string"==typeof this.content?e=this.content:this.iframeUrl&&(e='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>');return e},getHtmlTpl:function(){var e,t,i="";if(this.buttons){e=[];for(t=0;t<this.buttons.length;t++)e[t]=this.buttons[t].renderHtml();i='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+e.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(this.fullscreen?'class="%%-wrap edui-dialog-fullscreen-flag"':'class="%%"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+i+"</div></div></div>"},postRender:function(){var e,t;if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}e=this;this.addListener("show",function(){e.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){e.modalMask.hide()});if(this.buttons)for(t=0;t<this.buttons.length;t++)this.buttons[t].postRender();o.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e.safeSetOffset(r.getClientRect(e.getDom()))})});this._hide()},mesureSize:function(){var e=this.getDom("body"),t=r.getClientRect(this.getDom("content")).width,i=e.style;i.width=t;return r.getClientRect(e)},_onTitlebarMouseDown:function(e,t){var i,n,s;if(this.draggable){n=r.getViewportRect();s=this;r.startDrag(e,{ondragstart:function(){i=r.getClientRect(s.getDom());s.getDom("contmask").style.visibility="visible";s.dragMask.show(s.getDom().style.zIndex-1)},ondragmove:function(e,t){var n=i.left+e,o=i.top+t;s.safeSetOffset({left:n,top:o})},ondragstop:function(){s.getDom("contmask").style.visibility="hidden";o.removeClasses(s.getDom(),["edui-state-centered"]);s.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();this.fireEvent("dialogafterreset")},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*this.editor.container.style.zIndex+10);this._hidden=!1;this.fireEvent("show");baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var e=this.getDom();e.style.display="none";e.style.zIndex="";e.style.width="";e.style.height="";this._hidden=!0;this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(e){this.render();this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(e){}i=this},_onCloseButtonClick:function(e,t){this.close(!1)},close:function(e){var t,i,n;if(this.fireEvent("close",e)!==!1){if(this.fullscreen){document.documentElement.style.overflowX=this._originalContext.html.overflowX;document.documentElement.style.overflowY=this._originalContext.html.overflowY;document.body.style.overflowX=this._originalContext.body.overflowX;document.body.style.overflowY=this._originalContext.body.overflowY;delete this._originalContext}this._hide();t=this.getDom("content");i=this.getDom("iframe");if(t&&i){n=i.contentDocument||i.contentWindow.document;n&&(n.body.innerHTML="");o.remove(t)}}}};n.inherits(d,a)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.Menu,i=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MenuButton=function(e){this.initOptions(e);this.initMenuButton()};n.prototype={initMenuButton:function(){var e=this;this.uiName="menubutton";this.popup=new t({items:e.items,className:e.className,editor:e.editor});this.popup.addListener("show",function(){var t,i=this;for(t=0;t<i.items.length;t++){i.items[t].removeState("checked");if(i.items[t].value==e._value){i.items[t].addState("checked");this.value=e._value}}});this.initSplitButton()},setValue:function(e){this._value=e}};e.inherits(n,i)}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.Popup,i=baidu.editor.ui.SplitButton,n=baidu.editor.ui.MultiMenuPop=function(e){this.initOptions(e);this.initMultiMenu()};n.prototype={initMultiMenu:function(){var e=this;this.popup=new t({content:"",editor:e.editor,iframe_rendered:!1,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=!0;this.getDom("content").innerHTML='<iframe id="'+e.id+'_iframe" src="'+e.iframeUrl+'" frameborder="0"></iframe>';e.editor.container.style.zIndex&&(this.getDom().style.zIndex=1*e.editor.container.style.zIndex+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};e.inherits(n,i)}();!function(){function e(e){var t,i,n=e.target||e.srcElement,o=s.findParent(n,function(e){return s.hasClass(e,"edui-shortcutmenu")||s.hasClass(e,"edui-popup")},!0);if(!o)for(t=0;i=a[t++];)i.hide()}var t,i=baidu.editor.ui,n=i.UIBase,o=i.uiUtils,r=baidu.editor.utils,s=baidu.editor.dom.domUtils,a=[],l=!1,d=i.ShortCutMenu=function(e){this.initOptions(e);this.initShortCutMenu()};d.postHide=e;d.prototype={isHidden:!0,SPACE:5,initShortCutMenu:function(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();a.push(this)},initEvent:function(){var e=this,i=e.editor.document;s.on(i,"mousemove",function(i){if(e.isHidden===!1){if(e.getSubMenuMark()||"contextmenu"==e.eventType)return;var n=!0,o=e.getDom(),r=o.offsetWidth,s=o.offsetHeight,a=r/2+e.SPACE,l=s/2,d=Math.abs(i.screenX-e.left),c=Math.abs(i.screenY-e.top);clearTimeout(t);t=setTimeout(function(){if(c>0&&c<l)e.setOpacity(o,"1");else if(c>l&&c<l+70){e.setOpacity(o,"0.5");n=!1}else c>l+70&&c<l+140&&e.hide();n&&d>0&&d<a?e.setOpacity(o,"1"):d>a&&d<a+70?e.setOpacity(o,"0.5"):d>a+70&&d<a+140&&e.hide()})}});browser.chrome&&s.on(i,"mouseout",function(t){var i=t.relatedTarget||t.toElement;null!=i&&"HTML"!=i.tagName||e.hide()});e.editor.addListener("afterhidepop",function(){e.isHidden||(l=!0)})},initItems:function(){var e,t,n;if(r.isArray(this.items))for(e=0,t=this.items.length;e<t;e++){n=this.items[e].toLowerCase();if(i[n]){this.items[e]=new i[n](this.editor);this.items[e].className+=" edui-shortcutsubmenu "}}},setOpacity:function(e,t){browser.ie&&browser.version<9?e.style.filter="alpha(opacity = "+100*parseFloat(t)+");":e.style.opacity=t},getSubMenuMark:function(){var e,t,i,n;l=!1;e=o.getFixedLayer();t=s.getElementsByTagName(e,"div",function(e){return s.hasClass(e,"edui-shortcutsubmenu edui-popup")});for(i=0;n=t[i++];)"none"!=n.style.display&&(l=!0);return l},show:function(e,t){function i(e){e.left<0&&(e.left=0);e.top<0&&(e.top=0);d.style.cssText="position:absolute;left:"+e.left+"px;top:"+e.top+"px;"}function n(e){e.tagName||(e=e.getDom());l.left=parseInt(e.style.left);l.top=parseInt(e.style.top);l.top-=d.offsetHeight+15;i(l)}var r,a=this,l={},d=this.getDom(),c=o.getFixedLayer();a.eventType=e.type;d.style.cssText="display:block;left:-9999px";if("contextmenu"==e.type&&t){r=s.getElementsByTagName(c,"div","edui-contextmenu")[0];r?n(r):a.editor.addListener("aftershowcontextmenu",function(e,t){n(t)})}else{l=o.getViewportOffsetByEvent(e);l.top-=d.offsetHeight+a.SPACE;l.left+=a.SPACE+20;i(l);a.setOpacity(d,.2)}a.isHidden=!1;a.left=e.screenX+d.offsetWidth/2-a.SPACE;a.top=e.screenY-d.offsetHeight/2-a.SPACE;if(a.editor){d.style.zIndex=1*a.editor.container.style.zIndex+10;c.style.zIndex=d.style.zIndex-1}},hide:function(){this.getDom()&&(this.getDom().style.display="none");this.isHidden=!0},postRender:function(){if(r.isArray(this.items))for(var e,t=0;e=this.items[t++];)e.postRender()},getHtmlTpl:function(){var e,t;if(r.isArray(this.items)){e=[];for(t=0;t<this.items.length;t++)e[t]=this.items[t].renderHtml();e=e.join("")}else e=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+e+"</div>"}};r.inherits(d,n);s.on(document,"mousedown",function(t){e(t)});s.on(window,"scroll",function(t){e(t)})}();!function(){var e=baidu.editor.utils,t=baidu.editor.ui.UIBase,i=baidu.editor.ui.Breakline=function(e){this.initOptions(e);this.initSeparator()};i.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}};e.inherits(i,t)}();!function(){var e=baidu.editor.utils,t=baidu.editor.dom.domUtils,i=baidu.editor.ui.UIBase,n=baidu.editor.ui.Message=function(e){this.initOptions(e);this.initMessage()};n.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">×</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},reset:function(e){var t=this;if(!e.keepshow){clearTimeout(this.timer);t.timer=setTimeout(function(){t.hide()},e.timeout||4e3)}void 0!==e.content&&t.setContent(e.content);void 0!==e.type&&t.setType(e.type);t.show()},postRender:function(){var e=this,i=this.getDom("closer");i&&t.on(i,"click",function(){e.hide()})},setContent:function(e){this.getDom("content").innerHTML=e},setType:function(e){e=e||"info";var t=this.getDom("body");t.className=t.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+e)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var e=this.getDom("body").match(/edui-message-type-([\w-]+)/);return e?e[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var e=this.getDom();if(e){e.style.display="none";e.parentNode&&e.parentNode.removeChild(e)}}};e.inherits(n,i)}();!function(){var e,t,i,n,o,r,s,a,l,d,c,u,m,f=baidu.editor.utils,h=baidu.editor.ui,p=h.Dialog;h.buttons={};h.Dialog=function(e){var t=new p(e);t.addListener("hide",function(){var e,i,n;if(t.editor){e=t.editor;try{if(browser.gecko){i=e.window.scrollY,n=e.window.scrollX;e.body.focus();e.window.scrollTo(n,i)}else e.focus()}catch(e){}}});return t};e={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"};t=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"];
for(i=0;n=t[i++];){n=n.toLowerCase();h[n]=function(e){return function(t){var i=new h.Button({className:"edui-for-"+e,title:t.options.labelMap[e]||t.getLang("labelMap."+e)||"",onclick:function(){t.execCommand(e)},theme:t.options.theme,showText:!1});h.buttons[e]=i;t.addListener("selectionchange",function(n,o,r){var s=t.queryCommandState(e);if(s==-1){i.setDisabled(!0);i.setChecked(!1)}else if(!r){i.setDisabled(!1);i.setChecked(s)}});return i}}(n)}h.cleardoc=function(e){var t=new h.Button({className:"edui-for-cleardoc",title:e.options.labelMap.cleardoc||e.getLang("labelMap.cleardoc")||"",theme:e.options.theme,onclick:function(){confirm(e.getLang("confirmClear"))&&e.execCommand("cleardoc")}});h.buttons["cleardoc"]=t;e.addListener("selectionchange",function(){t.setDisabled(e.queryCommandState("cleardoc")==-1)});return t};o={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(r in o)!function(e,t){for(var i,n=0;i=t[n++];)!function(t){h[e.replace("float","")+t]=function(i){var n=new h.Button({className:"edui-for-"+e.replace("float","")+t,title:i.options.labelMap[e.replace("float","")+t]||i.getLang("labelMap."+e.replace("float","")+t)||"",theme:i.options.theme,onclick:function(){i.execCommand(e,t)}});h.buttons[e]=n;i.addListener("selectionchange",function(o,r,s){n.setDisabled(i.queryCommandState(e)==-1);n.setChecked(i.queryCommandValue(e)==t&&!s)});return n}}(i)}(r,o[r]);for(i=0;n=["backcolor","forecolor"][i++];)h[n]=function(e){return function(t){var i=new h.ColorButton({className:"edui-for-"+e,color:"default",title:t.options.labelMap[e]||t.getLang("labelMap."+e)||"",editor:t,onpickcolor:function(i,n){t.execCommand(e,n)},onpicknocolor:function(){t.execCommand(e,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){t.execCommand(e,this.color)}});h.buttons[e]=i;t.addListener("selectionchange",function(){i.setDisabled(t.queryCommandState(e)==-1)});return i}}(n);s={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(r in s)!function(t,i){for(var n,o=0;n=i[o++];)browser.opera&&"searchreplace"===n||!function(i){h[i]=function(n,o,r){var s,a;o=o||(n.options.iframeUrlMap||{})[i]||e[i];r=n.options.labelMap[i]||n.getLang("labelMap."+i)||"";if(o){s=new h.Dialog(f.extend({iframeUrl:n.ui.mapUrl(o),editor:n,className:"edui-for-"+i,title:r,holdScroll:"insertimage"===i,fullscreen:/charts|preview/.test(i),closeDialog:n.getLang("closeDialog")},"ok"==t?{buttons:[{className:"edui-okbutton",label:n.getLang("ok"),editor:n,onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:n.getLang("cancel"),editor:n,onclick:function(){s.close(!1)}}]}:{}));n.ui._dialogs[i+"Dialog"]=s}a=new h.Button({className:"edui-for-"+i,title:r,onclick:function(){if(s)switch(i){case"wordimage":var e=n.execCommand("wordimage");if(e&&e.length){s.render();s.open()}break;case"scrawl":if(n.queryCommandState("scrawl")!=-1){s.render();s.open()}break;default:s.render();s.open()}},theme:n.options.theme,disabled:"scrawl"==i&&n.queryCommandState("scrawl")==-1||"charts"==i});h.buttons[i]=a;n.addListener("selectionchange",function(){var e,t={edittable:1};if(!(i in t)){e=n.queryCommandState(i);if(a.getDom()){a.setDisabled(e==-1);a.setChecked(e)}}});return a}}(n.toLowerCase())}(r,s[r]);h.snapscreen=function(t,i,n){var o,r;n=t.options.labelMap["snapscreen"]||t.getLang("labelMap.snapscreen")||"";o=new h.Button({className:"edui-for-snapscreen",title:n,onclick:function(){t.execCommand("snapscreen")},theme:t.options.theme});h.buttons["snapscreen"]=o;i=i||(t.options.iframeUrlMap||{})["snapscreen"]||e["snapscreen"];if(i){r=new h.Dialog({iframeUrl:t.ui.mapUrl(i),editor:t,className:"edui-for-snapscreen",title:n,buttons:[{className:"edui-okbutton",label:t.getLang("ok"),editor:t,onclick:function(){r.close(!0)}},{className:"edui-cancelbutton",label:t.getLang("cancel"),editor:t,onclick:function(){r.close(!1)}}]});r.render();t.ui._dialogs["snapscreenDialog"]=r}t.addListener("selectionchange",function(){o.setDisabled(t.queryCommandState("snapscreen")==-1)});return o};h.insertcode=function(e,t,i){var n,o;t=e.options["insertcode"]||[];i=e.options.labelMap["insertcode"]||e.getLang("labelMap.insertcode")||"";n=[];f.each(t,function(t,i){n.push({label:t,value:i,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||"")+"</div>"}})});o=new h.Combox({editor:e,items:n,onselect:function(t,i){e.execCommand("insertcode",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-insertcode",indexByValue:function(e){if(e)for(var t,i=0;t=this.items[i];i++)if(t.value.indexOf(e)!=-1)return i;return-1}});h.buttons["insertcode"]=o;e.addListener("selectionchange",function(t,n,r){var s,a;if(!r){s=e.queryCommandState("insertcode");if(s==-1)o.setDisabled(!0);else{o.setDisabled(!1);a=e.queryCommandValue("insertcode");if(!a){o.setValue(i);return}a&&(a=a.replace(/['"]/g,"").split(",")[0]);o.setValue(a)}}});return o};h.fontfamily=function(e,t,i){var n,o,r,s,a;t=e.options["fontfamily"]||[];i=e.options.labelMap["fontfamily"]||e.getLang("labelMap.fontfamily")||"";if(t.length){for(n=0,r=[];o=t[n];n++){s=e.getLang("fontfamily")[o.name]||"";!function(t,i){r.push({label:t,value:i,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+f.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}(o.label||s,o.val)}a=new h.Combox({editor:e,items:r,onselect:function(t,i){e.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:i,initValue:i,className:"edui-for-fontfamily",indexByValue:function(e){if(e)for(var t,i=0;t=this.items[i];i++)if(t.value.indexOf(e)!=-1)return i;return-1}});h.buttons["fontfamily"]=a;e.addListener("selectionchange",function(t,i,n){var o,r;if(!n){o=e.queryCommandState("FontFamily");if(o==-1)a.setDisabled(!0);else{a.setDisabled(!1);r=e.queryCommandValue("FontFamily");r&&(r=r.replace(/['"]/g,"").split(",")[0]);a.setValue(r)}}});return a}};h.fontsize=function(e,t,i){var n,o,r,s;i=e.options.labelMap["fontsize"]||e.getLang("labelMap.fontsize")||"";t=t||e.options["fontsize"]||[];if(t.length){n=[];for(o=0;o<t.length;o++){r=t[o]+"px";n.push({label:r,value:r,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}s=new h.Combox({editor:e,items:n,title:i,initValue:i,onselect:function(t,i){e.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});h.buttons["fontsize"]=s;e.addListener("selectionchange",function(t,i,n){if(!n){var o=e.queryCommandState("FontSize");if(o==-1)s.setDisabled(!0);else{s.setDisabled(!1);s.setValue(e.queryCommandValue("FontSize"))}}});return s}};h.paragraph=function(e,t,i){var n,o,r;i=e.options.labelMap["paragraph"]||e.getLang("labelMap.paragraph")||"";t=e.options["paragraph"]||[];if(!f.isEmptyObject(t)){n=[];for(o in t)n.push({value:o,label:t[o]||e.getLang("paragraph")[o],theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});r=new h.Combox({editor:e,items:n,title:i,initValue:i,className:"edui-for-paragraph",onselect:function(t,i){e.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}});h.buttons["paragraph"]=r;e.addListener("selectionchange",function(t,i,n){var o,s,a;if(!n){o=e.queryCommandState("Paragraph");if(o==-1)r.setDisabled(!0);else{r.setDisabled(!1);s=e.queryCommandValue("Paragraph");a=r.indexByValue(s);a!=-1?r.setValue(s):r.setValue(r.initValue)}}});return r}};h.customstyle=function(e){var t,i,n,o,r,s=e.options["customstyle"]||[],a=e.options.labelMap["customstyle"]||e.getLang("labelMap.customstyle")||"";if(s.length){t=e.getLang("customstyle");for(i=0,n=[];o=s[i++];)!function(i){var o={};o.label=i.label?i.label:t[i.name];o.style=i.style;o.className=i.className;o.tag=i.tag;n.push({label:o.label,value:o,theme:e.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+o.tag+" "+(o.className?' class="'+o.className+'"':"")+(o.style?' style="'+o.style+'"':"")+">"+o.label+"</"+o.tag+"></div>"}})}(o);r=new h.Combox({editor:e,items:n,title:a,initValue:a,className:"edui-for-customstyle",onselect:function(t,i){e.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(e){for(var t,i=0;t=this.items[i++];)if(t.label==e)return i-1;return-1}});h.buttons["customstyle"]=r;e.addListener("selectionchange",function(t,i,n){var o,s,a;if(!n){o=e.queryCommandState("customstyle");if(o==-1)r.setDisabled(!0);else{r.setDisabled(!1);s=e.queryCommandValue("customstyle");a=r.indexByValue(s);a!=-1?r.setValue(s):r.setValue(r.initValue)}}});return r}};h.inserttable=function(e,t,i){i=e.options.labelMap["inserttable"]||e.getLang("labelMap.inserttable")||"";var n=new h.TableButton({editor:e,title:i,className:"edui-for-inserttable",onpicktable:function(t,i,n){e.execCommand("InsertTable",{numRows:n,numCols:i,border:1})},onbuttonclick:function(){this.showPopup()}});h.buttons["inserttable"]=n;e.addListener("selectionchange",function(){n.setDisabled(e.queryCommandState("inserttable")==-1)});return n};h.lineheight=function(e){var t,i,n,o,r=e.options.lineheight||[];if(r.length){for(t=0,n=[];i=r[t++];)n.push({label:i,value:i,theme:e.options.theme,onclick:function(){e.execCommand("lineheight",this.value)}});o=new h.MenuButton({editor:e,className:"edui-for-lineheight",title:e.options.labelMap["lineheight"]||e.getLang("labelMap.lineheight")||"",items:n,onbuttonclick:function(){var t=e.queryCommandValue("LineHeight")||this.value;e.execCommand("LineHeight",t)}});h.buttons["lineheight"]=o;e.addListener("selectionchange",function(){var t,i=e.queryCommandState("LineHeight");if(i==-1)o.setDisabled(!0);else{o.setDisabled(!1);t=e.queryCommandValue("LineHeight");t&&o.setValue((t+"").replace(/cm/,""));o.setChecked(i)}});return o}};a=["top","bottom"];for(l=0;d=a[l++];)!function(e){h["rowspacing"+e]=function(t){var i,n,o,r,s=t.options["rowspacing"+e]||[];if(!s.length)return null;for(i=0,o=[];n=s[i++];)o.push({label:n,value:n,theme:t.options.theme,onclick:function(){t.execCommand("rowspacing",this.value,e)}});r=new h.MenuButton({editor:t,className:"edui-for-rowspacing"+e,title:t.options.labelMap["rowspacing"+e]||t.getLang("labelMap.rowspacing"+e)||"",items:o,onbuttonclick:function(){var i=t.queryCommandValue("rowspacing",e)||this.value;t.execCommand("rowspacing",i,e)}});h.buttons[e]=r;t.addListener("selectionchange",function(){var i,n=t.queryCommandState("rowspacing",e);if(n==-1)r.setDisabled(!0);else{r.setDisabled(!1);i=t.queryCommandValue("rowspacing",e);i&&r.setValue((i+"").replace(/%/,""));r.setChecked(n)}});return r}}(d);c=["insertorderedlist","insertunorderedlist"];for(u=0;m=c[u++];)!function(e){h[e]=function(t){var i,n,o=t.options[e],r=function(){t.execCommand(e,this.value)},s=[];for(i in o)s.push({label:o[i]||t.getLang()[e][i]||"",value:i,theme:t.options.theme,onclick:r});n=new h.MenuButton({editor:t,className:"edui-for-"+e,title:t.getLang("labelMap."+e)||"",items:s,onbuttonclick:function(){var i=t.queryCommandValue(e)||this.value;t.execCommand(e,i)}});h.buttons[e]=n;t.addListener("selectionchange",function(){var i,o=t.queryCommandState(e);if(o==-1)n.setDisabled(!0);else{n.setDisabled(!1);i=t.queryCommandValue(e);n.setValue(i);n.setChecked(o)}});return n}}(m);h.fullscreen=function(e,t){t=e.options.labelMap["fullscreen"]||e.getLang("labelMap.fullscreen")||"";var i=new h.Button({className:"edui-for-fullscreen",title:t,theme:e.options.theme,onclick:function(){e.ui&&e.ui.setFullScreen(!e.ui.isFullScreen());this.setChecked(e.ui.isFullScreen())}});h.buttons["fullscreen"]=i;e.addListener("selectionchange",function(){var t=e.queryCommandState("fullscreen");i.setDisabled(t==-1);i.setChecked(e.ui.isFullScreen())});return i};h["emotion"]=function(t,i){var n="emotion",o=new h.MultiMenuPop({title:t.options.labelMap[n]||t.getLang("labelMap."+n)||"",editor:t,className:"edui-for-"+n,iframeUrl:t.ui.mapUrl(i||(t.options.iframeUrlMap||{})[n]||e[n])});h.buttons[n]=o;t.addListener("selectionchange",function(){o.setDisabled(t.queryCommandState(n)==-1)});return o};h.autotypeset=function(e){var t=new h.AutoTypeSetButton({editor:e,title:e.options.labelMap["autotypeset"]||e.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){e.execCommand("autotypeset")}});h.buttons["autotypeset"]=t;e.addListener("selectionchange",function(){t.setDisabled(e.queryCommandState("autotypeset")==-1)});return t};h["simpleupload"]=function(e){var t="simpleupload",i=new h.Button({className:"edui-for-"+t,title:e.options.labelMap[t]||e.getLang("labelMap."+t)||"",onclick:function(){},theme:e.options.theme,showText:!1});h.buttons[t]=i;e.addListener("ready",function(){var t=i.getDom("body"),n=t.children[0];e.fireEvent("simpleuploadbtnready",n)});e.addListener("selectionchange",function(n,o,r){var s=e.queryCommandState(t);if(s==-1){i.setDisabled(!0);i.setChecked(!1)}else if(!r){i.setDisabled(!1);i.setChecked(s)}});return i}}();!function(){function e(e){this.initOptions(e);this.initEditorUI()}var t,i=baidu.editor.utils,n=baidu.editor.ui.uiUtils,o=baidu.editor.ui.UIBase,r=baidu.editor.dom.domUtils,s=[];e.prototype={uiName:"editor",initEditorUI:function(){function e(e,t){var i,n,o,r,s,a;e.setOpt({wordCount:!0,maximumWords:1e4,wordCountMsg:e.options.wordCountMsg||e.getLang("wordCountMsg"),wordOverFlowMsg:e.options.wordOverFlowMsg||e.getLang("wordOverFlowMsg")});i=e.options,n=i.maximumWords,o=i.wordCountMsg,r=i.wordOverFlowMsg,s=t.getDom("wordcount");if(i.wordCount){a=e.getContentLength(!0);if(a>n){s.innerHTML=r;e.fireEvent("wordcountoverflow")}else s.innerHTML=o.replace("{#leave}",n-a).replace("{#count}",a)}}var t,i,n,o,s,a;this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();t=this.editor,i=this;t.addListener("ready",function(){function n(){e(t,i);r.un(t.document,"click",arguments.callee)}t.getDialog=function(e){return t.ui._dialogs[e+"Dialog"]};r.on(t.window,"scroll",function(e){baidu.editor.ui.Popup.postHide(e)});t.ui._actualFrameWidth=t.options.initialFrameWidth;UE.browser.ie&&6===UE.browser.version&&t.container.ownerDocument.execCommand("BackgroundImageCache",!1,!0);t.options.elementPathEnabled&&(t.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+t.getLang("elementPathTip")+":</div>");if(t.options.wordCount){r.on(t.document,"click",n);t.ui.getDom("wordcount").innerHTML=t.getLang("wordCountTip")}t.ui._scale();if(t.options.scaleEnabled){t.autoHeightEnabled&&t.disableAutoHeight();i.enableScale()}else i.disableScale();if(!t.options.elementPathEnabled&&!t.options.wordCount&&!t.options.scaleEnabled){t.ui.getDom("elementpath").style.display="none";t.ui.getDom("wordcount").style.display="none";t.ui.getDom("scale").style.display="none"}t.selection.isFocus()&&t.fireEvent("selectionchange",!1,!0)});t.addListener("mousedown",function(e,t){var i=t.target||t.srcElement;baidu.editor.ui.Popup.postHide(t,i);baidu.editor.ui.ShortCutMenu.postHide(t)});t.addListener("delcells",function(){UE.ui["edittip"]&&new UE.ui["edittip"](t);t.getDialog("edittip").open()});o=!1;t.addListener("afterpaste",function(){if(!t.queryCommandState("pasteplain")){if(baidu.editor.ui.PastePicker){n=new baidu.editor.ui.Popup({content:new baidu.editor.ui.PastePicker({editor:t}),editor:t,className:"edui-wordpastepop"});n.render()}o=!0}});t.addListener("afterinserthtml",function(){clearTimeout(s);s=setTimeout(function(){var e,i,s;if(n&&(o||t.ui._isTransfer)){if(n.isHidden()){e=r.createElement(t.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),i=t.selection.getRange();i.insertNode(e);s=getDomNode(e,"firstChild","previousSibling");s&&n.showAnchor(3==s.nodeType?s.parentNode:s);r.remove(e)}else n.show();delete t.ui._isTransfer;o=!1}},200)});t.addListener("contextmenu",function(e,t){baidu.editor.ui.Popup.postHide(t)});t.addListener("keydown",function(e,t){n&&n.dispose(t);var i=t.keyCode||t.which;t.altKey&&90==i&&UE.ui.buttons["fullscreen"].onclick()});t.addListener("wordcount",function(t){e(this,i)});t.addListener("selectionchange",function(){t.options.elementPathEnabled&&i[(t.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();t.options.scaleEnabled&&i[(t.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});a=new baidu.editor.ui.Popup({editor:t,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();t.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(e){this.hide();t.ui._dialogs[e]&&t.ui._dialogs[e].open()},_onImgSetFloat:function(e){this.hide();t.execCommand("imagefloat",e)},_setIframeAlign:function(e){var t=a.anchorEl,i=t.cloneNode(!0);switch(e){case-2:i.setAttribute("align","");break;case-1:i.setAttribute("align","left");break;case 1:i.setAttribute("align","right")}t.parentNode.insertBefore(i,t);r.remove(t);a.anchorEl=i;a.showAnchor(a.anchorEl)},_updateIframe:function(){var e=t._iframe=a.anchorEl;if(r.hasClass(e,"ueditor_baidumap")){t.selection.getRange().selectNode(e).select();t.ui._dialogs.mapDialog.open();a.hide()}else{t.ui._dialogs.insertframeDialog.open();a.hide()}},_onRemoveButtonClick:function(e){t.execCommand(e);this.hide()},queryAutoHide:function(e){return e&&e.ownerDocument==t.document&&("img"==e.tagName.toLowerCase()||r.findParentByTagName(e,"a",!0))?e!==a.anchorEl:baidu.editor.ui.Popup.prototype.queryAutoHide.call(this,e)}});a.render();if(t.options.imagePopup){t.addListener("mouseover",function(e,i){var n,o;i=i||window.event;n=i.target||i.srcElement;if(t.ui._dialogs.insertframeDialog&&/iframe/gi.test(n.tagName)){o=a.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>");if(o){a.getDom("content").innerHTML=o;a.anchorEl=n;a.showAnchor(a.anchorEl)}else a.hide()}});t.addListener("selectionchange",function(e,i){var n,o,s,l,d,c,u,m;if(i){n="",o="",s=t.selection.getRange().getClosedNode(),l=t.ui._dialogs;if(s&&"IMG"==s.tagName){d="insertimageDialog";s.className.indexOf("edui-faked-video")==-1&&s.className.indexOf("edui-upload-video")==-1||(d="insertvideoDialog");s.className.indexOf("edui-faked-webapp")!=-1&&(d="webappDialog");s.src.indexOf("http://api.map.baidu.com")!=-1&&(d="mapDialog");s.className.indexOf("edui-faked-music")!=-1&&(d="musicDialog");s.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1&&(d="gmapDialog");if(s.getAttribute("anchorname")){d="anchorDialog";n=a.formatHtml("<nobr>"+t.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+t.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+t.getLang("delete")+"</span></nobr>")}if(s.getAttribute("word_img")){t.word_img=[s.getAttribute("word_img")];d="wordimageDialog"}(r.hasClass(s,"loadingclass")||r.hasClass(s,"loaderrorclass"))&&(d="");if(!l[d])return;o="<nobr>"+t.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+t.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+t.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+t.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+t.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+d+'\');" class="edui-clickable">'+t.getLang("modify")+"</span></nobr>";!n&&(n=a.formatHtml(o))}if(t.ui._dialogs.linkDialog){c=t.queryCommandValue("link");if(c&&(u=c.getAttribute("_href")||c.getAttribute("href",2))){m=u;u.length>30&&(m=u.substring(0,20)+"...");n&&(n+='<div style="height:5px;"></div>');n+=a.formatHtml("<nobr>"+t.getLang("anthorMsg")+': <a target="_blank" href="'+u+'" title="'+u+'" >'+m+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+t.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+t.getLang("clear")+"</span></nobr>");a.showAnchor(c)}}if(n){a.getDom("content").innerHTML=n;a.anchorEl=s||c;a.showAnchor(a.anchorEl)}else a.hide()}})}},_initToolbars:function(){var e,t,n,o,r,s,a=this.editor,l=this.toolbars||[],d=[];for(e=0;e<l.length;e++){t=l[e];n=new baidu.editor.ui.Toolbar({theme:a.options.theme});for(o=0;o<t.length;o++){r=t[o];s=null;if("string"==typeof r){r=r.toLowerCase();"|"==r&&(r="Separator");"||"==r&&(r="Breakline");baidu.editor.ui[r]&&(s=new baidu.editor.ui[r](a));if("fullscreen"==r){d&&d[0]?d[0].items.splice(0,0,s):s&&n.items.splice(0,0,s);continue}}else s=r;s&&s.id&&n.add(s)}d[e]=n}i.each(UE._customizeUI,function(e,t){var i,o;if(e.id&&e.id!=a.key)return!1;i=e.execFn.call(a,a,t);if(i){o=e.index;void 0===o&&(o=n.items.length);n.add(i,o)}});this.toolbars=d},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},showWordImageDialog:function(){this._dialogs["wordimageDialog"].open()},renderToolbarBoxHtml:function(){var e,t=[];for(e=0;e<this.toolbars.length;e++)t.push(this.toolbars[e].renderHtml());return t.join("")},setFullScreen:function(e){var t,i,n,o=this.editor,r=o.container.parentNode.parentNode;if(this._fullscreen!=e){this._fullscreen=e;this.editor.fireEvent("beforefullscreenchange",e);baidu.editor.browser.gecko&&(t=o.selection.getRange().createBookmark());if(e){for(;"BODY"!=r.tagName;){i=baidu.editor.dom.domUtils.getComputedStyle(r,"position");s.push(i);r.style.position="static";r=r.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=o.iframe.parentNode.offsetWidth;if(this._bakAutoHeight){o.autoHeightEnabled=!1;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;o.iframe.parentNode.style.width="";this._updateFullScreen()}else{for(;"BODY"!=r.tagName;){r.style.position=s.shift();r=r.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){o.autoHeightEnabled=!0;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;o.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px";window.scrollTo(0,this._bakScrollTop)}if(browser.gecko&&"true"===o.body.contentEditable){n=document.createElement("input");document.body.appendChild(n);o.body.contentEditable=!1;setTimeout(function(){n.focus();setTimeout(function(){o.body.contentEditable=!0;o.fireEvent("fullscreenchanged",e);o.selection.getRange().moveToBookmark(t).select(!0);baidu.editor.dom.domUtils.remove(n);e&&window.scroll(0,0)},0)},0)}if("true"===o.body.contentEditable){this.editor.fireEvent("fullscreenchanged",e);this.triggerLayout()}}},_updateFullScreen:function(){if(this._fullscreen){var e=n.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+e.width+"px;height:"+e.height+"px;z-index:"+(1*this.getDom().style.zIndex+100);n.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(e.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),!0);if(browser.gecko)try{window.onresize()}catch(e){}}},_updateElementPath:function(){var e,t,i,n,o=this.getDom("elementpath");if(this.elementPathEnabled&&(e=this.editor.queryCommandValue("elementpath"))){t=[];for(i=0;n=e[i];i++)t[i]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+i+'&quot;);">'+n+"</span>");o.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+t.join(" &gt; ")+"</div>"}else o.style.display="none"},disableElementPath:function(){var e=this.getDom("elementpath");e.innerHTML="";e.style.display="none";this.elementPathEnabled=!1},enableElementPath:function(){var e=this.getDom("elementpath");e.style.display="";this.elementPathEnabled=!0;this._updateElementPath()},_scale:function(){function e(){h=r.getXY(a);p||(p=s.options.minFrameHeight+d.offsetHeight+c.offsetHeight);m.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+a.offsetWidth+"px;height:"+a.offsetHeight+"px;z-index:"+(s.options.zIndex+1);r.on(o,"mousemove",t);r.on(l,"mouseup",i);r.on(o,"mouseup",i)}function t(e){n();var t=e||window.event;b=t.pageX||o.documentElement.scrollLeft+t.clientX;y=t.pageY||o.documentElement.scrollTop+t.clientY;v=b-h.x;C=y-h.y;if(v>=g){f=!0;m.style.width=v+"px"}if(C>=p){f=!0;m.style.height=C+"px"}}function i(){if(f){f=!1;s.ui._actualFrameWidth=m.offsetWidth-2;a.style.width=s.ui._actualFrameWidth+"px";s.setHeight(m.offsetHeight-c.offsetHeight-d.offsetHeight-2,!0)}m&&(m.style.display="none");n();r.un(o,"mousemove",t);r.un(l,"mouseup",i);r.un(o,"mouseup",i)}function n(){browser.ie?o.selection.clear():window.getSelection().removeAllRanges()}var o=document,s=this.editor,a=s.container,l=s.document,d=this.getDom("toolbarbox"),c=this.getDom("bottombar"),u=this.getDom("scale"),m=this.getDom("scalelayer"),f=!1,h=null,p=0,g=s.options.minFrameWidth,b=0,y=0,v=0,C=0,N=this;this.editor.addListener("fullscreenchanged",function(e,t){if(t)N.disableScale();else if(N.editor.options.scaleEnabled){N.enableScale();var i=N.editor.document.createElement("span");N.editor.body.appendChild(i);N.editor.body.style.height=Math.max(r.getXY(i).y,N.editor.iframe.offsetHeight-20)+"px";r.remove(i)}});this.enableScale=function(){if(1!=s.queryCommandState("source")){u.style.display="";this.scaleEnabled=!0;r.on(u,"mousedown",e)}};this.disableScale=function(){u.style.display="none";this.scaleEnabled=!1;r.un(u,"mousedown",e)}},isFullScreen:function(){return this._fullscreen},postRender:function(){var e,t,i,n,r;o.prototype.postRender.call(this);for(e=0;e<this.toolbars.length;e++)this.toolbars[e].postRender();t=this;n=baidu.editor.dom.domUtils,r=function(){clearTimeout(i);i=setTimeout(function(){t._updateFullScreen()})};n.on(window,"resize",r);t.addListener("destroy",function(){n.un(window,"resize",r);clearTimeout(i)})},showToolbarMsg:function(e,t){this.getDom("toolbarmsg_label").innerHTML=e;this.getDom("toolbarmsg").style.display="";if(!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(e){return e?e.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var e=this.getDom();"1"==e.style.zoom?e.style.zoom="100%":e.style.zoom="1"}};i.inherits(e,baidu.editor.ui.UIBase);t={};UE.ui.Editor=function(n){var o,s=new UE.Editor(n);s.options.editor=s;i.loadFile(document,{href:s.options.themePath+s.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});o=s.render;s.render=function(n){if(n.constructor===String){s.key=n;t[n]=s}i.domReady(function(){function t(){var t,i,a,l,d,c,u,m;s.setOpt({labelMap:s.options.labelMap||s.getLang("labelMap")});new e(s.options);if(n){n.constructor===String&&(n=document.getElementById(n));n&&n.getAttribute("name")&&(s.options.textarea=n.getAttribute("name"));if(n&&/script|textarea/gi.test(n.tagName)){t=document.createElement("div");n.parentNode.insertBefore(t,n);i=n.value||n.innerHTML;s.options.initialContent=/^[\t\r\n ]*$/.test(i)?s.options.initialContent:i.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");n.className&&(t.className=n.className);n.style.cssText&&(t.style.cssText=n.style.cssText);if(/textarea/i.test(n.tagName)){s.textarea=n;s.textarea.style.display="none"}else n.parentNode.removeChild(n);if(n.id){t.id=n.id;r.removeAttributes(n,"id")}n=t;n.innerHTML=""}}r.addClass(n,"edui-"+s.options.theme);s.ui.render(n);a=s.options;s.container=s.ui.getDom();l=r.findParents(n,!0);d=[];for(c=0;u=l[c];c++){d[c]=u.style.display;u.style.display="block"}if(a.initialFrameWidth)a.minFrameWidth=a.initialFrameWidth;else{a.minFrameWidth=a.initialFrameWidth=n.offsetWidth;m=n.style.width;/%$/.test(m)&&(a.initialFrameWidth=m)}a.initialFrameHeight?a.minFrameHeight=a.initialFrameHeight:a.initialFrameHeight=a.minFrameHeight=n.offsetHeight;for(c=0;u=l[c];c++)u.style.display=d[c];n.style.height&&(n.style.height="");s.container.style.width=a.initialFrameWidth+(/%$/.test(a.initialFrameWidth)?"":"px");s.container.style.zIndex=a.zIndex;o.call(s,s.ui.getDom("iframeholder"));s.fireEvent("afteruiready")}s.langIsReady?t():s.addListener("langReady",t)})};return s};UE.getEditor=function(e,i){var n=t[e];if(!n){n=t[e]=new UE.ui.Editor(i);n.render(e)}return n};UE.delEditor=function(e){var i;if(i=t[e]){i.key&&i.destroy();delete t[e]}};UE.registerUI=function(e,t,n,o){i.each(e.split(/\s+/),function(e){UE._customizeUI[e]={id:o,execFn:t,index:n}})}}();UE.registerUI("message",function(e){function t(){var e=s.ui.getDom("toolbarbox");e&&(i.style.top=e.offsetHeight+3+"px");i.style.zIndex=Math.max(s.options.zIndex,s.iframe.style.zIndex)+1}var i,n=baidu.editor.ui,o=n.Message,r=[],s=e;s.addListener("ready",function(){i=document.getElementById(s.ui.id+"_message_holder");t();setTimeout(function(){t()},500)});s.addListener("showmessage",function(e,n){n=utils.isString(n)?{content:n}:n;var a=new o({timeout:n.timeout,type:n.type,content:n.content,keepshow:n.keepshow,editor:s}),l=n.id||"msg_"+(+new Date).toString(36);a.render(i);r[l]=a;a.reset(n);t();return l});s.addListener("updatemessage",function(e,t,n){n=utils.isString(n)?{content:n}:n;var o=r[t];o.render(i);o&&o.reset(n)});s.addListener("hidemessage",function(e,t){var i=r[t];i&&i.hide()})});UE.registerUI("autosave",function(e){var t=null,i=null;e.on("afterautosave",function(){clearTimeout(t);t=setTimeout(function(){i&&e.trigger("hidemessage",i);i=e.trigger("showmessage",{content:e.getLang("autosave.success"),timeout:2e3})},2e3)})})}();